<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US">
	<head>
		<meta charset="utf-8" />
		<title>EPUB 3.3</title>
		<script src="https://www.w3.org/Tools/respec/respec-w3c" class="remove"></script>
		<script src="./biblio.js" class="remove"></script>
		<script src="../common/js/css-inline.js" class="remove"></script>
		<script src="../common/js/add-caution-hd.js" class="remove"></script>
		<script src="../common/js/data-test-display.js" class="remove"></script>
		<script class="remove">
			//<![CDATA[
            var respecConfig = {
                group: "epub",
                wgPublicList: "public-epub-wg",
                specStatus: "ED",
                shortName: "epub-33",
                edDraftURI: "https://w3c.github.io/epub-specs/epub33/core/",
                implementationReportURI: "https://w3c.github.io/epub-specs/epub33/reports/",
                crEnd: "2022-10-30",
                previousPublishDate: "2021-07-12",
                previousMaturity: "WD",
                copyrightStart: "1999",
                editors:[
                {
                    name: "Matt Garrish",
                    company: "DAISY Consortium",
                    companyURL: "https://daisy.org",
					w3cid: 51655
                },
				{
					name: "Ivan Herman",
					url: "https://www.w3.org/People/Ivan/",
					company: "W3C",
					w3cid: 7382,
					orcid: "0000-0003-0782-2704",
					companyURL: "https://www.w3.org",
				},
				{
					name: "Dave Cramer",
					company: "Invited Expert",
					w3cid: 65283
				}],
                includePermalinks: true,
                permalinkEdge: true,
                permalinkHide: false,
                github: {
                    repoURL: "https://github.com/w3c/epub-specs",
                    branch: "main"
                },
                localBiblio: biblio,
                preProcess:[inlineCustomCSS],
                postProcess:[addCautionHeaders, data_test_display],
                testSuiteURI: "https://w3c.github.io/epub-tests/index.html",
                lint: {
                     "wpt-tests-exist": true,
				},
				xref: {
					profile: "web-platform",
					specs: ["epub-rs-33"]
				}
            };//]]>
		</script>
		<style>
			pre {
				white-space: break-spaces !important;
			}</style>
	</head>
	<body>
		<section id="abstract">
			<p>EPUB® 3 defines a distribution and interchange format for digital publications and documents. The EPUB
				format provides a means of representing, packaging, and encoding structured and semantically enhanced
				web content — including HTML, CSS, SVG, and other resources — for distribution in a single-file
				container.</p>
			<p>This specification defines the authoring requirements for [=EPUB publications=] and represents the third
				major revision of the standard.</p>
		</section>
		<section id="sotd"></section>
		<section id="sec-introduction">
			<h2>Introduction</h2>

			<section id="sec-intro-overview" class="informative">
				<h3>Overview</h3>

				<p>EPUB 3 has been widely adopted as the format for digital books (ebooks), and this revision continues
					to increase the format's capabilities to better support a wider range of publication requirements,
					including complex layouts, rich media and interactivity, and global typography features. The
					expectation is that publishers will utilize the EPUB 3 format for a broad range of content,
					including books, magazines, and educational, professional, and scientific publications.</p>

				<p>This specification represents the core of EPUB 3 and includes the conformance requirements for [=EPUB
					publications=] — the product of the standard. The other specifications that comprise EPUB 3 are as
					follows:</p>

				<ul>
					<li>
						<p><a data-cite="epub-rs-33#">EPUB 3 Reading Systems</a> [[epub-rs-33]] — defines the processing
							requirements for [=EPUB reading systems=] — the applications that consume EPUB publications
							and present their content to users.</p>
					</li>
					<li>
						<p><a data-cite="epub-a11y-11#">EPUB Accessibility</a> [[epub-a11y-11]] — defines accessibility
							conformance and discovery requirements for EPUB publications.</p>
					</li>
				</ul>

				<p>These specifications represent the formal list recognized as belonging to EPUB 3 and that contain
					functionality normatively referenced as part of the standard. The development of extension
					specifications periodically adds new functionality to EPUB publications. Features and functionality
					defined outside of core revisions to the standard, while not formally recognized in this
					specification, are nonetheless available for [=EPUB creators=] and reading system developers to
					use.</p>

				<p>The non-normative <a data-cite="epub-overview-33#">EPUB 3 Overview</a> [[epub-overview-33]] provides
					a general introduction to EPUB 3. A list of technical changes from the previous version is also
					available in the <a href="#change-log">change log</a>.</p>
			</section>

			<section id="sec-intro-spec-org" class="informative">
				<h3>Organization</h3>

				<p>This section reviews the organization of this specification through the central product it defines:
					the [=EPUB publication=].</p>

				<p>An EPUB publication is, in its most basic sense, a bundle of resources with instructions on how to
					render those resources to present the content in a logical order. The types of resources that are
					allowed in EPUB publication, as well as restrictions on their use, are defined in <a
						href="#sec-publication-resources"></a>.</p>

				<p>A ZIP-based archive with the file extension <code>.epub</code> bundles the EPUB publication's
					resources for distribution. As conformant ZIP archives, EPUB publications can be unzipped by many
					software programs, simplifying both their production and consumption.</p>

				<p>The container format not only provides a means of determining that the zipped content represents an
					EPUB publication (the <code>mimetype</code> file), but also provides a universally named directory
					of non-normative resources (<code>/META-INF</code>). Key among these resources is the
						<code>container.xml</code> file, which directs reading systems to the available [=package
					documents=]. Refer to <a href="#sec-ocf"></a> for more information about the container format.</p>

				<p>An EPUB publication is typically represented by a single package document. This document includes
					metadata used by [=reading systems=] to present the content to the user, such as the title and
					author for display in a bookshelf as well as rendering metadata (e.g., whether the content is
					reflowable or has a fixed layout). It also provides a manifest of resources and includes a [=EPUB
					spine | spine=] that lists the default sequence in which to render documents as a user progresses
					through the content. Refer to <a href="#sec-package-doc"></a> for the requirements for the package
					document.</p>

				<p>The actual content of an EPUB publication &#8212; what users are presented with when they begin
					reading &#8212; is built on the Open Web Platform and comes in two flavors: XHTML and SVG. Called
					[=EPUB content documents=], these documents typically reference many additional resources required
					for their proper rendering, such as images, audio and video clips, scripts, and style sheets.</p>

				<p>Refer to <a href="#sec-contentdocs"></a> for detailed information about the rules and requirements to
					produce EPUB content documents, and [[epub-a11y-11]] for accessibility requirements.</p>

				<p>An EPUB publication also includes another key file called the [=EPUB navigation document=]. This
					document provides critical navigation capabilities, such as the table of contents, that allow users
					to navigate the content quickly and easily. The navigation document is a specialized type of [=XHTML
					content document=] which also allows EPUB creators to use it in the content (i.e., avoiding one
					table of contents for machine processing and another for user consumption). Refer to <a
						href="#sec-nav"></a> for more information about this document.</p>

				<p>EPUB publications by default are intended to reflow to fit the available screen space. It is also
					possible to create publications that have pixel-precise fixed layouts using images and/or CSS
					positioning. The metadata to control layouts are defined in <a href="#sec-rendering-control"
					></a>.</p>

				<p>[=Media overlay documents=] complement EPUB content documents. They provide declarative markup for
					synchronizing the text in EPUB content documents with prerecorded audio. The result is the ability
					to create a read-aloud experience where [=reading systems=] highlight the text as it is narrated.
					Refer to <a href="#sec-media-overlays"></a> for the definition of media overlay documents.</p>

				<p>While conceptually simple, an EPUB publication is more than just a collection of HTML pages and
					dependent assets in a ZIP package as presented here. Additional information about the primary
					features and functionality that EPUB publications provide to enhance the reading experience is
					available from the referenced specifications, and a more general introduction to the features of
					EPUB 3 is provided in the non-normative [[epub-overview-33]].</p>

				<p>Refer to [[epub-rs-33]] for the processing requirements for reading systems. Although it is not
					necessary that [=EPUB creators=] read that document to create EPUB publications, an understanding of
					how reading systems present the content can help craft publications for optimal presentation to
					users.</p>
			</section>

			<section id="sec-intro-relations" class="informative">
				<h3>Relationship to other specifications</h3>

				<div class="caution">
					<p>The technologies EPUB 3 builds on are constantly evolving. Some, typically referred to as
						"living" or "evergreen" standards, are subject to change daily and their impact on the validity
						of EPUB publications is immediate. Others are updated less frequently and the changes may not
						affect [=EPUB publications=] until EPUB 3 undergoes a new revision.</p>
					<p>In all cases, it is possible that previously valid features may become obsolete (e.g., due to a
						lack of support or because of security issues). [=EPUB creators=] should therefore be cautious
						about using any feature without broad support and keep their [=EPUB conformance checkers=] up to
						date.</p>
				</div>

				<section id="sec-overview-relations-html">
					<h4>Relationship to HTML</h4>

					<p>The [[html]] standard is continuously evolving &#8212; there are no longer versioned releases of
						it. That standard, in turn, references various technologies that continue to evolve, such as
						MathML, SVG, CSS, and JavaScript.</p>

					<p>The benefit of this approach for EPUB is that [=EPUB publications=] always keep pace with changes
						to the web without the need for new revisions. [=EPUB creators=], however, must keep track of
						the various changes to HTML and the technologies it references to ensure they keep their
						processes up to date.</p>

					<p>The <a href="#sec-xhtml">XHTML profile defined by this specification</a> inherits all definitions
						of semantics, structure and processing behaviors from HTML unless otherwise specified.</p>

					<p>In addition, this specification <a href="#sec-xhtml-extensions">defines a set of extensions</a>
						to the [[html]] document model that EPUB creators may include in [=XHTML content
						documents=].</p>
				</section>

				<section id="sec-overview-relations-svg">
					<h4>Relationship to SVG</h4>

					<p>This specification does not reference a specific version of [[svg]], but instead uses an undated
						reference. Whenever there is any ambiguity in this reference, the latest recommended
						specification is the authoritative reference.</p>

					<p>This approach ensures that EPUB will always keep pace with changes to the SVG standard. [=EPUB
						creators=], however, must keep track of changes to the SVG standard to ensure they keep their
						processes up to date.</p>
				</section>

				<section id="sec-overview-relations-css">
					<h4>Relationship to CSS</h4>

					<p>EPUB 3 supports CSS as defined by the CSS Working Group Snapshot [[csssnapshot]]. EPUB 3 also
						maintains some prefixed CSS properties, to ensure consistent support for global languages.</p>
				</section>

				<section id="sec-overview-relations-mathml">
					<h4>Relationship to MathML</h4>

					<p>EPUB 3 only supports <a href="https://www.w3.org/TR/MathML3/chapter3.html">Presentation
							Markup</a> [[mathml3]]. <a href="https://www.w3.org/TR/MathML3/chapter4.html">Content
							Markup</a> is only allowed in <a
							href="https://www.w3.org/TR/MathML3/chapter5.html#mixing.elements.annotation.xml">structured
							markup annotations</a>.</p>
				</section>

				<section id="sec-overview-relations-smil">
					<h4>Relationship to SMIL</h4>

					<p>This specification relies on a subset of [[smil3]], from which the media overlays elements and
						attributes defined in <a href="#sec-overlays-def"></a> are derived.</p>
				</section>

				<section id="sec-overview-relations-url">
					<h4>Relationship to URL</h4>

					<p>This specification refers to the [[url]] standard for terminology and processing related to URLs
						expressed in [=EPUB publications=]. It is anticipated that new and revised web formats will
						adopt this standard, but until then this may put this specification in conflict with the
						internal requirements for some formats (e.g., valid relative paths), specifically with respect
						to the use of internationalized URLs. If a format does not allow internationalized URLs (i.e.,
						URLs must conform to [[rfc3986]] or earlier), that requirement takes precedence within those
						resources.</p>
				</section>
			</section>

			<section id="sec-terminology">
				<h3>Terminology</h3>

				<p>This specification defines the following terms specific to EPUB 3. They appear capitalized wherever
					used.</p>

				<div class="note">
					<p>Only the first instance of a term in a section links to its definition.</p>
				</div>

				<dl class="termlist">
					<dt>
						<dfn class="export">codec</dfn>
					</dt>
					<dd>
						<p>Codec refers to content that has intrinsic binary format qualities, such as video and audio
							media types designed for optimum compression or that provide optimized streaming
							capabilities.</p>
					</dd>

					<dt>
						<dfn class="export">container resource</dfn>
					</dt>
					<dd>
						<p>A [=publication resource=] that is located within the [=EPUB container=], as opposed to a
							[=remote resource=] which is not.</p>
						<p>Refer to <a href="#sec-resource-locations"></a> for media type-specific rules for resource
							locations.</p>
					</dd>

					<dt>
						<dfn class="export">container root URL</dfn>
					</dt>
					<dd>
						<p>The [=URL=] [[url]] of the [=root directory=] representing the [=OCF abstract container=]. It
							is implementation specific, but EPUB creators must assume it has properties defined in <a
								href="#sec-container-iri"></a>.</p>
					</dd>

					<dt>
						<dfn class="export">content URL</dfn>
					</dt>
					<dd>
						<p> The [=URL=] of a file or directory in the [=OCF abstract container=], defined in <a
								href="#sec-container-iri"></a>. </p>
					</dd>

					<dt>
						<dfn class="export">core media type resource</dfn>
					</dt>
					<dd>
						<p>A [=publication resource=] that conforms to one of the MIME media types [[rfc2046]] listed in
								<a href="#sec-core-media-types"></a> and, therefore, does not require the provision of a
								<a href="#sec-foreign-resources">fallback</a> (cf. [=foreign resource=]).</p>
						<p>The designation "core media type resource" only applies when a resource is used in the
							rendering of [=EPUB content documents=] and [=foreign content documents=]. A core media type
							resource cannot be used in the [=EPUB spine | spine=], for example, without a fallback
							unless it also has the media type of an EPUB content document.</p>
					</dd>

					<dt><dfn class="export">EPUB conformance checker</dfn></dt>
					<dd>
						<p>An application that verifies the requirements of this specification against [=EPUB
							publications=] and reports on their conformance.</p>
					</dd>

					<dt>
						<dfn class="export">EPUB container</dfn>
					</dt>

					<dt>
						<dfn class="export">OCF ZIP container</dfn>
					</dt>
					<dd>
						<p>The ZIP-based packaging and distribution format for [=EPUB publications=] defined in <a
								href="#sec-container-zip"></a>.</p>
						<p>EPUB container and OCF ZIP container are synonymous.</p>
					</dd>

					<dt>
						<dfn class="export">EPUB content document</dfn>
					</dt>
					<dd>
						<p>A [=publication resource=] referenced from the [=EPUB spine |spine=] or a [=manifest fallback
							chain=] that conforms to either the [=XHTML content document | XHTML=] or [=SVG content
							document=] definitions.</p>
						<p>EPUB content documents contain all or part of the content of an [=EPUB publication=] (i.e.,
							the textual, visual and/or audio content).</p>
						<p>[=EPUB creators=] can include EPUB content documents in the spine without the provision of <a
								href="#sec-foreign-resources">fallbacks</a>.</p>
					</dd>

					<dt>
						<dfn class="export">EPUB creator</dfn>
					</dt>
					<dd>
						<p>An individual, organization, or process that produces an [=EPUB publication=].</p>
						<div class="note">
							<p> The creation of an EPUB publication often involves the work of many individuals, and may
								be split across multiple organizations (e.g., when a publisher outsources all or part of
								the work). Depending on the process used to produce an EPUB publication,
								responsibilities may fall on the organization (e.g., the publisher), the individuals
								preparing the publication (e.g., technical editors), or automatic procedures (e.g., as
								part of a publication pipeline). As a result, not every party or process may be
								responsible for ensuring every requirement is met, but there is always an EPUB creator
								responsible for the conformance of the final EPUB publication. </p>
							<p>Previous versions of this specification referred to the EPUB creator as the <span
									id="dfn-author">Author</span>.</p>
						</div>
					</dd>

					<dt>
						<dfn class="export">EPUB manifest</dfn> (or manifest)</dt>
					<dd>
						<p>The section of the [=package document=] that lists the [=publication resources=].</p>
						<p>Refer to <a href="#sec-manifest-elem"></a> for more information.</p>
					</dd>

					<dt>
						<dfn class="export">EPUB navigation document</dfn>
					</dt>
					<dd>
						<p>A specialization of the [=XHTML content document=] that contains human- and machine-readable
							global navigation information. The EPUB navigation document conforms to the constraints
							expressed in <a href="#sec-nav"></a>.</p>
					</dd>

					<dt>
						<dfn class="export">EPUB publication</dfn>
					</dt>
					<dd>
						<p>A logical document entity consisting of a set of interrelated <a
								data-lt="publication resource">resources</a> packaged in an [=EPUB container=].</p>
						<p>An EPUB publication typically represents a single intellectual or artistic work, but this
							specification does not restrict the nature of the content.</p>
					</dd>

					<dt><dfn class="export"
							data-lt="EPUB reading system|EPUB reading systems|reading system|reading systems">EPUB
							reading system</dfn> (or reading system)</dt>
					<dd>
						<p>A system that processes [=EPUB publications=] for presentation to a user in a manner
							conformant with this specification.</p>
					</dd>

					<dt>
						<dfn class="export">EPUB spine</dfn> (or spine)</dt>
					<dd>
						<p>The section of the [=package document=] that defines an ordered list of [=EPUB content
							documents=] and [=foreign content documents=]. This list represents the default reading
							order of the [=EPUB publication=].</p>
						<p>Refer to <a href="#sec-spine-elem"></a> for more information.</p>
					</dd>

					<dt>
						<dfn class="export">exempt resource</dfn>
					</dt>
					<dd>
						<p>Exempt resources are a special class of [=publication resources=] that reading systems are
							not required to support the rendering of, but [=EPUB creators=] do not have to provide <a
								href="#sec-foreign-resources">fallbacks</a> for.</p>
						<p>Refer to <a href="#sec-exempt-resources"></a> for more information.</p>
					</dd>

					<dt>
						<dfn class="export">file name</dfn>
					</dt>
					<dd>
						<p>The name of any type of file within an [=OCF abstract container=], whether a directory or a
							file within a directory.</p>
					</dd>

					<dt>
						<dfn class="export">file path</dfn>
					</dt>
					<dd>
						<p>The file path of a file or directory is its full path relative to the [=root directory=], as
							defined by the algorithm specified in <a href="#sec-file-names-to-path-names"></a>.</p>
					</dd>

					<dt>
						<dfn class="export">fixed-layout document</dfn>
					</dt>
					<dd>
						<p>An [=EPUB content document=] with fixed dimensions directly referenced from the [=EPUB spine
							| spine=]. Fixed-layout documents are designated <code>pre-paginated</code> in the [=package
							document=], as defined in <a href="#sec-fixed-layouts"></a>.</p>
					</dd>

					<dt>
						<dfn class="export">foreign content document</dfn>
					</dt>
					<dd>
						<p>Any [=publication resource=] referenced from a [=EPUB spine | spine=] [^itemref^] element, or
							a [=manifest fallback chain=], that is not an [=EPUB content document=].</p>
						<p>When a foreign content document is referenced from a spine <code>itemref</code> element, it
							requires a manifest fallback chain with at least one EPUB content document.</p>
						<div class="note">
							<p>With the exception of XHTML and SVG, all [=core media type resources=] are foreign
								content documents when referenced directly from the spine.</p>
						</div>
					</dd>

					<dt>
						<dfn class="export">foreign resource</dfn>
					</dt>
					<dd>
						<p>A [=publication resource=] with a MIME media type [[rfc2046]] that does not match any of
							those listed in <a href="#sec-core-media-types"></a>. Foreign resources are subject to the
							fallback requirements defined in <a href="#sec-foreign-resources"></a>.</p>
						<p>The designation "foreign resource" only applies to resources used in the rendering of [=EPUB
							content documents=] and [=foreign content documents=].</p>
						<div class="note">
							<p>Foreign resource and foreign content document are not interchangeable terms. The types of
								resources considered foreign when used in the spine is greater than the types of
								resources considered foreign when used in <a href="#sec-contentdocs">EPUB content
									documents</a>.</p>
						</div>
					</dd>

					<dt>
						<dfn class="export">linked resource</dfn>
					</dt>
					<dd>
						<p>A resource that is only referenced from a [=package document=] [^link^] element (i.e., not
							also used in the rendering of an [=EPUB publication=].</p>
						<p>Linked resources are not [=publication resources=] but may be stored in the [=EPUB
							container=]. They do not require fallbacks.</p>
					</dd>

					<dt>
						<dfn class="export">media overlay document</dfn>
					</dt>
					<dd>
						<p>An XML document that associates the [=XHTML content document=] with pre-recorded audio
							narration to provide a synchronized playback experience, as defined in <a
								href="#sec-media-overlays"></a>.</p>
					</dd>

					<dt>
						<dfn class="export">non-codec</dfn>
					</dt>
					<dd>
						<p>Non-codec refers to content types that benefit from compression due to the nature of their
							internal data structure, such as file formats based on character strings (for example, HTML,
							CSS, etc.).</p>
					</dd>

					<dt>
						<dfn class="export">OCF abstract container</dfn>
					</dt>
					<dd>
						<p>The OCF abstract container defines a file system model for the contents of the [=OCF ZIP
							container=], as defined in <a href="#sec-container-abstract"></a>.</p>
					</dd>

					<dt>
						<dfn class="export">package document</dfn>
					</dt>
					<dd>
						<p>A [=publication resource=] that describes the rendering of an [=EPUB publication=], as
							defined in <a href="#sec-package-doc"></a>. The package document carries meta information
							about the EPUB publication, provides a manifest of resources, and defines a default reading
							order.</p>
					</dd>

					<dt>
						<dfn class="export">publication resource</dfn>
					</dt>
					<dd>
						<p>A resource that contains content or instructions that contribute to the logic and rendering
							of an [=EPUB publication=]. In the absence of this resource, [=reading systems=] may not
							render the EPUB publication as the [=EPUB creator=] intends. Examples of publication
							resources include the [=package document=], [=EPUB content documents=], CSS Style Sheets,
							audio, video, images, embedded fonts, and scripts.</p>
						<p>EPUB creators typically list publication resources in the package document [=EPUB manifest |
							manifest=] and bundle them in the [=EPUB container=], with the following exceptions:</p>
						<ul>
							<li>
								<p>they do not have to list resources encoded as <a href="#sec-data-urls">data URLs</a>
									in the manifest; and</p>
							</li>
							<li>
								<p>they may locate resources listed in <a href="#sec-resource-locations"></a> outside
									the EPUB container.</p>
							</li>
						</ul>
						<div class="note">
							<p>Resources on the web identified in outbound hyperlinks (e.g., referenced from the
									<code>href</code> attribute of an [[html]] [^a^] element) are not publication
								resources.</p>
						</div>
					</dd>

					<dt>
						<dfn class="export">remote resource</dfn>
					</dt>
					<dd>
						<p>A [=publication resource=] that is located outside of the [=EPUB container=], typically, but
							not necessarily, on the web.</p>
						<p>Publication resources within the EPUB container are referred to as [=container
							resources=].</p>
						<p>Refer to <a href="#sec-resource-locations"></a> for media type specific rules for resource
							locations.</p>
					</dd>

					<dt>
						<dfn class="export">root directory</dfn>
					</dt>
					<dd>
						<p>The root directory represents the base of the [=OCF abstract container=] file system. This
							directory is <a data-cite="epub-rs-33#confreq-zip-rootdir">virtual in nature</a>.</p>
					</dd>

					<dt>
						<dfn class="export">scripted content document</dfn>
					</dt>
					<dd>
						<p>An [=EPUB content document=] that includes scripting or an [=XHTML content document=] that
							contains [[html]] [=forms=].</p>
						<p>Refer to <a href="#sec-scripted-content"></a> for more information.</p>
					</dd>

					<dt>
						<dfn class="export">SVG content document</dfn>
					</dt>
					<dd>
						<p>An [=EPUB content document=] that conforms to the constraints expressed in <a href="#sec-svg"
							></a>.</p>
					</dd>

					<dt>
						<dfn class="export">synthetic spread</dfn>
					</dt>
					<dd>
						<p>The rendering of two adjacent pages simultaneously on a device screen.</p>
					</dd>

					<dt>
						<dfn class="export">top-level content document</dfn>
					</dt>
					<dd>
						<p>An [=EPUB content document=] or [=foreign content document=] referenced from the [=EPUB spine
							| spine=], whether directly or via a <a href="#sec-manifest-fallbacks">fallback
							chain</a>.</p>
					</dd>

					<dt>
						<dfn class="export">unique identifier</dfn>
					</dt>
					<dd>
						<p>The primary identifier for an [=EPUB publication=]. The unique identifier is the [=value=] of
							the [^dc:identifier^] element specified by the <a href="#attrdef-package-unique-identifier"
									><code>unique-identifier</code> attribute</a> in the [=package document=].</p>
						<p>Significant revision, abridgement, etc. of the content requires a new unique identifier.</p>
					</dd>

					<dt>
						<dfn class="export">viewport</dfn>
					</dt>
					<dd>
						<p>The region of an [=EPUB reading system=] in which an [=EPUB publication=] is rendered
							visually to a user.</p>
					</dd>

					<dt>
						<dfn class="export">XHTML content document</dfn>
					</dt>
					<dd>
						<p>An [=EPUB content document=] that conforms to the profile of [[html]] defined in <a
								href="#sec-xhtml"></a>.</p>
						<p>XHTML content documents use the <a data-cite="html#the-xhtml-syntax">XML syntax</a> defined
							in [[html]].</p>
					</dd>
				</dl>
			</section>

			<section id="conformance">
				<p>All algorithm explanations are <em>non-normative</em>.</p>
			</section>

			<section id="sec-intro-shorthands" class="informative">
				<h3>Authoring shorthands</h3>

				<p>In [=package document=] metadata examples, <a href="#sec-metadata-reserved-prefixes">reserved
						prefixes</a> are used without declaration.</p>

				<p>References to Dublin Core elements [[dcterms]] use the <code>dc:</code> prefix. This prefix must be
					declared in the [=package document=] for their use to be valid
						(<code>xmlns:dc="http://purl.org/dc/elements/1.1/"</code>)</p>

				<p>The <code>epub</code> namespace prefix [[xml-names]] is also used on elements and attributes without
					always having an explicit declaration (<code>xmlns:epub="http://www.idpf.org/2007/ops"</code>).</p>
			</section>
		</section>
		<section id="sec-epub-conf">
			<h2>EPUB publication conformance</h2>

			<p>An [=EPUB publication=]:</p>

			<ul class="conformance-list">
				<li>
					<p id="confreq-package">MUST define at least one rendering of its content as follows:</p>
					<ul class="conformance-list">
						<li>
							<p id="confreq-package-doc">MUST contain a [=package document=] that conforms to <a
									href="#sec-package-doc"></a> and meet all [=publication resource=] requirements for
								the package document.</p>
						</li>
						<li>
							<p id="confreq-nav">MUST contain an [=EPUB navigation document=] that conforms to <a
									href="#sec-nav"></a>.</p>
						</li>
					</ul>
				</li>
				<li>
					<p id="confreq-a11y">SHOULD conform to the accessibility requirements defined in
						[[epub-a11y-11]].</p>
				</li>
				<li>
					<p id="confreq-ocf">MUST be packaged in an [=EPUB container=] as defined in <a href="#sec-ocf"
						></a>.</p>
				</li>
			</ul>

			<p id="confreq-res-location">In addition, all publication resources MUST adhere to the requirements in <a
					href="#sec-publication-resources"></a>.</p>

			<p>The rest of this specification covers specific conformance details.</p>

			<section id="sec-conformance-checking" class="informative">
				<h3>Conformance checking</h3>

				<p>Due to the complexity of this specification and number of technologies used in [=EPUB publications=],
					[=EPUB creators=] are advised to use an [=EPUB conformance checker=] to verify the conformance of
					their content.</p>

				<p><a href="https://www.w3.org/publishing/epubcheck/">EPUBCheck</a> is the de facto EPUB conformance
					checker used by the publishing industry and has been updated with each new version of EPUB. It is
					integrated into a number of authoring tools and also available in alternative interfaces and other
					languages (for more information, refer to its <a
						href="https://www.w3.org/publishing/epubcheck/docs/apps-and-tools/">Apps and Tools
					page</a>).</p>

				<p>When verifying their EPUB publications, EPUB creators should ensure they do not violate the
					requirements of this specification (practices identified by the keywords "MUST", "MUST NOT", and
					"REQUIRED"). These types of issues will often result in EPUB publications not rendering or rendering
					in inconsistent ways. These issues are typically reported as errors or critical errors.</p>

				<p>EPUB creators should also ensure that their EPUB publications do not violate the recommendations of
					this specification (practices identified by the keywords "SHOULD", "SHOULD NOT", and "RECOMMENDED").
					Failure to follow these practices does not result in an invalid EPUB publication but may lead to
					interoperability problems and other issues that impact the user reading experience. These issues are
					typically reported as warnings.</p>

				<div class="note">
					<p>Vendors, distributors, and other retailers of EPUB publications should consider the importance of
						recommended practices before basing their acceptance or rejection on a zero-issue outcome from
						an EPUB conformance checker. There will be legitimate reasons why EPUB creators cannot follow
						recommended practices in all cases.</p>
				</div>
			</section>
		</section>
		<section id="sec-publication-resources">
			<h2>Publication resources</h2>

			<section id="sec-pub-res-intro" class="informative">
				<h3>Introduction</h3>

				<p>An [=EPUB publication=] is made up of many different categories of resources, not all of which are
					mutually exclusive. Some resources are [=publication resources=], some are not. Some publication
					resources are allowed in the [=EPUB spine | spine=] by default, while all others require fallbacks.
					Some resources can be used in rendering [=EPUB content documents=], while others can only be used
					with fallbacks.</p>

				<p>Trying to understand these differences by reading the technical definitions of each category of
					resource can be complex. To make the categorizations easier to understand, this introduction uses
					the concept of different planes to explain how resources are grouped and referred to.</p>

				<p>The three planes are:</p>

				<ul>
					<li>The [=manifest plane=] &#8212; The manifest plane holds all the resources of the EPUB
						publication (namely, publication resources and [=linked resources=]).</li>
					<li>The [=spine plane=] &#8212; The spine plane holds only the resources used in rendering the spine
						(namely, EPUB content documents and [=foreign content documents=]).</li>
					<li>The [=content plane=] &#8212; The content plane holds only the resources used in the rendering
						of EPUB and foreign content documents (namely, [=core media type resources=], [=foreign
						resources=] and [=exempt resources=]).</li>
				</ul>

				<p>The same resource may exist on more than one plane and will be referred to differently in this
					specification depending on which plane is being discussed. For example, a core media type resource
					used in the rendering of an EPUB content document (on the content plane) may also be a foreign
					content document if it is also listed in the spine (the spine plane).</p>

				<p>The following sections describe these planes in more detail.</p>

				<div class="note">
					<p>Refer to <a href="#publication-resources-example"></a> for a detailed example showing how
						resources fit into the different planes.</p>
				</div>

				<section id="sec-manifest-plane">
					<h4>The manifest plane</h4>

					<p>To <dfn class="export" data-lt-no-plural="">manifest plane</dfn> defines all the resources of an
						[=EPUB publication=]. It is analogous to the [=package document=] [=EPUB manifest | manifest=],
						but includes resources not present in that list.</p>

					<p>The primary resources in this group are designated [=publication resources=], which are all the
						resources used in rendering an EPUB publication to the user. [=EPUB creators=] always have to
						list these resources in the [^manifest^] element.</p>

					<p>Publication resources are further classified by their use(s) in the [=spine plane=] and [=content
						plane=].</p>

					<p>The manifest plane also contains a set of [=linked resources=]. These resources are tangential to
						the direct rendering. They include, for example, metadata records and links to external content
						(e.g., where to purchase an EPUB publication).</p>

					<p>Unlike publication resources, they are not listed in the package document manifest (i.e., because
						they are not essential to rendering the EPUB publication). They are instead defined in [^link^]
						elements in the package document metadata. These elements define their nature and purpose
						similar to how manifest [^item^] elements define publication resource. (In this way, they are
						like an extension of the manifest.)</p>

					<p>Refer to <a href="#sec-link-elem"></a> for more information about linked resources.</p>

					<p>Resources in the manifest plane are also sometimes broken down by where they are located.
						Although most publication resources have to be located in the EPUB container (called [=container
						resources=]), EPUB 3 allows <a href="#sec-resource-locations">audio, video, font and script data
							resources</a> to be hosted outside the container. These exceptions were made to speed up the
						download and loading of EPUB publications, as these resources are typically quite large, and, in
						the case of fonts, not essential to the presentation. When remotely hosted, these publication
						resources are referred to as [=remote resources=].</p>

					<p>Since linked resources are not essential to the rendering of an EPUB publication, there are no
						requirements on where they are located and consequently no special naming of them based on their
						location. They may be located within the EPUB container or outside it.</p>

					<div class="note">
						<p>Hyperlinked content outside the EPUB container (e.g., web pages) are not publication
							resources, and consequently are not listed in the manifest. Reading systems will normally
							open these links in a separate browser instance, not as part of the EPUB publication.</p>
					</div>
				</section>

				<section id="sec-spine-plane">
					<h4>The spine plane</h4>

					<p>The <dfn class="export" data-lt-no-plural="">spine plane</dfn> defines resources used in the
						default reading order established by the [=EPUB spine | spine=], which includes both <a
							href="#attrdef-itemref-linear">linear and non-linear content</a>. The spine instructs
						[=reading systems=] on how to load these resources as the user progresses through the [=EPUB
						publication=]. Although many resources may be bundled in an [=EPUB container=], they are not all
						allowed by default in the spine.</p>

					<p>EPUB 3 defines a special class of resources called [=EPUB content documents=] that [=EPUB
						creators=] can use in the spine without any restrictions. EPUB content documents encompass both
						[=XHTML content documents=] and [=SVG content documents=].</p>

					<p>To use any other type of resource in the spine, called a [=foreign content document=], requires
						including a fallback to an EPUB content document. This extensibility model allows EPUB creators
						to experiment with formats while ensuring that reading systems are always able to render
						something for the user to read, as there is no guarantee of support for foreign content
						documents.</p>

					<p>A mechanism called <a href="#sec-manifest-fallbacks">manifest fallbacks</a> allows EPUB creators
						to provide fallbacks for foreign content documents. In this model, the [=EPUB manifest |
						manifest=] entry for the foreign content document must include a <a
							href="#attrdef-item-fallback"><code>fallback</code> attribute</a> that points to the next
						possible resource for reading systems to try when they do not support its format. Although not
						common, a fallback resource can specify another fallback, thereby making chains many resources
						deep. The one requirement is that there must be at least one EPUB content document in a
						[=manifest fallback chain=].</p>

					<p>Although they are not directly listed in the spine, all of the resources in the fallback chain
						are considered part of the spine, and by extension part of the spine plane, since any may be
						used by a reading system.</p>

					<p>Refer to <a href="#sec-manifest-fallbacks"></a> for more information.</p>

					<div class="caution">
						<p id="caution-fallbacks">Although manifest fallbacks fulfill the technical requirements of
							EPUB, there is little practical support for them in reading systems. Their use is strongly
							discouraged as it can lead to unreadable publications.</p>
					</div>

					<div class="note">
						<p>It is possible to provide manifest fallbacks for EPUB content documents, but this is not
							required or common. For example, a [=scripted content document=] could have a fallback to an
							unscripted alternative for reading systems that do not support scripting.</p>
					</div>
				</section>

				<section id="sec-content-plane">
					<h4>The content plane</h4>

					<p>The <dfn class="export" data-lt-no-plural="">content plane</dfn> classifies resources that are
						used when rendering [=EPUB content documents=] and [=foreign content documents=]. These types of
						resources include embedded media, CSS style sheets, scripts, and fonts. These resources fall
						into three categories based on their reading system support: [=core media type resources=],
						[=foreign resources=], and [=exempt resources=].</p>

					<p>A core media type resource is one that [=reading systems=] have to support, so it can be used
						without restriction in EPUB or foreign content documents. For more information about core media
						type resources, refer to <a href="#sec-core-media-types"></a>.</p>

					<div class="note">
						<p>Being a core media type resource does not mean that reading systems will always render the
							resource, as not all reading systems support all features of EPUB 3. A reading system
							without a [=viewport=], for example, will not render visual content such as images.</p>
					</div>

					<p>The opposite of core media type resources are foreign resources. These are resources that reading
						systems are not guaranteed to support the rendering of. As a result, similar to how using
						foreign content documents in the spine requires fallbacks to ensure their rendering, using
						foreign resources in content documents also requires fallbacks. These fallbacks are provided in
						one of two ways: using the capabilities of the host format or via manifest fallbacks.</p>

					<p>The preferred method is to use the fallback capabilities of the host format. Many HTML elements,
						for example, have intrinsic fallback capabilities. One example is the [^picture^]
						element [[html]], which allows [=EPUB creators=] to specify multiple alternative image
						formats.</p>

					<p>If an intrinsic fallback method is not available, it is also possible to use manifest fallbacks,
						but this method, as <a href="#caution-fallbacks">cautioned against</a> in the previous section,
						is discouraged. For more information about foreign resources, refer to <a
							href="#sec-foreign-resources"></a>.</p>

					<p>Falling between core media type resources and foreign resources are exempt resources. These are
						most closely associated with foreign resources, as there is no guarantee that reading systems
						will render them. But like core media types, they do not require fallbacks.</p>

					<p>Exempt resources tend to address specific cases for which there are no core media types defined,
						but for which providing a fallback would prove cumbersome or unnecessary. These include
						embedding video, adding accessibility tracks, and linking to resources from the [[html]] <a
							data-cite="html#the-link-element"><code>link</code></a> element.</p>

					<p>Refer to <a href="#sec-exempt-resources"></a> for more information about these exceptions.</p>

					<div class="note">
						<p>A common point of confusion arising from core media type resources is the listing of XHTML
							and SVG as core media type resources with the requirement the markup conform to their
							respective EPUB content document definitions. This allows EPUB creators to embed both XHTML
							and SVG documents in EPUB content documents while keeping consistent requirements for
							authoring and reading system support.</p>

						<p>In practice, it means that EPUB creators can put XHTML and SVG core media type resources in
							the spine without any modification or fallback (they are also conforming XHTML and SVG
							content documents), but this is a unique case. All other core media type resources become
							foreign content documents when used in the spine (i.e., foreign content documents include
							all foreign resources and all core media type resources except for XHTML and SVG).</p>
					</div>
				</section>
			</section>

			<section id="sec-core-media-types">
				<h3>Core media types</h3>

				<p>[=EPUB creators=] MAY include [=publication resources=] that conform to the MIME media type
					[[rfc2046]] specifications defined in the following table without fallbacks when they are used in
					[=EPUB content documents=] and [=foreign content documents=]. These resources are classified as
					[=core media type resources=].</p>

				<p>With the exception of [=XHTML content documents=] and [=SVG content documents=], EPUB creators MUST
					provide <a href="#sec-manifest-fallbacks">manifest fallbacks</a> for core media type resources
					referenced directly from the [=EPUB spine | spine=]. In this case, they are [=foreign content
					documents=].</p>

				<p>The columns in the table represent the following information:</p>

				<ul>
					<li>
						<p><strong>Media Type</strong>—The MIME media type [[rfc2046]] used to represent the given
							publication resource in the [=EPUB manifest | manifest=].</p>
						<p>If the table lists more than one media type, the first one is the preferred media type. EPUB
							creators should use the preferred media type for all new EPUB publications.</p>
					</li>
					<li><strong>Content Type Definition</strong>—The specification to which the given core media type
						resource must conform.</li>
					<li><strong>Applies to</strong>—The publication resource type(s) that the Media Type and Content
						Type Definition applies to.</li>
				</ul>

				<table id="tbl-core-media-types">
					<thead>
						<tr>
							<th id="tbl-cmt-string">Media Type</th>
							<th id="tbl-cmt-def">Content Type Definition</th>
							<th id="tbl-cmt-appl">Applies to</th>
						</tr>
					</thead>
					<tbody>
						<tr>
							<th colspan="3" id="cmt-grp-image" class="tbl-group">Images</th>
						</tr>
						<tr>
							<td id="cmt-gif" data-tests="#pub-cmt-gif">
								<code>image/gif</code>
							</td>
							<td> [[gif]] </td>
							<td>GIF Images</td>
						</tr>
						<tr>
							<td id="cmt-jpeg" data-tests="#pub-cmt-jpeg">
								<code>image/jpeg</code>
							</td>
							<td> [[jpeg]] </td>
							<td>JPEG Images</td>
						</tr>
						<tr>
							<td id="cmt-png" data-tests="#pub-cmt-png">
								<code>image/png</code>
							</td>
							<td> [[png]] </td>
							<td>PNG Images</td>
						</tr>
						<tr>
							<td id="cmt-svg" data-tests="#pub-cmt-svg,#cnt-svg-support">
								<code>image/svg+xml</code>
							</td>
							<td>
								<a href="#sec-svg">SVG content documents</a>
							</td>
							<td>SVG documents</td>
						</tr>
						<tr>
							<td id="cmt-webp" data-tests="#pub-cmt-webp">
								<code>image/webp</code>
							</td>
							<td> [[webp-container]], [[webp-lb]] </td>
							<td>WebP Images</td>
						</tr>
						<tr>
							<th colspan="3" id="cmt-grp-audio" class="tbl-group">Audio</th>
						</tr>
						<tr>
							<td id="cmt-mp3" data-tests="#pub-cmt-mp3">
								<code>audio/mpeg</code>
							</td>
							<td> [[mp3]] </td>
							<td>MP3 audio</td>
						</tr>
						<tr>
							<td id="cmt-mp4-aac" data-tests="#pub-cmt-mp4">
								<code>audio/mp4</code>
							</td>
							<td> [[mpeg4-audio]], [[mp4]] </td>
							<td>AAC LC audio using MP4 container</td>
						</tr>
						<tr>
							<td id="cmt-ogg-opus" data-tests="#pub-cmt-opus">
								<code>audio/opus</code>
							</td>
							<td> [[rfc7845]] </td>
							<td>OPUS audio using OGG container</td>
						</tr>
						<tr>
							<th colspan="3" id="cmt-grp-text" class="tbl-group">Style</th>
						</tr>
						<tr>
							<td id="cmt-css">
								<code>text/css</code>
							</td>
							<td>
								<a href="#sec-css">CSS Style Sheets</a>
							</td>
							<td>CSS Style Sheets.</td>
						</tr>
						<tr>
							<th colspan="3" id="cmt-grp-font" class="tbl-group">Fonts</th>
						</tr>
						<tr>
							<td id="cmt-sfnt">
								<ol class="cmt">
									<li><code>font/ttf</code></li>
									<li><code>application/font-sfnt</code></li>
								</ol>
							</td>
							<td>[[truetype]] </td>
							<td>TrueType fonts</td>
						</tr>
						<tr>
							<td id="cmt-otf">
								<ol class="cmt">
									<li><code>font/otf</code></li>
									<li><code>application/font-sfnt</code></li>
									<li><code>application/vnd.ms-opentype</code></li>
								</ol>
							</td>
							<td>[[opentype]]</td>
							<td>OpenType fonts</td>
						</tr>
						<tr>
							<td id="cmt-woff">
								<ol class="cmt">
									<li><code>font/woff</code></li>
									<li><code>application/font-woff</code></li>
								</ol>
							</td>
							<td> [[woff]] </td>
							<td>WOFF fonts</td>
						</tr>
						<tr>
							<td id="cmt-woff2">
								<code>font/woff2</code>
							</td>
							<td> [[woff2]] </td>
							<td>WOFF2 fonts</td>
						</tr>
						<tr>
							<th colspan="3" id="cmt-grp-other" class="tbl-group">Other</th>
						</tr>
						<tr>
							<td id="cmt-xhtml">
								<code>application/xhtml+xml</code>
							</td>
							<td>
								<a href="#sec-xhtml">XHTML content documents</a>
							</td>
							<td>HTML documents that use the <a data-cite="html#the-xhtml-syntax">XML syntax</a>
								[[html]].</td>
						</tr>
						<tr>
							<td id="cmt-js">
								<ol class="cmt">
									<li><code>application/javascript</code></li>
									<li><code>application/ecmascript</code></li>
									<li><code>text/javascript</code></li>
								</ol>
							</td>
							<td> [[rfc4329]] </td>
							<td>Scripts.</td>
						</tr>
						<tr>
							<td id="cmt-ncx">
								<code>application/x-dtbncx+xml</code>
							</td>
							<td> [[opf-201]] </td>
							<td>The <a href="#sec-pkg-legacy-intro">legacy</a> NCX.</td>
						</tr>
						<tr>
							<td id="cmt-smil">
								<code>application/smil+xml</code>
							</td>
							<td>
								<a href="#sec-media-overlays">Media overlays</a>
							</td>
							<td>EPUB media overlay documents</td>
						</tr>
					</tbody>
				</table>

				<div class="note">
					<p>Inclusion as a core media type resource does not mean that all reading systems will support the
						rendering of a resource. Reading system support also depends on the capabilities of the
						application (e.g., a reading system with a [=viewport=] must support image core media type
						resources, but a reading system without a viewport does not). Refer to <a
							data-cite="epub-rs-33#sec-epub-rs-conf-cmt">Core media types</a> [[epub-rs-33]] for more
						information about which reading systems rendering capabilities require support for which core
						media type resources.</p>

					<p>The Working Group typically only includes formats as core media type resources when they have
						broad support in web browser cores &#8212; the rendering engines that EPUB 3 reading systems
						build upon. They are an agreement between reading system developers and EPUB creators to ensure
						the predictability of rendering of EPUB publications.</p>
				</div>
			</section>

			<section id="sec-foreign-resources">
				<h3>Foreign resources</h3>

				<p>A [=foreign resource=], unlike a <a href="#sec-core-media-types">core media type resource</a> is one
					which is not guaranteed [=reading system=] support when used in an [=EPUB content document=] or
					[=foreign content document=].</p>

				<p id="confreq-cmt">[=EPUB creators=] MUST provide fallbacks for foreign resources, where fallbacks take
					one of the following forms:</p>

				<ul>
					<li>
						<p>intrinsic fallback mechanisms provided by the host format (e.g., [[?html]] elements often
							provide the ability to reference more than one media type or to display an alternate
							embedded message when a media type cannot be rendered); or</p>
					</li>
					<li>
						<p><a href="#sec-manifest-fallbacks">manifest fallback chains</a> defined on [^item^] elements
							in the [=package document=].</p>
					</li>
				</ul>

				<div class="note">
					<p>Refer to the [[html]] and [[svg]] specifications for the intrinsic fallback capabilities their
						elements provide.</p>
					<p><a href="#sec-intrinsic-fallbacks"></a> also provides additional information about how fallbacks
						are interpreted for specific elements.</p>
				</div>
			</section>

			<section id="sec-exempt-resources">
				<h3>Exempt resources</h3>

				<p>An [=exempt resource=] shares properties with both [=foreign resources=] and [=core media type
					resources=]. It is most similar to a [=foreign resource=] in that it is not guaranteed [=reading
					system=] support, but, like a core media type resource, does not require a fallback.</p>

				<p>There are only a small set of special cases for exempt resources. Video, for example, are exempt from
					fallbacks because there is no consensus on a core media type video format at this time (i.e., there
					is no format to fallback to). Similarly, audio and video tracks are exempt to allow [=EPUB
					creators=] to meet accessibility requirements using whatever format reading systems support
					best.</p>

				<p>The following list details cases of content-specific exempt resources, including any restrictions on
					where EPUB creators can use them.</p>

				<dl>
					<dt id="exempt-fonts">Fonts</dt>
					<dd id="confreq-resources-cd-fonts">
						<p>All font resources not already covered as <a href="#cmt-grp-font">font core media types</a>
							are exempt resources.</p>
						<p>This exemption allows EPUB creators to use any font format without a fallback, regardless of
							reading system support expectations, as CSS rules will ensure a fallback font in case of no
							support.</p>
						<p>Refer to the <a data-cite="epub-rs-33#confreq-css-rs-fonts">reading system support
								requirements for fonts</a> [[epub-rs-33]] for more information.</p>
					</dd>

					<dt id="exempt-links">Linked resources</dt>
					<dd id="confreq-resources-cd-fallback-link">
						<p>Any resource referenced from the [[html]] <a data-cite="html#the-link-element"
									><code>link</code></a> element that is not already a core media type resource (e.g.,
							CSS style sheets) is an exempt resource.</p>
					</dd>

					<dt id="exempt-track">Tracks</dt>
					<dd id="confreq-resources-cd-fallback-track">
						<p>All audio and video tracks (e.g., [[?webvtt]] captions, subtitles and descriptions)
							referenced from the [[html]] [^track^] element are exempt resources.</p>
					</dd>

					<dt id="exempt-video">Video</dt>
					<dd id="confreq-resources-cd-fallback-video">
						<p>All video codecs referenced from the [[html]] [^video^] — including any child [^source^]
							elements — are exempt resources.</p>
						<div class="note">
							<p>Although reading systems are encouraged to support at least one of the H.264 [[?h264]]
								and VP8 [[?rfc6386]] video codecs, support for video codecs is not a conformance
								requirement. EPUB creators must consider factors such as breadth of adoption, playback
								quality, and technology royalties when deciding which video formats to include.</p>
						</div>
					</dd>
				</dl>

				<div class="note">
					<p>The exemptions made above do not apply to the [=EPUB spine | spine=]. If an exempt resource is
						used in the spine, and it is not also an [=EPUB content document=], it will require a fallback
						in that context.</p>
				</div>

				<p id="confreq-foreign-no-fallback">In addition to the content-specific exemptions, a resource is
					classified as an exempt resource if:</p>

				<ul>
					<li>
						<p>it is not referenced from a spine [^itemref^] element (i.e., used as a [=foreign content
							document=]); <strong><em>and</em></strong></p>
					</li>
					<li>
						<p>it is not embedded directly in EPUB content documents (e.g., via [[?html]] [=embedded
							content=] and [[?svg]] <a href="https://www.w3.org/TR/SVG/embedded.html#ImageElement"
									><code>image</code></a> and <a
								href="https://www.w3.org/TR/SVG/embedded.html#ForeignObjectElement"
									><code>foreignObject</code></a> elements).</p>
					</li>
				</ul>

				<p>This exemption allows EPUB creators to include resources in the [=EPUB container=] that are not for
					use by EPUB reading systems. The primary case for this exemption is to allow data files to travel
					with an [=EPUB publication=], whether for scripts to use in their constituent EPUB content documents
					or for external applications to use (e.g., a scientific journal might include a data set with
					instructions on how to extract it from the EPUB container).</p>

				<p>It also allows EPUB creators to use foreign resources in foreign content documents without reading
					systems or [=EPUB conformance checkers=] having to understand the fallback capabilities of those
					resources (i.e., the requirement for a fallback for the foreign content document covers any
					rendering issues within it). As the resource is not referenced from an EPUB content document, it
					automatically becomes exempt from fallbacks.</p>
			</section>

			<section id="sec-resource-fallbacks">
				<h4>Resource fallbacks</h4>

				<section id="sec-manifest-fallbacks">
					<h5>Manifest fallbacks</h5>

					<p>Manifest fallbacks are a feature of the [=package document=] that create a <dfn class="export"
							>manifest fallback chain</dfn> for a [=publication resource=], allowing [=reading systems=]
						to select an alternative format they can render.</p>

					<p>Fallback chains are created using the <a href="#attrdef-item-fallback"><code>fallback</code>
							attribute</a> on [=EPUB Manifest | manifest=] [^item^] elements. This attribute references
						the <a data-cite="xml#id">ID</a> [[xml]] of another manifest <code>item</code> that is a
						fallback for the current <code>item</code>. The ordered list of all the references that a
						reading system can reach, starting from a given <code>item</code>'s <code>fallback</code>
						attribute, represents the full fallback chain for that <code>item</code>. This chain also
						represents the [=EPUB creator | EPUB creator's=] preferred fallback order.</p>

					<p>There are two cases for manifest fallbacks:</p>

					<dl>
						<dt id="spine-fallbacks">Spine fallbacks</dt>
						<dd>
							<p>EPUB creators MUST specify a fallback chain for a [=foreign content document=] to ensure
								that reading systems can always render the [=EPUB spine | spine=] item. In this case,
								the chain MUST contain at least one [=EPUB content document=].</p>
							<p>EPUB creators MAY provide fallbacks for EPUB content documents (e.g., to provide a <a
									href="#confreq-cd-scripted-flbk">fallback for scripted content</a>).</p>
							<p>When a fallback chain includes more than one EPUB content document, EPUB creators can use
								the <a href="#attrdef-properties"><code>properties</code> attribute</a> to differentiate
								the purpose of each.</p>
						</dd>

						<dt id="content-fallbacks">Content fallbacks</dt>
						<dd>
							<div class="note">
								<p>The original purpose for content fallbacks was to specify fallback images for the
									[[html]] [^img^] element. As HTML now has intrinsic fallback mechanism for images,
									the use of content fallbacks is strongly discouraged. EPUB creators should always
									use the intrinsic fallback capabilities of [[html]] and [[svg]] to provide fallback
									content.</p>
							</div>
							<p>EPUB creators MUST provide a content fallback for [=foreign resources=] when the elements
								that reference them do not have intrinsic fallback capabilities. In this case, the
								fallback chain MUST contain at least one [=core media type resource=].</p>
							<p>EPUB creators MAY also provide manifest fallbacks for core media type resources (e.g., to
								allow reading systems to select from more than one image format).</p>
						</dd>
					</dl>

					<p>Regardless of the type of manifest fallback specified, fallback chains MUST NOT contain
						self-references or circular references to <code>item</code> elements in the chain.</p>

					<div class="note">
						<p>As it is not possible to use manifest fallbacks for resources represented in <a
								href="#sec-data-urls">data URLs</a>, EPUB creators can only represent foreign resources
							as data URLs where an intrinsic fallback mechanism is available.</p>
					</div>
				</section>

				<section id="sec-intrinsic-fallbacks">
					<h4>Intrinsic fallbacks</h4>

					<p>The following sections provide additional clarifications about the intrinsic fallback
						requirements of specific elements.</p>

					<section id="sec-fallbacks-audio">
						<h5>HTML <code>audio</code> fallbacks</h5>

						<p id="confreq-resources-cd-fallback-media">[=EPUB creators=] MUST NOT use embedded
							[[html]] [=flow content=] within the <a data-cite="html#the-audio-element"
									><code>audio</code></a> element as an intrinsic fallback for [=foreign resources=].
							Only child [^source^] elements [[html]] provide intrinsic fallback capabilities.</p>

						<p>Only older [=reading systems=] that do not recognize the <code>audio</code> element (e.g.,
							EPUB 2 reading systems) will render the embedded content. When reading systems support the
								<code>audio</code> element but not the available audio formats, they do not render the
							embedded content for the user.</p>

						<div class="note">
							<p>As video resources are [=exempt resources=], this requirement does not apply to the
									<code>video</code> element. EPUB creators may also include flow content in the
									<code>video</code> element for reading systems that do not support the element,
								however.</p>
						</div>
					</section>

					<section id="sec-fallbacks-img">
						<h5>HTML <code>img</code> fallbacks</h5>

						<p id="confreq-resources-cd-fallback-img">Due to the variety of sources that [=EPUB creators=]
							can specify in the [[html]] [^img^] element, the following fallback conditions apply to its
							use:</p>
						<ul>
							<li>
								<p>If it is the child of a [^picture^] element:</p>
								<ul>
									<li>it MUST reference core media type resources from its <code>src</code> and
											<code>srcset</code> attributes, when EPUB creators specify those attributes;
										and</li>
									<li>each sibling [^source^] element MUST reference a [=core media type resource=]
										from its <code>[^source/src^]</code> and <code>[^source/srcset^]</code>
										attributes unless it specifies the MIME media type [[rfc2046]] of a [=foreign
										resource=] in its <code>[^source/type^]</code> attribute.</li>
								</ul>
							</li>

							<li>Otherwise, it MAY reference foreign resources in its <code>[^img/src^]</code> and
									<code>[^img/srcset^]</code> attributes provided EPUB creators define a <a
									href="#sec-manifest-fallbacks">manifest fallback</a>.</li>
						</ul>
					</section>
					<section>
						<h5>HTML <code>script</code> element</h5>

						<p>Although the [[html]] [^script^] element lacks intrinsic fallback capabilities, it is not
							required that [=EPUB creators=] provide fallbacks for <a data-cite="html#data-block">data
								blocks</a> [[html]]. As the <code>script</code> element does not represent user content,
							data blocks are not rendered unless manipulated by script.</p>

						<div class="note">
							<p>The exemption from fallbacks aligns data blocks with the exemption made to <a
									href="#confreq-foreign-no-fallback">allow data files</a> to travel in the [=EPUB
								container=]. As data blocks are not separate resources from their host [=EPUB content
								document=], they do not fall under the same exemption.</p>
						</div>
						<div class="note">
							<p>[[svg]] does not define data blocks as of publication, but the same exclusion would apply
								if a future update adds the concept.</p>
						</div>
					</section>
				</section>
			</section>

			<section id="sec-resource-locations">
				<h4>Resource locations</h4>

				<p>[=EPUB creators=] MAY host the following types of [=publication resources=] outside the [=EPUB
					container=]:</p>

				<ul class="conformance-list">
					<li>
						<p id="sec-resource-locations-audio"><a href="#cmt-grp-audio">Audio resources</a>.</p>
					</li>
					<li>
						<p id="sec-resource-locations-video"><a href="#exempt-video">Video resources</a>.</p>
					</li>
					<li>
						<p id="sec-resource-locations-script">Resources retrieved via scripting APIs (e.g.,
							XmlHttpRequest [[?xhr]] and Fetch [[?fetch]]).</p>
					</li>
					<li>
						<p id="sec-resource-locations-fonts"><a href="#cmt-grp-font">Font resources</a>.</p>
					</li>
				</ul>

				<p>EPUB creators MUST store all other resources within the EPUB container.</p>

				<p>Storing all resources inside the EPUB container is strongly encouraged whenever possible as it allows
					users access to the entire presentation regardless of connectivity status.</p>

				<p>When resources have to be located outside the EPUB container, EPUB creators are RECOMMENDED to
					reference them via the secure <code>https</code> URI scheme [rfc7230] to limit the threat of
					exposing their publications, and users, to network attacks. [=Reading systems=] might not load
					[=remote resources=] referenced using insecure schemes such as <code>http</code>.</p>

				<p>These rules for locating publication resource apply regardless of whether the given resource is a
					[=core media type resource=] or a [=foreign resource=].</p>

				<div class="note">
					<p>Refer to the <a href="#remote-resources"><code>remote-resources</code> property</a> for more
						information on how to indicate that a [=EPUB manifest | manifest=] [^item^] references a
						[=remote resource=].</p>
				</div>

				<aside class="example" title="Referencing a container resource">
					<p>In this example, the audio file referenced from the [[html]] <a
							data-cite="html#the-audio-element"><code>audio</code></a> element is located inside the EPUB
						container.</p>
					<pre>&lt;html …>
   …
   &lt;body>
      …
      &lt;audio
          src="audio/ch01.mp4"
          controls="controls"/>
      …
   &lt;/body>
&lt;/html></pre>
				</aside>

				<aside class="example" title="Referencing a remote resource">
					<p>In this example, the audio file referenced from the [[html]] <a
							data-cite="html#the-audio-element"><code>audio</code></a> element is hosted on the web.</p>
					<pre>&lt;html …>
   …
   &lt;body>
      …
         &lt;audio
             src="http://www.example.com/book/audio/ch01.mp4"
             controls="controls"/>
      …
   &lt;/body>
&lt;/html></pre>
				</aside>
			</section>

			<section id="sec-data-urls">
				<h3>Data URLs</h3>

				<p>The <a data-cite="rfc2397#"><code>data:</code> URL scheme</a> [[rfc2397]] is used to encode resources
					directly into a URL string. The advantage of this scheme is that it allows [=EPUB creators=] to
					embed a resource within another, avoiding the need for an external file.</p>

				<p>EPUB creators MAY use data URLs in [=EPUB publications=] provided their use does not result in a
					[=top-level content document=] or [=top-level browsing context=] [[html]]. This restriction applies
					to data URLs used in the following scenarios:</p>

				<ul>
					<li>
						<p>in [EPUB manifest | manifest=] [^item^] elements referenced from the [=EPUB spine |
							spine=];</p>
					</li>
					<li>
						<p>in the <code>href</code> attribute on [[html]] or [[svg]] <code>a</code> elements (except
							when inside an [^iframe^] element [[html]]);</p>
					</li>
					<li>
						<p>in the <code>href</code> attribute on [[html]] <code>area</code> elements (except when inside
							an <code>iframe</code> element);</p>
					</li>
					<li>
						<p>in calls to [[ecmascript]] <code>window.open</code> or <code>document.open</code>.</p>
					</li>
				</ul>

				<div class="note">
					<p>The list of prohibited uses for data URLs is subject to change as the respective standards that
						allow their use evolve.</p>
				</div>

				<p>This restriction on their use is to prevent security issues and also to ensure that [=reading
					systems=] can determine where to take a user next (i.e., because these resources are not be listed
					in the spine).</p>

				<p>Resources represented as data URLs are not publication resources so are exempt from the requirement
					for EPUB creators to list them in the manifest.</p>

				<p>EPUB creators MUST encode Data URLs as core media type resources or use them where they can provide a
					fallback (i.e., data URLs are subject to the <a href="#sec-foreign-resources">foreign resource
						restrictions</a>).</p>
			</section>

			<section id="sec-file-urls">
				<h3>File URLs</h3>

				<p>The <a data-cite="rfc8089#"><code>file:</code> URL scheme</a> is defined in [[rfc8089]] as
					"identifying an object (a 'file') stored in a structured object naming and accessing environment on
					a host (a 'file system')." It is typically used to retrieve files from the local operating
					system.</p>

				<p>Using a file URL in an [=EPUB publication=], which can be transferred among different hosts,
					represents a security risk and is also non-interoperable. As a consequence, [=EPUB creators=] MUST
					NOT use file URLs in EPUB publications.</p>
			</section>

			<section id="sec-xml-constraints">
				<h3>XML conformance</h3>

				<p>Any [=publication resource=] that is an XML-based media type [[rfc2046]]:</p>

				<ul class="conformance-list">
					<li>
						<p id="confreq-xml-wellformed">MUST be a conformant XML 1.0 Document as defined in <a
								data-cite="xml-names#Conformance">Conformance of Documents</a> [[xml-names]].</p>
					</li>
					<li>
						<p id="confreq-xml-identifiers">MAY only specify a <a data-cite="xml#dt-doctype">document type
								declaration</a> that references an <a data-cite="xml#NT-ExternalID">external
								identifier</a> appropriate for its media type &#8212; as defined in <a
								href="#app-identifiers-allowed"></a> &#8212; or that omits external identifiers
							[[xml]].</p>
					</li>
					<li>
						<p id="confreq-xml-entities">MUST NOT contain <a data-cite="xml#dt-extent">external entity</a>
							declarations in the internal DTD subset [[xml]].</p>
					</li>
					<li>
						<p id="confreq-xml-xinc">MUST NOT make use of XInclude [[xinclude]].</p>
					</li>
					<li>
						<p id="confreq-xml-enc">MUST be encoded in UTF-8 or UTF-16 [[unicode]], with UTF-8 as the
							RECOMMENDED encoding.</p>
					</li>
				</ul>

				<p>The above constraints apply regardless of whether the given publication resource is a [=core media
					type resource=] or a [=foreign resource=].</p>

				<div class="note">
					<p>[[html]] and [[svg]] are removing support for the XML <code>base</code> attribute [[xmlbase]].
						EPUB creators should avoid using this feature.</p>
				</div>
			</section>
		</section>
		<section id="sec-ocf">
			<h2>Open Container Format (OCF)</h2>

			<section id="sec-ocf-intro" class="informative">
				<h3>Introduction</h3>

				<p>OCF is the required container technology for [=EPUB publications=]. OCF may play a role in the
					following workflows:</p>

				<ul>
					<li>During the preparation steps in producing an EPUB publication, OCF may be used as the container
						format when exchanging in-progress publications between different individuals and/or different
						organizations.</li>
					<li>When providing an EPUB publication from publisher or conversion house to the distribution or
						sales channel, OCF is the recommended container format to be used as the transport format.</li>
					<li>When delivering the final EPUB publication to an [=EPUB reading system=] or user, OCF is the
						required format for the container that holds all of the assets that make up the
						publication.</li>
				</ul>

				<p>This section defines the rules for structuring the file collection in the abstract: the "abstract
					container". It also defines the rules for the representation of this abstract container within a ZIP
					archive: the "physical container". The rules for ZIP physical containers build upon the ZIP
					technologies used by [[odf]].</p>

				<p>OCF also defines a standard method for <a href="#sec-font-obfuscation">obfuscating embedded fonts</a>
					for those EPUB publications that require this functionality.</p>
			</section>

			<section id="sec-container-abstract">
				<h3>OCF abstract container</h3>

				<section id="sec-container-abstract-intro" class="informative">
					<h4>Introduction</h4>

					<p>The [=OCF abstract container=] file system model uses a single common [=root directory=]. All
						[=container resources=] are located within the directory tree headed by the root directory, but
						no specific file system structure for them is mandated by this specification.</p>

					<p>The file system model also includes a mandatory directory named <code>META-INF</code> that is a
						direct child of the root directory and stores the following special files:</p>

					<dl class="variablelist">
						<dt>
							<code>container.xml</code>
							<code>[required]</code>
						</dt>
						<dd>
							<p>Identifies one or more [=package documents=] that define the [=EPUB publication=].</p>
						</dd>

						<dt>
							<code>signatures.xml</code>
							<code>[optional]</code>
						</dt>
						<dd>
							<p>Contains digital signatures for various assets.</p>
						</dd>

						<dt>
							<code>encryption.xml</code>
							<code>[optional]</code>
						</dt>
						<dd>
							<p>Contains information about the encryption of [=publication resources=]. This file is
								mandatory when [=EPUB creators=] use <a href="#sec-font-obfuscation">font
									obfuscation</a>.</p>
						</dd>

						<dt>
							<code>metadata.xml</code>
							<code>[optional]</code>
						</dt>
						<dd>
							<p>Used to store metadata about the [=OCF ZIP container=].</p>
						</dd>

						<dt>
							<code>rights.xml</code>
							<code>[optional]</code>
						</dt>
						<dd>
							<p>Used to store information about digital rights.</p>
						</dd>

						<dt>
							<code>manifest.xml</code>
							<code>[optional]</code>
						</dt>
						<dd>
							<p>A manifest of container contents as allowed by Open Document Format [[odf]].</p>
						</dd>
					</dl>

					<p>Refer to <a href="#sec-container-metainf"></a> for conformance requirements for the various files
						in the <code>META-INF</code> directory.</p>
				</section>

				<section id="sec-container-file-and-dir-structure">
					<h4>File and directory structure</h4>

					<p>The virtual file system for the [=OCF abstract container=] MUST have a single common [=root
						directory=] for all the contents of the container.</p>

					<p>The OCF abstract container MUST include a directory for configuration files named
							<code>META-INF</code> that is a direct child of the container's root directory. Refer to <a
							href="#sec-container-metainf"></a> for the requirements for the contents of this
						directory.</p>

					<p>The file name <code>mimetype</code> in the root directory is reserved for use by [=OCF ZIP
						containers=], as explained in <a href="#sec-container-zip"></a>.</p>

					<p>[=EPUB creators=] MAY locate all other files within the OCF abstract container in any location
						descendant from the root directory, provided they are not within the <code>META-INF</code>
						directory. EPUB creators MUST NOT reference files in the <code>META-INF</code> directory from an
						[=EPUB publication=].</p>

					<div class="note">
						<p>Some [=reading systems=] do not provide access to resources outside the directory where the
							[=package document=] is stored. EPUB creators should therefore place all resources at or
							below the directory containing the package document to avoid interoperability issues.</p>

						<p>This problem is more commonly encountered when <a data-cite="epub-multi-rend-11#container"
								>creating multiple renditions</a> [[epub-multi-rend-11]] of the publication.</p>
					</div>
				</section>

				<section id="sec-container-filenames">
					<h4>File paths and file names</h4>

					<p id="ocf-fn-cs">In the context of the [=OCF abstract container=], [=file paths=] and [=file
						names=] are [=scalar value strings=] [[infra]] (i.e., their values are case sensitive).</p>

					<p>In addition, the following restrictions are designed to allow file paths and file names to be
						used without modification on most operating systems:</p>

					<ul class="conformance-list">
						<li>
							<p id="ocf-fn-length">File names MUST NOT exceed 255 bytes.</p>
						</li>
						<li>
							<p id="ocf-pn-length">The file paths for any directory or file within the OCF abstract
								container MUST NOT exceed 65535 bytes.</p>
						</li>
						<li>
							<p id="ocf-fn-chars">File names MUST NOT use the following [[unicode]] characters, as
								commonly used operating systems may not support these characters consistently:</p>
							<ul>
								<li>
									<p>SOLIDUS: <code>/</code> (<code>U+002F</code>)</p>
								</li>
								<li>
									<p>QUOTATION MARK: <code>"</code> (<code>U+0022</code>)</p>
								</li>
								<li>
									<p>ASTERISK: <code>*</code> (<code>U+002A</code>)</p>
								</li>
								<li>
									<p>FULL STOP as the last character: <code>.</code> (<code>U+002E</code>)</p>
								</li>
								<li>
									<p>COLON: <code>:</code> (<code>U+003A</code>)</p>
								</li>
								<li>
									<p>LESS-THAN SIGN: <code>&lt;</code> (<code>U+003C</code>)</p>
								</li>
								<li>
									<p>GREATER-THAN SIGN: <code>></code> (<code>U+003E</code>)</p>
								</li>
								<li>
									<p>QUESTION MARK: <code>?</code> (<code>U+003F</code>)</p>
								</li>
								<li>
									<p>REVERSE SOLIDUS: <code>\</code> (<code>U+005C</code>)</p>
								</li>
								<li>
									<p>VERTICAL LINE: <code>|</code> (<code>U+007C</code>)</p>
								</li>
								<li>
									<p>DEL (<code>U+007F</code>)</p>
								</li>
								<li>
									<p>C0 range (<code>U+0000 … U+001F</code>)</p>
								</li>
								<li>
									<p>C1 range (<code>U+0080 … U+009F</code>)</p>
								</li>
								<li>
									<p>Private Use Area (<code>U+E000 … U+F8FF</code>)</p>
								</li>
								<li>
									<p>All Unicode Non Characters, specifically:</p>
									<ul>
										<li>
											<p>The 32 contiguous characters in the Basic Multilingual Plane
													(<code>U+FDD0 … U+FDEF</code>)</p>
										</li>
										<li>
											<p>The last two code points of the Basic Multilingual Plane
													(<code>U+FFFE</code> and <code>U+FFFF</code>)</p>
										</li>
										<li>
											<p>The last two code points at the end of the Supplementary Planes
													(<code>U+1FFFE, U+1FFFF … U+EFFFE, U+EFFFF</code>)</p>
										</li>
									</ul>
								</li>
								<li>
									<p>Specials (<code>U+FFF0 … U+FFFF</code>)</p>
								</li>
								<li>
									<p>Supplementary Private Use Area-A (<code>U+F0000 … U+FFFFF</code>)</p>
								</li>
								<li>
									<p>Supplementary Private Use Area-B (<code>U+100000 … U+10FFFF</code>)</p>
								</li>
							</ul>
							<div class="note">
								<p>The Unicode Character Database [[uax44]] also includes a <a
										href="https://www.unicode.org/Public/UCD/latest/ucd/PropList.txt">list of
										deprecated characters</a>. EPUB creators are advised to avoid these characters,
									as well, as it is expected that [=EPUB conformance checkers=] will flag their
									use.</p>
							</div>
						</li>
						<li>
							<p id="ocf-fn-space">For compatibility with older [=reading systems=], file names SHOULD NOT
								contain SPACE (U+0020) characters.</p>
						</li>
						<li>
							<p id="ocf-fn-cn">All file names within the same directory MUST be unique following Unicode
								canonical normalization [[uax15]] and then full case folding [[unicode]]. (Refer to <a
									data-cite="charmod-norm#CanonicalFoldNormalizationStep">Unicode Canonical Case Fold
									Normalization Step</a> [[?charmod-norm]] for more information.)</p>
						</li>
					</ul>
					<div class="note">
						<p>If [=EPUB creators=] dynamically integrate resources (i.e., where the naming is beyond their
							control), they should be aware that automatic truncation of file names to keep them within
							the 255 bytes limit can lead to corruption. This is due to the difference between bytes and
							characters in multibyte encodings such as UTF-8; it is, therefore, important to avoid
							mid-character truncation. See the section on <a
								data-cite="international-specs/#char_truncation">"Truncating or limiting the length of
								strings"</a> in [[international-specs]] for more information.</p>
					</div>

					<div class="note">
						<p>EPUB creators should use an abundance of caution in their file naming when interoperability
							of content is key. The <a href="#ocf-fn-chars">list of restricted characters</a> is intended
							to help avoid some known problem areas, but it does not ensure that all other Unicode
							characters are supported. Although Unicode support is much better now than in earlier
							iterations of EPUB, older tools and toolchains may still be encountered (e.g., ZIP tools
							that only support [[us-ascii]]).</p>
					</div>
				</section>

				<section id="sec-file-names-to-path-names">
					<h4>Deriving file paths</h4>

					<p>To <strong>derive the file path</strong>, given a file or directory <var>file</var> in the <a
							href="#sec-container-abstract">OCF abstract container</a>, apply the following steps
						(expressed using the terminology of [[infra]]):</p>

					<ol class="algorithm">
						<li>Let <var>path</var> be an empty [=list=].</li>
						<li>Let <var>current</var> be <var>file</var>.</li>
						<li>While <var>current</var> is not the [=root directory=]: <ol>
								<li> [=list/prepend=] the [=file name=] of <var>current</var> to <var>path</var>;</li>
								<li>set <var>current</var> to the parent directory of <var>current</var>.</li>
							</ol>
						</li>
						<li>Return the <a data-cite="infra#string-concatenate">concatenation</a> of <var>path</var>
							using the <code>U+002F (/)</code> character.</li>
					</ol>
				</section>

				<section id="sec-container-iri">
					<h4>URLs in the OCF abstract container</h4>

					<p id="sec-container-iri-root"
						data-tests="#ocf-url_manifest,#ocf-url_relative,#ocf-url_link-relative">The [=container root
						URL=] is the [=URL=] [[url]] of the [=root directory=]. It is implementation-specific, but
						[=EPUB creators=] MUST assume it has the following properties:</p>

					<ul id="sec-root-url-properties">
						<li id="sec-container-iri-root-parse"
							data-tests="#ocf-url_link-path-absolute,#ocf-url_parse-path-absolute">The result of <a
								data-lt="url parser">parsing</a> "<code>/</code>" with the [=container root URL=] as <a
								data-cite="url#concept-base-url"><var>base</var></a> is the [=container root URL=].</li>
						<li id="sec-container-iri-step-parse"
							data-tests="#ocf-url_link-leaking-relative,#ocf-url_parse-leaking-relative">The result of <a
								data-lt="url parser">parsing</a> "<code>..</code>" with the [=container root URL=] as <a
								data-cite="url#concept-base-url"><var>base</var></a> is the [=container root URL=].</li>
					</ul>

					<p>The [=content URL=] of a file or directory in the [=OCF abstract container=] is the result of
						[=url parser | parsing=] the file's [=file path=] with the container root URL as <a
							data-cite="url#concept-base-url"><var>base</var></a>.</p>

					<div class="note" id="note-cru-explanation">
						<p>The container root URL is the URL assigned by the [=reading system=] to the root of the
							[=EPUB container=]. It typically depends on how the reading system internally implements the
							container file system.</p>

						<p>However, a reading system cannot arbitrarily use any URL, but one that honors the constraints
							defined above. These constraints ensure that any relative URL string found in the EPUB will
							always be parsed to a URL of a resource within the container (which may or may not exist).
							The primary reason for these constraints is to avoid potential run-time security issues that
							would be caused by parsed URLs "leaking" outside the container files.</p>

						<p>For example, URLs like <code>https://localhost:12345/</code> or
								<code>https://www.example.org:12345/</code> honor these properties. But URLs like
								<code>https://localhost:12345/path/to.epub/</code>,
								<code>file:///path/to.epub#path=/</code>, or <code>jar:file:/path/to.epub!/EPUB/</code>
							do not (parsing the URL string "<code>..</code>" with these three examples as base would
							return <code>https://localhost:12345/path/</code>, <code>file:///path/</code>, and a parsing
							error, respectively). It is the responsibility of the reading system to assign a URL to the
							root directory that complies with the properties defined above.</p>
					</div>

					<div class="note">
						<p>Parsing may replace some characters in the file path by their <a
								data-cite="url#percent-encode">percent encoded</a> alternative. For example,
								<code>A/B/C/file&#160;name.xhtml</code> becomes <code>A/B/C/file%20name.xhtml</code>.
						</p>
					</div>

					<p>A string <var>url</var> is a <dfn class="export"
							id="dfn-valid-relative-container-url-with-fragment-string"
							>valid-relative-ocf-URL-with-fragment string</dfn> if it is a
						[=path-relative-scheme-less-url string=], optionally followed by <code>U+0023 (#)</code> and a
						[=url-fragment string=], and if the following steps return <var>true</var>:</p>

					<ol class="algorithm" id="algo-out-of-container">
						<li>
							<p>Set the [=container root URL=] to <code>https://a.example.org/A/</code>.</p>
							<details class="explanation">
								<summary>Explanation</summary>
								<p>The goal of the algorithm is to detect whether <var>url</var> could be seen as
									"leaking" outside the container. To do that, the standard [=url parser | URL parsing
									algorithm=] is used with an artificial root URL; the detection of the "leak" is done
									by comparing the result of the parsing with the presence of the first test path
									segment (<code>A</code>). (Note that the artificial container root URL wilfully
									violates, for the purpose of this algorithm, the <a href="#sec-root-url-properties"
										>required properties</a> by using that first test path segment.)</p>
							</details>
						</li>

						<li>
							<p>Let <var>base</var> be the <a data-cite="url#concept-base-url">base URL</a> that must be
								used to parse <var>url</var> as defined by the context (document or environment) where
									<var>url</var> is used, and according to the content URL of the [=package document=]
								(see <a href="#sec-parse-package-urls"></a>).</p>
							<details class="explanation">
								<summary>Explanation</summary>
								<p>In the case of a URL in the package document the <var>base</var> variable is set to
									the content URL of the package document. In the case of a document within the
										<code>META-INF</code> directory, the <var>base</var> variable is set to the
									container root URL (see <a href="#sec-parsing-urls-metainf"></a>). In the case of a
									URL in an [=XHTML content document=], the base URL used for parsing is defined by
									the <a data-cite="html#resolving-urls">HTML standard</a>. Typically, it will be the
									content URL of the content document (unless the <a href="#sec-xhtml-deviations-base"
										>discouraged</a>
									<code>base</code> element is used).</p>
							</details>
						</li>

						<li>Let <var>testURLRecord</var> be the result of applying the [=URL parser=] to <var>url</var>,
							with <var>base</var>.</li>

						<li>Let <var>testURLStringA</var> be the result of applying the [=URL Serializer=] to
								<var>testURLRecord</var>. </li>

						<li>
							<p>Set the [=container root URL=] to <code>https://b.example.org/B/</code>.</p>
							<details class="explanation">
								<summary>Explanation</summary>
								<p>The reasons to repeat the same steps twice with different, and artificial, settings
									of the container root URL is to avoid collision which may occur if the
										<var>url</var> string also includes <code>/A/</code>. Consider, for example, the
									case where <var>url</var> is <code>../../A/doc.xhtml</code>.</p>
							</details>
						</li>

						<li>Set <var>base</var> to be the <a data-cite="url#concept-base-url">base URL</a> that must be
							used to parse <var>url</var> as defined by the context (document or environment) where
								<var>url</var> is used, and according to the content URL of the package document (see <a
								href="#sec-parse-package-urls"></a>).</li>

						<li>Set <var>testURLRecord</var> to be the result of applying the [=URL parser=] to
								<var>url</var>, with <var>base</var>. </li>

						<li>Let <var>testURLStringB</var> be the result of applying the [=URL Serializer=] to
								<var>testURLRecord</var>.</li>

						<li>
							<p>If <var>testURLStringA</var> does not start with <code>https://a.example.org/</code> or
									<var>testURLStringB</var> does not start with <code>https://b.example.org/</code>,
								return <var>true</var>.</p>
							<details class="explanation">
								<summary>Explanation</summary>
								<p>If any of the result does not share the test URL host, it means that <var>url</var>,
									or its base URL (for example, in HTML, if it is explicitly set with the
										<code>base</code> element), was <em>absolute</em> and points outside the
									container. This is acceptable.</p>
							</details>
						</li>

						<li>
							<p>If <var>testURLStringA</var> starts with <code>https://a.example.org/A/</code> and
									<var>testURLStringB</var> starts with <code>https://b.example.org/B/</code>, return
									<var>true</var>.</p>
							<details class="explanation">
								<summary>Explanation</summary>
								<p>The presence of the first test path segments (<code>A</code>, respectively
										<code>B</code>) indicate that the URL doesn't leak outside the container.</p>
							</details>
						</li>

						<li>Return <var>false</var>.</li>
					</ol>

					<p id="urls-in-ocf-constraints">In the OCF abstract container, any URL string MUST be an
						[=absolute-url-with-fragment string=] or a [=valid-relative-ocf-URL-with-fragment string=].</p>

					<p>In addition, all [=relative-URL-with-fragment strings=] [[url]] MUST, after <a
							data-lt="url parser">parsing</a>, be equal to the content URL of an existing file in the OCF
						abstract container.</p>

					<div class="note">
						<p>These constraints on URL strings mean that:</p>

						<ul>
							<li>relative URL strings starting with a <code>/</code> (<code>U+002F</code>) (for example,
									<code>/EPUB/content.xhtml</code>) are disallowed; </li>
							<li>relative URL strings containing more [=double-dot path segments=] than needed to reach
								the target file (for example, <code>EPUB/../../../../config.xml</code>) are disallowed; </li>
							<li>any other absolute or relative URL string is allowed.</li>
						</ul>

						<p>Note that in any case, even the disallowed URL strings described above will not "leak"
							outside the container after parsing (as explained in the <a href="#note-cru-explanation"
								>first note</a> of this section). They are nevertheless disallowed for better
							interoperability with non-conforming or legacy reading systems and toolchains.</p>
					</div>

					<aside class="example" title="Referencing a file in the same directory">
						<p>In this example, the file <code>image1.jpg</code> is in the same directory as the XHTML
							content document.</p>

						<pre>&lt;html …>
   …
   &lt;body>
      &lt;img
          src="image1.jpg"
          alt="…" />
   …
   &lt;/body>
&lt;/html></pre>
					</aside>

					<aside class="example" title='An "out-of-container" URL'>
						<p>Given the following container structure:</p>

						<pre>
							/
							├── mimetype
							├── META-INF
							│   └── container.xml
							└── EPUB
							    └── content.xhtml
						</pre>

						<p> A URL `../../../../EPUB/secret.xhtml` appearing in `content.xhtml` would be parsed by a
							reading system into a content URL with a path `EPUB/secret.xhtml`, following the constraints
							on the container root URL. However, as the URL could be perceived as one of a resource
							outside the container, and create interoperability issues; it would be reported as an error
							by a checker tool. </p>
					</aside>
				</section>

				<section id="sec-container-metainf">
					<h4><code>META-INF</code> directory</h4>

					<section id="sec-container-metainf-inc">
						<h5>Inclusion in OCF abstract container</h5>

						<p>All [=OCF abstract containers=] MUST include a directory called <code>META-INF</code> in
							their [=root directory=].</p>

						<p>This directory is reserved for configuration files, specifically those defined in <a
								href="#sec-container-metainf-files"></a>.</p>
					</section>

					<section id="sec-parsing-urls-metainf">
						<h5>Parsing URLs in the <code>META-INF</code> directory</h5>

						<p id="sec-container-metainf-url-parsing" data-tests="#ocf-url_relative">To parse a URL string
								<var>url</var> used in files located in the <code>META-INF</code> directory the <a
								data-lt="url parser">URL parser</a> MUST be applied to <var>url</var>, with the
							[=container root URL=] as <a data-cite="url#concept-base-url"><var>base</var></a>.</p>

						<aside class="example" title="Resolving paths in the container file">
							<p>If container file (<code>META-INF/container.xml</code>) has the following content:</p>

							<pre>&lt;?xml version="1.0"?>
&lt;container version="1.0" xmlns="urn:oasis:names:tc:opendocument:xmlns:container">
   &lt;rootfiles>
      &lt;rootfile
          full-path="EPUB/Great_Expectations.opf"
          media-type="application/oebps-package+xml" />	
   &lt;/rootfiles>
&lt;/container></pre>

							<p>then the path <code>EPUB/Great_Expectations.opf</code> is relative to the [=root
								directory=] for the [=OCF abstract container=] and not relative to the
									<code>META-INF</code> directory.</p>
						</aside>
					</section>

					<section id="sec-container-metainf-files">
						<h5>Reserved files</h5>

						<section id="sec-container-metainf-container.xml">
							<h6>Container file (<code>container.xml</code>)</h6>

							<p>The REQUIRED <code>container.xml</code> file in the <code>META-INF</code> directory
								identifies the [=package documents=] available in the [=OCF abstract container=].</p>

							<p>All [[xml]] elements defined in this section are in the
									<code>urn:oasis:names:tc:opendocument:xmlns:container</code> namespace [[xml-names]]
								unless specified otherwise.</p>

							<p>The contents of this file MUST be valid to the definition in this section after removing
								all elements and attributes from other namespaces (including all attributes and contents
								of such elements).</p>

							<p class="note">An <a href="#app-schema-container">XML Schema</a> also informally defines
								the content of this file.</p>

							<section id="sec-container.xml-container-elem">
								<h6>The <code>container</code> element</h6>

								<p>The <code>container</code> element encapsulates all the information in the
										<code>container.xml</code> file.</p>

								<dl id="elemdef-container" class="elemdef">
									<dt>Element Name:</dt>
									<dd>
										<p>
											<dfn class="export" data-lt-no-plural="" data-dfn-type="element"
													><code>container</code></dfn>
										</p>
									</dd>

									<dt>Usage:</dt>
									<dd>
										<p>REQUIRED <a data-cite="xml#dt-root">root element</a> [[xml]] of the
												<code>container.xml</code> file.</p>
									</dd>

									<dt>Attributes:</dt>
									<dd>
										<dl>
											<dt>
												<code>version</code>
												<code>[required]</code>
											</dt>
											<dd id="attrdef-container-version">This attribute MUST have the value
													"<code>1.0</code>".</dd>
										</dl>
									</dd>

									<dt>Content Model:</dt>
									<dd>
										<p>In this order:</p>
										<ul class="nomark">
											<li>[^rootfiles^] [exactly one]</li>
											<li>[^links^] [0 or 1]</li>
										</ul>
									</dd>
								</dl>
							</section>

							<section id="sec-container.xml-rootfiles-elem">
								<h6>The <code>rootfiles</code> element</h6>

								<p>The <code>rootfiles</code> element contains a list of [=package documents=] available
									in the [=EPUB container=].</p>

								<dl id="elemdef-rootfiles" class="elemdef">
									<dt>Element Name:</dt>
									<dd>
										<p>
											<dfn class="export" data-lt-no-plural="" data-dfn-type="element"
													><code>rootfiles</code></dfn>
										</p>
									</dd>

									<dt>Usage:</dt>
									<dd>
										<p>REQUIRED first child of [^container^].</p>
									</dd>

									<dt>Attributes:</dt>
									<dd>
										<p>None</p>
									</dd>

									<dt>Content Model:</dt>
									<dd>
										<ul class="nomark">
											<li>[^rootfile^] [1 or more]</li>
										</ul>
									</dd>
								</dl>
							</section>

							<section id="sec-container.xml-rootfile-elem">
								<h6>The <code>rootfile</code> element</h6>

								<p>Each <code>rootfile</code> element identifies the location of one [=package
									document=] in the [=EPUB container=].</p>

								<dl id="elemdef-rootfile" class="elemdef">
									<dt>Element Name:</dt>
									<dd>
										<p>
											<dfn class="export" data-lt-no-plural="" data-dfn-type="element"
													><code>rootfile</code></dfn>
										</p>
									</dd>

									<dt>Usage:</dt>
									<dd>
										<p>As child of the [^rootfiles^] element. Repeatable.</p>
									</dd>

									<dt>Attributes:</dt>
									<dd>
										<dl>
											<dt>
												<code>full-path</code>
												<code>[required]</code>
											</dt>
											<dd>
												<p>Identifies the location of a package document.</p>
												<p>The value of the attribute MUST be a [=path-relative-scheme-less-URL
													string=] [[url]]. The path is relative to the [=root
													directory=].</p>
											</dd>

											<dt>
												<code>media-type</code>
												<code>[required]</code>
											</dt>
											<dd>
												<p>Identifies the media type of the package document.</p>
												<p>The value of the attribute MUST be
														"<code>application/oebps-package+xml</code>".</p>
											</dd>
										</dl>
									</dd>

									<dt>Content Model:</dt>
									<dd>
										<p>Empty</p>
									</dd>
								</dl>

								<p>If an [=EPUB creator=] defines more than one <code>rootfile</code> element, each MUST
									reference a package document that conforms to the same version of EPUB. Each package
									document represents one rendering of the [=EPUB publication=].</p>

								<div class="note">
									<p>Although the EPUB container provides the ability to reference more than one
										package document, this specification does not define how to interpret, or select
										from, the available options. Refer to [[epub-multi-rend-11]] for more
										information on how to bundle more than one rendering of the content.</p>
								</div>
							</section>

							<section id="sec-container.xml-links-elem">
								<h6>The <code>links</code> element</h6>

								<p>The <code id="elemdef-container-links">links</code> element identifies resources
									necessary for the processing of the [=OCF ZIP container=].</p>

								<dl id="elemdef-links" class="elemdef">
									<dt>Element Name:</dt>
									<dd>
										<p>
											<dfn class="export" data-lt-no-plural="" data-dfn-type="element"
													><code>links</code></dfn>
										</p>
									</dd>

									<dt>Usage:</dt>
									<dd>
										<p>OPTIONAL second child of [^container^]. Repeatable.</p>
									</dd>

									<dt>Attributes:</dt>
									<dd>
										<p>None</p>
									</dd>

									<dt>Content Model:</dt>
									<dd>
										<ul class="nomark">
											<li><a href="#elemdef-link"><code>link</code></a> [1 or more]</li>
										</ul>
									</dd>
								</dl>

								<div class="note">
									<p>This specification currently does not define uses for the <code>links</code>
										element. Refer to [[epub-multi-rend-11]] for an example of its use.</p>
								</div>
							</section>

							<section id="sec-container.xml-link-elem">
								<h6>The <code>link</code> element</h6>

								<dl id="elemdef-link" class="elemdef">
									<dt>Element Name:</dt>
									<dd>
										<p>
											<code>link</code>
										</p>
									</dd>

									<dt>Usage:</dt>
									<dd>
										<p>As child of the [^links^] element. Repeatable.</p>
									</dd>

									<dt>Attributes:</dt>
									<dd>
										<dl>
											<dt>
												<code>href</code>
												<code>[required]</code>
											</dt>
											<dd>
												<p>Identifies the location of a resource.</p>
												<p>The value of the <code>link</code> element <code>href</code>
													attribute MUST be a [=path-relative-scheme-less-URL string=]
													[[url]]. The path is relative to the [=root directory=].</p>
											</dd>

											<dt>
												<code>media-type</code>
												<code>[optional]</code>
											</dt>
											<dd>
												<p>Identifies the type and format of the referenced resource.</p>
												<p>The value of the attribute MUST be a media type [[rfc2046]].</p>
											</dd>

											<dt>
												<code>rel</code>
												<code>[required]</code>
											</dt>
											<dd>
												<p>Identifies the relationship of the resource.</p>
												<p>The value of the attribute MUST be a space-separated list of
													tokens.</p>
											</dd>
										</dl>
									</dd>

									<dt>Content Model:</dt>
									<dd>
										<p>Empty</p>
									</dd>
								</dl>
							</section>

							<section id="sec-container-container.xml-example" class="informative">
								<h6>Examples</h6>

								<aside class="example" title="A basic container file">
									<pre>&lt;?xml version="1.0"?>
&lt;container version="1.0" xmlns="urn:oasis:names:tc:opendocument:xmlns:container">
   &lt;rootfiles>
      &lt;rootfile
          full-path="EPUB/My_Crazy_Life.opf"
          media-type="application/oebps-package+xml" />
   &lt;/rootfiles>
&lt;/container></pre>
								</aside>
							</section>
						</section>

						<section id="sec-container-metainf-encryption.xml">
							<h6>Encryption file (<code>encryption.xml</code>)</h6>

							<p>The OPTIONAL <code>encryption.xml</code> file in the <code>META-INF</code> directory
								holds all encryption information on the contents of the container. If an [=EPUB
								creator=] encrypts any resources within the container, they MUST include an
									<code>encryption.xml</code> file to provide information about the encryption
								used.</p>

							<section id="sec-encryption.xml-encryption">
								<h6>The <code>encryption</code> element</h6>

								<dl class="elemdef" id="elemdef-encryption">
									<dt>Element Name:</dt>
									<dd>
										<p>
											<dfn class="export" data-lt-no-plural="" data-dfn-type="element"
													><code>encryption</code></dfn>
										</p>
									</dd>

									<dt>Namespace:</dt>
									<dd>
										<p><code>urn:oasis:names:tc:opendocument:xmlns:container</code></p>
									</dd>

									<dt>Usage:</dt>
									<dd>
										<p>REQUIRED <a data-cite="xml#dt-root">root element</a> [[xml]] of the
												<code>encryption.xml</code> file.</p>
									</dd>

									<dt>Attributes:</dt>
									<dd>
										<p>None</p>
									</dd>

									<dt>Content Model:</dt>
									<dd>
										<p>In any order:</p>
										<ul class="nomark">
											<li><code>EncryptedKey</code> [1 or more]</li>
											<li><code>EncryptedData</code> [1 or more]</li>
										</ul>
									</dd>
								</dl>

								<p>The <code>encryption</code> element contains child elements of type
										<code>EncryptedKey</code> and <code>EncryptedData</code> as defined by
									[[xmlenc-core1]].</p>

								<p>An <dfn class="export" data-lt-no-plural="" data-dfn-type="element"
											><code>EncryptedKey</code></dfn> element describes each encryption key used
									in the container, while an <dfn class="export" data-lt-no-plural=""
										data-dfn-type="element"><code>EncryptedData</code></dfn> element describes each
									encrypted file. Each <code>EncryptedData</code> element refers to an
										<code>EncryptedKey</code> element, as described in XML Encryption.</p>

								<p class="note">An <a href="#app-schema-encryption">XML Schema</a> also informally
									defines the content of the <code>encryption.xml</code> file.</p>

								<p>OCF encrypts individual files independently, trading off some security for improved
									performance, allowing the container contents to be incrementally decrypted.
									Encryption in this way exposes the directory structure and file naming of the whole
									package.</p>

								<p>OCF uses XML Encryption [[xmlenc-core1]] to provide a framework for encryption,
									allowing a variety of algorithms to be used. XML Encryption specifies a process for
									encrypting arbitrary data and representing the result in XML. Even though an [=OCF
									abstract container=] may contain non-XML data, [=EPUB creators=] can use XML
									Encryption to encrypt all data in an [=OCF abstract container=]. OCF encryption
									supports only the encryption of entire files within the container, not parts of
									files. EPUB creators MUST NOT encrypt the <code>encryption.xml</code> file when
									present.</p>

								<p>Encrypted data replaces unencrypted data in an OCF abstract container. For example,
									if an EPUB creator encrypts an image named <code>photo.jpeg</code>, they should
									replace the contents of the <code>photo.jpeg</code> resource with its encrypted
									contents. Within the ZIP directory, EPUB creators SHOULD store encrypted files
									rather than Deflate-compress them.</p>

								<p id="encryption-obfuscation">Note that some situations require obfuscating the storage
									of embedded fonts referenced by an [=EPUB publication=] to make them more difficult
									to extract for unrestricted use. Although obfuscation is not encryption, reading
									systems use the <code>encryption.xml</code> file in conjunction with the <a
										href="#sec-font-obfuscation">font obfuscation algorithm</a> to identify fonts to
									deobfuscate.</p>

								<p id="encryption-restrictions">EPUB creators MUST NOT encrypt the following files:</p>

								<ul class="nomark">
									<li>
										<code>mimetype</code>
									</li>
									<li>
										<code>META-INF/container.xml</code>
									</li>
									<li>
										<code>META-INF/encryption.xml</code>
									</li>
									<li>
										<code>META-INF/manifest.xml</code>
									</li>
									<li>
										<code>META-INF/metadata.xml</code>
									</li>
									<li>
										<code>META-INF/rights.xml</code>
									</li>
									<li>
										<code>META-INF/signatures.xml</code>
									</li>
									<li> [= <code>package document</code> =] </li>
								</ul>

								<p>EPUB creators MAY subsequently encrypt signed resources using the Decryption
									Transform for XML Signature [[xmlenc-decrypt]]. This feature enables a [=reading
									system=] to distinguish data encrypted before signing from data encrypted after
									signing.</p>

								<aside class="example" title="An encrypted image">
									<p>In this example, adapted from <a data-cite="xmlenc-core1#sec-eg-Symmetric-Key"
											>Section 2.2.1 </a> of [[xmlenc-core1]], the resource
											<code>image.jpeg</code> is encrypted using a symmetric key algorithm (AES)
										and the symmetric key is further encrypted using an asymmetric key algorithm
										(RSA) with a key of "John Smith".</p>

									<pre>&lt;encryption
    xmlns ="urn:oasis:names:tc:opendocument:xmlns:container"
    xmlns:enc="http://www.w3.org/2001/04/xmlenc#"
    xmlns:ds="http://www.w3.org/2000/09/xmldsig#">
   &lt;enc:EncryptedKey Id="EK">
      &lt;enc:EncryptionMethod
          Algorithm="http://www.w3.org/2001/04/xmlenc#rsa-1_5"/>
      &lt;ds:KeyInfo>
         &lt;ds:KeyName>
            John Smith
         &lt;/ds:KeyName>
      &lt;/ds:KeyInfo>
      &lt;enc:CipherData>
         &lt;enc:CipherValue>
            xyzabc
         &lt;/enc:CipherValue>
      &lt;/enc:CipherData>
   &lt;/enc:EncryptedKey>
   &lt;enc:EncryptedData Id="ED1">
      &lt;enc:EncryptionMethod
          Algorithm="http://www.w3.org/2001/04/xmlenc#kw-aes128"/>
      &lt;ds:KeyInfo>
         &lt;ds:RetrievalMethod
             URI="#EK"
             Type="http://www.w3.org/2001/04/xmlenc#EncryptedKey"/>
      &lt;/ds:KeyInfo>
      &lt;enc:CipherData>
         &lt;enc:CipherReference
             URI="image.jpeg"/>
      &lt;/enc:CipherData>
   &lt;/enc:EncryptedData>
&lt;/encryption></pre>
								</aside>
							</section>

							<section id="sec-enc-compression">
								<h6>Order of compression and encryption</h6>

								<p>When stored in an [=OCF ZIP container=], [=EPUB creators=] SHOULD compress streams of
									data with [=non-codec=] content types before encrypting them. EPUB creators MUST use
									Deflate compression. This practice ensures that file entries stored in the ZIP
									container have a smaller size.</p>

								<p>EPUB creators SHOULD NOT compress streams of data with [=codec=] content types before
									encrypting them. In such cases, additional compression introduces unnecessary
									processing overhead at production time (especially with large resource files) and
									impacts audio/video playback performance at consumption time. In some cases, the
									combination of compression with some encryption schemes might even compromise the
									ability of [=reading systems=] to handle partial content requests (e.g. HTTP byte
									ranges), due to the technical impossibility to determine the length of the full
									resource ahead of media playback (e.g. HTTP Content-Length header).</p>

								<p>When EPUB creators compress streams of data before encrypting, they SHOULD provide
									additional <code>EncryptionProperties</code> metadata to specify the size of the
									initial resource (i.e., before compression and encryption), as per the
										<code>Compression</code> XML element defined below. When EPUB creators do not
									compress streams of data before encrypting, they MAY provide the additional
										<code>EncryptionProperties</code> metadata to specify the size of the initial
									resource (i.e., before encryption).</p>

								<dl class="elemdef" id="elemdef-enc-Compression">
									<dt>Element Name:</dt>
									<dd>
										<p>
											<dfn class="export" data-lt-no-plural="" data-dfn-type="element"
													><code>Compression</code></dfn>
										</p>
									</dd>

									<dt>Namespace:</dt>
									<dd>
										<p>
											<code>http://www.idpf.org/2016/encryption#compression</code>
										</p>
									</dd>

									<dt>Usage:</dt>
									<dd>
										<p>OPTIONAL child of <code>EncryptionProperty</code>.</p>
									</dd>

									<dt>Attributes:</dt>
									<dd>
										<dl class="variablelist">
											<dt>Method <code>[required]</code></dt>
											<dd>
												<p>Identifies the compression method used.</p>
												<p>Value is either "<code>0</code>" (no compression) or "<code>8</code>"
													(Deflate algorithm).</p>
											</dd>

											<dt>OriginalLength <code>[required]</code></dt>
											<dd>
												<p>Represents the size of the initial resource (number of bytes).</p>
												<p>Value is a positive integer.</p>
											</dd>
										</dl>
									</dd>

									<dt>Content Model:</dt>
									<dd>
										<p>Empty</p>
									</dd>
								</dl>

								<aside class="example" title="A compressed video">
									<p>In this example, the EPUB creator has Deflate compressed the MP4 file. Its
										original size was 3500000 bytes.</p>

									<pre>&lt;encryption
    xmlns="urn:oasis:names:tc:opendocument:xmlns:container">
   &lt;enc:EncryptedData 
       xmlns:enc="http://www.w3.org/2001/04/xmlenc#">
      …
      &lt;enc:CipherData>
         &lt;enc:CipherReference
             URI="OEPBS/video.mp4"/>
      &lt;/enc:CipherData>
      &lt;enc:EncryptionProperties>
         &lt;enc:EncryptionProperty
             xmlns:ns="http://www.idpf.org/2016/encryption#compression">
            &lt;ns:Compression
                Method="8"
                OriginalLength="3500000"/>
         &lt;/enc:EncryptionProperty>
      &lt;/enc:EncryptionProperties>
      …
   &lt;/enc:EncryptedData>
&lt;/encryption></pre>
								</aside>
							</section>
						</section>

						<section id="sec-container-metainf-manifest.xml">
							<h6>Manifest file (<code>manifest.xml</code>)</h6>

							<p>The OPTIONAL <code>manifest.xml</code> file in the <code>META-INF</code> directory
								provides a manifest of files in the container.</p>

							<p>The OCF specification does not mandate a format for the manifest.</p>

							<p>Note that [=package documents=] specify the only manifests used for processing [=EPUB
								publications=]. Reading systems do not use this file.</p>

							<div class="note">This feature exists only for compatibility with [[odf]].</div>
						</section>

						<section id="sec-container-metainf-metadata.xml">
							<h6>Metadata file (<code>metadata.xml</code>)</h6>

							<p>The OPTIONAL <code>metadata.xml</code> file in the <code>META-INF</code> directory is
								only for container-level metadata.</p>

							<p>If [=EPUB creators=] include a <code>metadata.xml</code> file, they SHOULD use only
								namespace-qualified elements [[xml-names]] in it. The file SHOULD contain the <a
									data-cite="xml#dt-root">root element</a> [[xml]] <code>metadata</code> in the
								namespace <code>http://www.idpf.org/2013/metadata</code>, but this specification allows
								other root elements for backwards compatibility.</p>

							<p>This version of the specification does not define metadata for use in the
									<code>metadata.xml</code> file. Future versions of this specification MAY define
								container-level metadata.</p>
						</section>

						<section id="sec-container-metainf-rights.xml">
							<h6>Rights management file (<code>rights.xml</code>)</h6>

							<p>This specification reserves the OPTIONAL <code>rights.xml</code> file in the
									<code>META-INF</code> directory for the trusted exchange of [=EPUB publications=]
								among rights holders, intermediaries, and users.</p>

							<p>When [=EPUB creators=] do not include a <code>rights.xml</code> file, no part of the
								[=OCF abstract container=] is rights governed at the container level. Rights expressions
								might exist within the EPUB publications.</p>
						</section>

						<section id="sec-container-metainf-signatures.xml">
							<h6>Digital signatures file (<code>signatures.xml</code>)</h6>

							<div class="note">
								<p>Adding a digital signature is not a guarantee that a malicious actor cannot tamper
									with an [=EPUB publication=] as [=reading systems=] do not have to check
									signatures.</p>
							</div>

							<p>The OPTIONAL <code>signatures.xml</code> file in the <code>META-INF</code> directory
								holds digital signatures for the container and its contents.</p>

							<section id="sec-signatures.xml-signatures">
								<h6>The <code>signatures</code> element</h6>

								<dl class="elemdef" id="elemdef-signatures">
									<dt>Element Name:</dt>
									<dd>
										<p>
											<dfn class="export" data-lt-no-plural="" data-dfn-type="element"
													><code>signatures</code></dfn>
										</p>
									</dd>

									<dt>Namespace:</dt>
									<dd>
										<p><code>urn:oasis:names:tc:opendocument:xmlns:container</code></p>
									</dd>

									<dt>Usage:</dt>
									<dd>
										<p>REQUIRED <a data-cite="xml#dt-root">root element</a> [[xml]] of the
												<code>signature.xml</code> file.</p>
									</dd>

									<dt>Attributes:</dt>
									<dd>
										<p>None</p>
									</dd>

									<dt>Content Model:</dt>
									<dd>
										<ul class="nomark">
											<li><code>Signature</code> [1 or more]</li>
										</ul>
									</dd>
								</dl>

								<p>The <code>signature</code> element contains child elements of type
										<code>Signature</code>, as defined by [[xmldsig-core1]]. [=EPUB creators=] can
									apply signatures to an EPUB publication as a whole or to its parts, and can specify
									the signing of any kind of data (i.e., not just XML).</p>

								<p class="note">An <a href="#app-schema-signatures">XML Schema</a> also informally
									defines the content of the <code>signatures.xml</code> file.</p>

								<p>When an EPUB creator does not include a <code>signatures.xml</code> file, they are
									not signing any part of the [=OCF abstract container=] at the container level.
									Digital signing might exist within the EPUB publication.</p>

								<p id="sig-container">When an EPUB creator creates a data signature for the OCF abstact
									container, they SHOULD add the signature as the last child <code>Signature</code>
									element of the <code>signatures</code> element.</p>

								<div class="note">
									<p>Each <code>Signature</code> in the <code>signatures.xml</code> file identifies by
										URL [[url]] the data to which the signature applies, using the [[xmldsig-core1]]
											<code>Manifest</code> element and its <code>Reference</code> sub-elements.
										EPUB creator may sign individual container files separately or together.
										Separately signing each file creates a digest value for the resource that
										reading systems can validate independently. This approach might make a Signature
										element larger. If EPUB creators sign files together, they can list the set of
										signed files in a single XML Signature <code>Manifest</code> element and
										reference them by one or more <code>Signature</code> elements.</p>
								</div>

								<p id="sig-restrictions">EPUB creators can sign any or all files in the OCF abstract
									container in their entirety, except for the <code>signatures.xml</code> file since
									that file will contain the computed signature information. Whether and how EPUB
									creators sign the <code>signatures.xml</code> file depends on their objective.</p>

								<p>If the EPUB creator wants to allow signatures to be added or removed from the OCF
									abstract container without invalidating their signature, they SHOULD NOT sign the
										<code>signatures.xml</code> file.</p>

								<p>If the EPUB creator wants any addition or removal of a signature to invalidate their
									signature, they can use the Enveloped Signature transform defined in <a
										data-cite="xmldsig-core#sec-EnvelopedSignature">Section 6.6.4</a> of
									[[xmldsig-core1]] to sign the entire pre-existing signature file excluding the
										<code>Signature</code> being created. This transform would sign all previous
									signatures, and it would become invalid if a subsequent signature were added to the
									package.</p>

								<div class="note">
									<p>If the EPUB creator wants the removal of an existing signature to invalidate
										their signature, but also wants to allow the addition of signatures, they could
										use an XPath transform to sign just the existing signatures. The details of such
										a transform are outside the scope of this specification, however.</p>
								</div>

								<p>The [[xmldsig-core1]] specification does not associate any semantics with a
									signature; an agent might include semantic information, for example, by adding
									information to the Signature element that describes the signature. The
									[[xmldsig-core1]] specification describes how additional information can be added to
									a signature, such as by use the <code>SignatureProperties</code> element.</p>

								<aside class="example" title="Signing resources">
									<p>In this example, based on the examples found in <a
											data-cite="xmldsig-core1#sec-Overview">Section 2</a> of [[xmldsig-core1]],
										one signature applies to two resources (<code>EPUB/book.xhtml</code> and
											<code>EPUB/images/cover.jpeg</code>).</p>

									<pre>&lt;signatures
    xmlns="urn:oasis:names:tc:opendocument:xmlns:container">
   &lt;Signature
       Id="sig"
       xmlns="http://www.w3.org/2000/09/xmldsig#">
      &lt;SignedInfo>
         &lt;CanonicalizationMethod 
             Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315"/>
            &lt;SignatureMethod
                Algorithm="http://www.w3.org/2000/09/xmldsig#dsa-sha1"/>
            &lt;Reference
                URI="#Manifest1">
               &lt;DigestMethod
                   Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"/>
               &lt;DigestValue>j6lwx3rvEPO0vKtMup4NbeVu8nk=&lt;/DigestValue>
            &lt;/Reference>
      &lt;/SignedInfo>
      &lt;SignatureValue>
         …
      &lt;/SignatureValue>
      &lt;KeyInfo>
         &lt;KeyValue>
            &lt;DSAKeyValue>
               &lt;P>…&lt;/P>
               &lt;Q>…&lt;/Q>
               &lt;G>…&lt;/G>
               &lt;Y>…&lt;/Y> 
            &lt;/DSAKeyValue>
         &lt;/KeyValue>
      &lt;/KeyInfo>
      &lt;Object>
         &lt;Manifest
             Id="Manifest1">
            &lt;Reference
                URI="EPUB/book.xhtml">                    
               &lt;Transforms>                                                
                  &lt;Transform
                      Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315"/>                        
               &lt;/Transforms>
               &lt;DigestMethod
                   Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"/>
               &lt;DigestValue>…&lt;/DigestValue>
            &lt;/Reference>
            &lt;Reference URI="EPUB/images/cover.jpeg">
               &lt;Transforms>                                                
                  &lt;Transform
                      Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315"/>                        
               &lt;/Transforms>
               &lt;DigestMethod
                   Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"/>
               &lt;DigestValue>…&lt;/DigestValue>
            &lt;/Reference>
         &lt;/Manifest>
      &lt;/Object>
   &lt;/Signature> 
&lt;/signatures></pre>
								</aside>
							</section>
						</section>
					</section>
				</section>
			</section>

			<section id="sec-container-zip">
				<h3>OCF ZIP container</h3>

				<section id="sec-container-zip-intro" class="informative">
					<h4>Introduction</h4>

					<p>An [=OCF ZIP container=] is a physical single-file manifestation of an [=OCF abstract
						container=]. The container allows:</p>

					<ul>
						<li>
							<p>the exchange of in-progress [=EPUB publication=] between different individuals and/or
								different organizations;</p>
						</li>
						<li>
							<p>the transfer of EPUB publications from a publisher or conversion house to the
								distribution or sales channel; and</p>
						</li>
						<li>
							<p>the delivery of EPUB publications to [=EPUB reading systems=] or users.</p>
						</li>
					</ul>
				</section>

				<section id="sec-zip-container-zipreqs">
					<h4>ZIP file requirements</h4>

					<p>An [=OCF ZIP container=] uses the ZIP format as specified by [[zip]], but with the following
						constraints and clarifications:</p>

					<ul class="conformance-list">
						<li>
							<p id="confreq-zip-abstr">The contents of the OCF ZIP container MUST be a conforming <a
									href="#sec-container-abstract">OCF abstract container</a>.</p>
						</li>
						<li>
							<p id="confreq-zip-mult">OCF ZIP containers MUST NOT use the features in the ZIP application
								note [[zip]] that allow ZIP files to be spanned across multiple storage media or be
								split into multiple files.</p>
						</li>
						<li>
							<p id="confreq-zip-comp">OCF ZIP containers MUST include only stored (uncompressed) and
								Deflate-compressed ZIP entries within the ZIP archive.</p>
						</li>
						<li>
							<p id="confreq-zip-64">OCF ZIP containers MAY use the ZIP64 extensions defined as "Version
								1" in section V, subsection G of the application note [[zip]] and SHOULD use only those
								extensions when the content requires them.</p>
						</li>
						<li>
							<p id="confreq-zip-enc">OCF ZIP containers MUST NOT use the encryption features defined by
								the ZIP format; instead, encryption MUST be done using the features described in <a
									href="#sec-container-metainf-encryption.xml"></a>.</p>
						</li>
						<li>
							<p id="confreq-zip-utf8">OCF ZIP containers MUST encode file system names using UTF-8
								[[unicode]].</p>
						</li>
					</ul>

					<p>The following constraints apply to specific fields in the OCF ZIP container archive:</p>

					<ul class="conformance-list">
						<li>
							<p id="confreq-zip-fld-version">In the local file header table, [=EPUB creators=] MUST set
								the <code>version needed to extract</code> fields to the values <code>10</code>,
									<code>20</code> or <code>45</code> to match the maximum version level needed by the
								given file (e.g., <code>20</code> for Deflate, <code>45</code> for ZIP64).</p>
						</li>
						<li>
							<p id="confreq-zip-fld-comp">In the local file header table, EPUB creators MUST set the
									<code>compression</code> method field to the values <code>0</code> or
								<code>8</code>.</p>
						</li>
					</ul>
				</section>

				<section id="sec-zip-container-mime">
					<h4>OCF ZIP container media type identification</h4>

					<p>[=EPUB creators=] MUST include the <code>mimetype</code> file as the first file in the [=OCF ZIP
						container=]. In addition:</p>

					<ul>
						<li>The contents of the <code>mimetype</code> file MUST be the MIME media type [[rfc2046]]
							string <code>application/epub+zip</code> encoded in US-ASCII [[us-ascii]].</li>
						<li>The <code>mimetype</code> file MUST NOT contain any leading or trailing padding or white
							space.</li>
						<li>The <code>mimetype</code> file MUST NOT begin with the Unicode byte order mark U+FEFF.</li>
						<li>EPUB creators MUST NOT compress or encrypt the <code>mimetype</code> file.</li>
						<li>EPUB creators MUST NOT include an extra field in its ZIP header.</li>
					</ul>

					<div class="note">
						<p>Refer to <a href="#app-media-type"></a> for further information about the
								<code>application/epub+zip</code> media type.</p>
					</div>
				</section>
			</section>

			<section id="sec-font-obfuscation">
				<h3>Font obfuscation</h3>

				<div class="caution">
					<p>Better methods of protecting fonts exist. Both [[woff]] and [[woff2]] fonts, for example, allow
						the embedding of licensing information and provide some protection through font table
						compression. The use of remotely hosted fonts also allows for font subsetting. [=EPUB creators=]
						are advised to use font obfuscation as defined in this section only when no other options are
						available to them. See also the <a href="#fobfus-limitations">limitations of
						obfuscation</a>.</p>
				</div>

				<section id="fobfus-intro" class="informative">
					<h4>Introduction</h4>

					<p>Since an [=OCF ZIP container=] is fundamentally a ZIP file, commonly available ZIP tools can be
						used to extract any unencrypted content stream from the package. Moreover, the nature of ZIP
						files means that their contents might appear like any other native container on some systems
						(e.g., a folder).</p>

					<p>While this simplicity of ZIP files is quite useful, it also poses a problem when ease of
						extraction of fonts is not a desired side-effect of not encrypting them. An [=EPUB creator=] who
						wishes to include a third-party font, for example, typically does not want that font extracted
						and re-used by others. More critically, many commercial fonts allow embedding, but embedding a
						font implies making it an integral part of the [=EPUB publication=], not just providing the
						original font file along with the content.</p>

					<p>Since integrated ZIP support is so ubiquitous in modern operating systems, simply placing a font
						in the [=OCF ZIP container=] is insufficient to signify that the font cannot be reused in other
						contexts. This uncertainty can undermine the otherwise useful font embedding capability of EPUB
						publications.</p>

					<p>To discourage reuse of their fonts, some font vendors might only allow their use in EPUB
						publications if the fonts are bound in some way to the EPUB publication. That is, if the font
						file cannot be installed directly for use on an operating system with the built-in tools of that
						computing device, and it cannot be directly used by other EPUB publications.</p>

					<p>It is beyond the scope of this specification to provide a digital rights management or
						enforcement system for fonts. This section instead defines a method of obfuscation that will
						require additional work on the part of the final OCF recipient to gain general access to any
						obfuscated fonts.</p>
				</section>

				<section id="fobfus-limitations" class="informative">
					<h4>Limitations</h4>

					<p>This specification does not claim that obfuscation constitutes encryption, nor does it guarantee
						that the resource will be secure from copyright infringement. The hope is only that this
						algorithm will meet the requirements of vendors who require some assurance that their fonts
						cannot be extracted simply by unzipping the [=OCF ZIP container=] and copying the resource.</p>

					<p>Obfuscation, like any protection scheme, cannot fully protect fonts from being accessed in their
						deobfuscated state. The mechanism only provides an obstacle for those who are unaware of the
						license details. It will not prevent a determined user from gaining full access to the font
						through such alternative means as:</p>

					<ul>
						<li>applying the deobfuscation algorithm to extract the raw font file;</li>
						<li>accessing the deobfuscated font through a [=reading system=] that must dedobfuscate it to
							render the content (e.g., by accessing the resources through a browser-based reading
							system); or</li>
						<li>accessing the deobfuscated font through authoring tools that provide the visual rendering of
							the content.</li>
					</ul>

					<p>As a result, whether this method of obfuscation satisfies the requirements of individual font
						licenses remains a question for the licensor and licensee. [=EPUB creators=] are responsible for
						ensuring their use of obfuscation meets font licensing requirements.</p>

					<p>EPUB creators should also be aware that obfuscation may lead to interoperability issues in
						reading systems as reading systems are not required to deobfuscate fonts. As a result, the
						visual presentation of their publications may differ from reading system to reading system.</p>

					<p>Also note that the algorithm is restricted to obfuscating fonts. It is not intended as a
						general-purpose mechanism for obfuscating any resource in the EPUB container.</p>
				</section>

				<section id="obfus-keygen">
					<h4>Obfuscation key</h4>

					<p id="obfus-key-unique-id" data-tests="#ocf-font_obfuscation,#ocf-font_obfuscation-bis">[=EPUB
						creators=] MUST derive the key used in the obfuscation algorithm from the [=unique
						identifier=].</p>

					<p>All white space characters, as defined in <a data-cite="xml#sec-common-syn">section 2.3 of the
							XML 1.0 specification</a> [[xml]], MUST be removed from this identifier — specifically, the
						Unicode code points <code>U+0020</code>, <code>U+0009</code>, <code>U+000D</code> and
							<code>U+000A</code>.</p>

					<p>EPUB creators MUST generate a SHA-1 digest of the UTF-8 representation of the resulting string as
						specified by the Secure Hash Standard [[fips-180-4]]. They can then use this digest as the key
						for the algorithm.</p>
				</section>

				<section id="obfus-algorithm">
					<h4>Obfuscation algorithm</h4>

					<p>The algorithm employed to obfuscate fonts consists of modifying the first 1040 bytes (~1KB) of
						the font file. (In the unlikely event that the font file is less than 1040 bytes, this process
						will modify the entire file.)</p>

					<p>To obfuscate the original data, store, as the first byte of the embedded font, the result of
						performing a logical exclusive or (XOR) on the first byte of the raw font file and the first
						byte of the <a href="#obfus-keygen">obfuscation key</a>.</p>

					<p>Repeat this process with the next byte of source and key and continue for all bytes in the key.
						At this point, the process continues starting with the first byte of the key and 21st byte of
						the source. Once 1040 bytes are encoded in this way (or the end of the source is reached),
						directly copy any remaining data in the source to the destination.</p>

					<p>[=EPUB creators=] MUST obfuscate fonts before compressing and adding them to the [=OCF ZIP
						container=]. Note that as obfuscation is not encryption, this requirement is not a violation of
						the one in <a href="#sec-container-metainf-encryption.xml"></a> to compress fonts before
						encrypting them.</p>

					<p>The following pseudo-code exemplifies the obfuscation algorithm.</p>

					<ol class="algorithm">
						<li>set <var>ocf</var> to OCF ZIP container file</li>
						<li>set <var>source</var> to font file</li>
						<li>set <var>destination</var> to obfuscated font file</li>
						<li>set <var>keyData</var> to key for file</li>
						<li>set <var>outer</var> to 0</li>
						<li>
							<span>while <var>outer</var> &lt; 52 and not (<var>source</var> at EOF)</span>
							<ol>
								<li>set <var>inner</var> to 0</li>
								<li>
									<span>while <var>inner</var> &lt; 20 and not (<var>source</var> at EOF)</span>
									<ol>
										<li>read 1 byte from <var>source</var> (Assumes read advances file
											position)</li>
										<li>set <var>sourceByte</var> to result of read</li>
										<li>set <var>keyByte</var> to byte <var>inner</var> of <var>keyData</var></li>
										<li>set <var>obfuscatedByte</var> to (<var>sourceByte</var> XOR
												<var>keyByte</var>)</li>
										<li>write <var>obfuscatedByte</var> to <var>destination</var></li>
										<li>increment <var>inner</var></li>
									</ol>
									<span>end while</span>
								</li>
								<li>increment <var>outer</var></li>
							</ol>
							<span>end while</span>
						</li>
						<li>
							<span>if not (<var>source</var> at EOF) then</span>
							<ol>
								<li>read <var>source</var> to EOF</li>
								<li>write result of read to <var>destination</var></li>
							</ol>
							<span>end if</span>
						</li>
						<li>Deflate <var>destination</var></li>
						<li>store <var>destination</var> as <var>source</var> in <var>ocf</var></li>
					</ol>
				</section>

				<section id="obfus-specifying">
					<h4>Specifying obfuscated fonts</h4>

					<p>Although not technically encrypted data, all obfuscated fonts MUST have an entry in the <code
							class="filename">encryption.xml</code> file accompanying the [=EPUB publication=] (see <a
							href="#sec-container-metainf-encryption.xml"></a>).</p>

					<p>[=EPUB creators=] MUST specify an <code>EncryptedData</code> element for each obfuscated font.
						Each <code>EncryptedData</code> element MUST contain a child <code>EncryptionMethod</code>
						element whose <code>Algorithm</code> attribute has the value
							<code>http://www.idpf.org/2008/embedding</code>. The presence of this attribute signals the
						use of the algorithm described in this specification.</p>

					<p>EPUB creators MUST list the path to the obfuscated font in the <code>CipherReference</code> child
						of the <code>CipherData</code> element. As the obfuscation algorithm is restricted to fonts, the
							<code>URI</code> attribute of the <code>CipherReference</code> element MUST reference a <a
							href="#cmt-grp-font">Font core media type resource</a>.</p>

					<aside class="example" title="An entry for an obfuscated font">
						<pre>&lt;encryption 
    xmlns="urn:oasis:names:tc:opendocument:xmlns:container" 
    xmlns:enc="http://www.w3.org/2001/04/xmlenc#">
   &lt;enc:EncryptedData> 
      &lt;enc:EncryptionMethod
          Algorithm="http://www.idpf.org/2008/embedding"/> 
      &lt;enc:CipherData> 
         &lt;enc:CipherReference
             URI="EPUB/Fonts/BKANT.TTF"/>  
      &lt;/enc:CipherData> 
   &lt;/enc:EncryptedData>  
&lt;/encryption></pre>
					</aside>

					<p>To prevent trivial copying of the embedded font to other EPUB publications, EPUB creators MUST
						NOT provide the <a href="#obfus-keygen">obfuscation key</a> in the <code>encryption.xml</code>
						file.</p>
				</section>
			</section>
		</section>
		<section id="sec-package-doc">
			<h2>Package document</h2>

			<p>All [[xml]] elements defined in this section are in the <code>http://www.idpf.org/2007/opf</code>
				namespace [[xml-names]] unless otherwise specified.</p>

			<section id="sec-package-intro" class="informative">
				<h3>Introduction</h3>

				<p>The [=package document=] is an XML document that consists of a set of elements that each encapsulate
					information about a particular aspect of an [=EPUB publication=]. These elements serve to centralize
					metadata, detail the individual resources, and provide the reading order and other information
					necessary for its rendering.</p>

				<p>The following list summarizes the information found in the package document:</p>

				<ul>
					<li>
						<p><a href="#sec-pkg-metadata">Metadata</a> — mechanisms to include and/or reference information
							about the EPUB publication.</p>
					</li>
					<li>
						<p>A <a href="#sec-manifest-elem">manifest</a> — identifies via URL [[url]], and describes via
							MIME media type [[rfc4839]], the set of [=publication resources=].</p>
					</li>
					<li>
						<p>A <a href="#sec-spine-elem">spine</a> — an ordered sequence of ID references to top-level
							resources in the manifest from which [=reading systems=] can reach or utilize all other
							resources in the set. The spine defines the default reading order.</p>
					</li>
					<li>
						<p><a href="#sec-collection-elem">Collections</a> — a method of encapsulating and identifying
							subcomponents within the EPUB publication.</p>
					</li>
					<li>
						<p>[=Manifest fallback chains=] — a mechanism that defines an ordered list of top-level
							resources as content equivalents. A reading system can then choose between the resources
							based on which it is capable of rendering.</p>
					</li>
				</ul>

				<div class="note">
					<p>An EPUB publication can reference more than one package document, allowing for alternative
						representations of the content. For more information, refer to <a
							href="#sec-container-metainf-container.xml"></a></p>
				</div>

				<div class="note">
					<p>Refer to <a href="#app-media-type-app-oebps-package"></a> for information about the file
						properties of package documents.</p>
				</div>
			</section>

			<section id="sec-parse-package-urls">
				<h3>Parsing URLs in the package document</h3>

				<p id="pkg-parse-package-url" data-tests="#ocf-url_link-relative,#ocf-url_relative"> To parse a URL
					string <var>url</var> used in the [=package document=], the <a data-lt="url parser">URL
					parser</a> [[url]] MUST be applied to <var>url</var>, with the [=content URL=] of the package
					document as <var>base</var>.</p>
			</section>

			<section id="sec-shared-attrs">
				<h3>Shared attributes</h3>

				<p>This section provides definitions for shared attributes (i.e., attributes allowed on two or more
					elements).</p>

				<section id="attrdef-dir">
					<h4>The <code>dir</code> attribute</h4>

					<p
						data-tests="#pkg-dir_creator-rtl,#pkg-dir_rtl-root-ltr,#pkg-dir_rtl-root-unset,#pkg-dir_unset-root-rtl,#pkg-dir_unset-root-unset,#pkg-dir-auto_root-rtl"
						>Specifies the <a data-cite="bidi#BD5">base direction</a> [[bidi]] of the textual content and
						attribute values of the carrying element and its descendants.</p>

					<p>Allowed values are:</p>

					<ul>
						<li><code>ltr</code> &#8212; left-to-right base direction;</li>
						<li><code>rtl</code> &#8212; right-to-left base direction; and</li>
						<li><code>auto</code> &#8212; base direction is determined using the Unicode Bidi Algorithm
							[[bidi]].</li>
					</ul>

					<p data-tests="#pkg-dir-auto_root-rtl,#pkg-dir-auto_root-unset">[=Reading systems=] will assume the
						value <code>auto</code> when [=EPUB creators=] omit the attribute or use an invalid value.</p>

					<div class="note">
						<p>The base direction specified in the <code>dir</code> attribute does not affect the ordering
							of characters within directional runs, only the relative ordering of those runs and the
							placement of weak directional characters such as punctuation.</p>
					</div>

					<aside class="example" title="Setting the global base direction for package document text">
						<pre>&lt;package … dir="ltr">
   …
&lt;/package></pre>
					</aside>

					<p>Allowed on: [^collection^], [^dc:contributor^], <a href="#sec-opf-dcmes-optional-def"
								><code>dc:coverage</code></a>, [^dc:creator^], <a href="#sec-opf-dcmes-optional-def"
								><code>dc:description</code></a>, <a href="#sec-opf-dcmes-optional-def"
								><code>dc:publisher</code></a>, <a href="#sec-opf-dcmes-optional-def"
								><code>dc:relation</code></a>, <a href="#sec-opf-dcmes-optional-def"
								><code>dc:rights</code></a>, [^dc:subject^], [^dc:title^], [^meta^] and [^package^].</p>
				</section>


				<section id="attrdef-href">
					<h4>The <code>href</code> attribute</h4>

					<p>A [=valid URL string=] [[url]] that references a resource.</p>

					<p>The URL string MUST NOT reference resources via elements in the package document (e.g., via a
						manifest [^item^] or spine [^itemref^] declaration).</p>

					<aside class="example" title="Linking a metadata record">
						<pre>&lt;package …>
   &lt;metadata …>
      …
      &lt;link
          rel="record"
          href="meta/9780000000001.xml" 
          media-type="application/marc"/>
      …
   &lt;/metadata>
   …
&lt;/package></pre>
					</aside>

					<p>Allowed on: [^item^] and [^link^].</p>
				</section>

				<section id="attrdef-id">
					<h4>The <code>id</code> attribute</h4>

					<p>The <a data-cite="xml#id">ID</a> [[xml]] of the element, which MUST be unique within the document
						scope.</p>

					<aside class="example" title="Adding an identifier attribute">
						<pre>&lt;dc:title id="pub-title">The Lord of the Rings&lt;/dc:title></pre>
					</aside>

					<p>Allowed on: [^collection^], [^dc:contributor^], <a href="#sec-opf-dcmes-optional-def"
								><code>dc:coverage</code></a>, [^dc:creator^], [^dc:date^], <a
							href="#sec-opf-dcmes-optional-def"><code>dc:description</code></a>, <a
							href="#sec-opf-dcmes-optional-def"><code>dc:format</code></a>, [^dc:identifier^],
						[^dc:language^], <a href="#sec-opf-dcmes-optional-def"><code>dc:publisher</code></a>, <a
							href="#sec-opf-dcmes-optional-def"><code>dc:relation</code></a>, <a
							href="#sec-opf-dcmes-optional-def"><code>dc:rights</code></a>, <a
							href="#sec-opf-dcmes-optional-def"><code>dc:source</code></a>, [^dc:subject^], [^dc:title^],
						[^dc:type^], [^item^], [^itemref^], [^link^], [^manifest^], [^meta^], [^package^] and
						[^spine^].</p>
				</section>

				<section id="attrdef-media-type">
					<h4>The <code>media-type</code> attribute</h4>

					<p>A media type [[rfc2046]] that specifies the type and format of the referenced resource.</p>

					<aside class="example" title="Adding the media type for a linked record">
						<pre>&lt;package …>
   &lt;metadata …>
      …
      &lt;link
          rel="record"
          href="http://example.org/meta/12389347?format=xmp"
          media-type="application/xml"
          properties="xmp"/>
      …
   &lt;/metadata>
   …
&lt;/package></pre>
					</aside>

					<p>Allowed on: [^item^] and [^link^].</p>
				</section>

				<section id="attrdef-properties">
					<h4>The <code>properties</code> attribute</h4>

					<p>A space-separated list of <a href="#sec-property-datatype">property</a> values.</p>

					<p>Refer to each element's definition for the <a href="#sec-default-vocab">reserved vocabulary</a>
						for the attribute.</p>

					<aside class="example" title="Identifying the EPUB navigation document in the manifest">
						<pre>&lt;package …>
   …
   &lt;manifest>
      …
      &lt;item
          id="nav" 
          href="nav.xhtml"
          properties="nav"
          media-type="application/xhtml+xml"/>
      …
   &lt;/manifest>
   …
&lt;/package></pre>
					</aside>

					<p>Allowed on: [^item^], [^itemref^] and [^link^].</p>
				</section>

				<section id="attrdef-refines">
					<h4>The <code>refines</code> attribute</h4>

					<p>Establishes an association between the current expression and the element or resource identified
						by its value. [=EPUB creators=] MUST use as the value a [=path-relative-scheme-less-URL
						string=], optionally followed by <code>U+0023 (#)</code> and a [=URL-fragment string=] that
						references the resource or element they are describing.</p>

					<aside class="example" title="Specifying that a creator is the illustrator">
						<pre>&lt;package …>
   &lt;metadata …>
      …
      &lt;dc:creator id="creator02">
         E.H. Shepard
      &lt;/dc:creator>
      &lt;meta
          refines="#creator02"
          property="role"
          scheme="marc:relators">
         ill
      &lt;/meta>
      …
   &lt;/metadata>
   …
&lt;/package></pre>
					</aside>

					<p>The <code>refines</code> attribute is OPTIONAL depending on the type of metadata expressed. When
						omitted, the element defines a <a href="#primary-expression">primary expression</a>.</p>

					<p>When creating expressions about a [=publication resource=], the <code>refines</code> attribute
						SHOULD specify a fragment identifier that references the <a data-cite="xml#id">ID</a> [[xml]] of
						the resource's <a href="#sec-item-elem">manifest entry</a>.</p>

					<p>Refinement chains MUST NOT contain circular references or self-references.</p>

					<aside class="example" title="Setting the duration of a media overlay document">
						<pre>&lt;package …>
   &lt;metadata …>
      …
      &lt;meta
          property="media:duration" 
          refines="#c01_overlay">
         0:32:29
      &lt;/meta>
      …
   &lt;/metadata>
   &lt;manifest>
      …
      &lt;item
          id="c01_overlay"
          href="overlays/chapter01.smil"
          media-type="application/smil+xml"/>
      …
   &lt;/manifest>
   …
&lt;/package></pre>
					</aside>

					<p>Allowed on: [^link^] and [^meta^].</p>
				</section>

				<section id="attrdef-xml-lang">
					<h4>The <code>xml:lang</code> attribute</h4>

					<p>Specifies the language of the textual content and attribute values of the carrying element and
						its descendants, as defined in section <a data-cite="xml#sec-lang-tag">2.12 Language
							Identification</a> of [[xml]]. The value of each <code>xml:lang</code> attribute MUST be a
							<a data-cite="bcp47#section-2.2.9">well-formed language tag</a> [[bcp47]].</p>

					<aside class="example" title="Setting the global language for package document text">
						<pre>&lt;package … xml:lang="ja">
   …
&lt;/package></pre>
					</aside>

					<p>Allowed on: [^collection^], [^dc:contributor^], <a href="#sec-opf-dcmes-optional-def"
								><code>dc:coverage</code></a>, [^dc:creator^], <a href="#sec-opf-dcmes-optional-def"
								><code>dc:description</code></a>, <a href="#sec-opf-dcmes-optional-def"
								><code>dc:publisher</code></a>, <a href="#sec-opf-dcmes-optional-def"
								><code>dc:relation</code></a>, <a href="#sec-opf-dcmes-optional-def"
								><code>dc:rights</code></a>, [^dc:subject^], [^dc:title^], [^meta^] and [^package^].</p>
				</section>
			</section>

			<section id="sec-package-elem">
				<h3>The <code>package</code> element</h3>

				<p>The <code>package</code> element encapsulates all the information expressed in the [=package
					document=].</p>

				<dl id="elemdef-opf-package" class="elemdef">
					<dt>Element Name:</dt>
					<dd>
						<p>
							<dfn class="export" data-lt-no-plural="" data-dfn-type="element"><code>package</code></dfn>
						</p>
					</dd>

					<dt>Usage:</dt>
					<dd>
						<p>REQUIRED <a data-cite="xml#dt-root">root element</a> [[xml]] of the package document.</p>
					</dd>

					<dt>Attributes:</dt>
					<dd>
						<ul class="nomark">
							<li>
								<p>
									<a href="#attrdef-dir">
										<code>dir</code>
									</a>
									<code>[optional]</code>
								</p>
							</li>
							<li>
								<p>
									<a href="#attrdef-id">
										<code>id</code>
									</a>
									<code>[optional]</code>
								</p>
							</li>
							<li>
								<p>
									<a href="#attrdef-package-prefix">
										<code>prefix</code>
									</a>
									<code>[optional]</code>
								</p>
							</li>
							<li>
								<p>
									<a href="#attrdef-xml-lang">
										<code>xml:lang</code>
									</a>
									<code>[optional]</code>
								</p>
							</li>
							<li>
								<p>
									<a href="#attrdef-package-unique-identifier">
										<code>unique-identifier</code>
									</a>
									<code>[required]</code>
								</p>
							</li>
							<li>
								<p>
									<a href="#attrdef-package-version">
										<code>version</code>
									</a>
									<code>[required]</code>
								</p>
							</li>
						</ul>
					</dd>

					<dt>Content Model:</dt>
					<dd>
						<p>In this order:</p>
						<ul class="nomark">
							<li>
								<p> [^metadata^] <code>[exactly 1]</code>
								</p>
							</li>
							<li>
								<p> [^manifest^] <code>[exactly 1]</code>
								</p>
							</li>
							<li>
								<p> [^spine^] <code>[exactly 1]</code>
								</p>
							</li>
							<li>
								<p>
									<a href="#sec-opf2-guide">
										<code>guide</code>
									</a>
									<code>[0 or 1]</code>
									<a href="#sec-pkg-legacy-intro" class="legacy">(legacy)</a>
								</p>
							</li>
							<li>
								<p>
									<a href="#sec-opf-bindings">
										<code>bindings</code>
									</a>
									<code>[0 or 1]</code>
									<a href="#deprecated" class="deprecated">(deprecated)</a>
								</p>
							</li>
							<li>
								<p> [^collection^] <code>[0 or more]</code>
								</p>
							</li>
						</ul>
					</dd>
				</dl>

				<p id="attrdef-package-version">The <code>version</code> attribute specifies the EPUB specification
					version to which the given [=EPUB publication=] conforms. The attribute MUST have the value
						"<code>3.0</code>" to indicate conformance with EPUB 3.</p>

				<div class="note">
					<p>Updates to this specification do not represent new versions of EPUB 3 (i.e., each new 3.X
						specification is a continuation of the EPUB 3 format). The Working Group is committed to
						minimizing any changes that would invalidate existing content, allowing the <code>version</code>
						attribute value to remain unchanged.</p>
				</div>

				<p id="attrdef-package-unique-identifier">The <code>unique-identifier</code> attribute takes an IDREF
					[[xml]] that identifies the [^dc:identifier^] element that provides the preferred, or primary,
					identifier.</p>

				<p id="attrdef-package-prefix">The <code>prefix</code> attribute provides a declaration mechanism for
					prefixes not <a href="#sec-metadata-reserved-prefixes">reserved by this specification</a>. Refer to
						<a href="#sec-prefix-attr"></a> for more information.</p>
			</section>

			<section id="sec-pkg-metadata">
				<h3>Metadata section</h3>

				<section id="sec-metadata-elem">
					<h4>The <code>metadata</code> element</h4>

					<p>The <code>metadata</code> element encapsulates meta information.</p>

					<dl id="elemdef-opf-metadata" class="elemdef">
						<dt>Element Name:</dt>
						<dd>
							<p>
								<dfn class="export" data-lt-no-plural="" data-dfn-type="element"
									><code>metadata</code></dfn>
							</p>
						</dd>

						<dt>Usage:</dt>
						<dd>
							<p>REQUIRED first child of [^package^].</p>
						</dd>

						<dt>Attributes:</dt>
						<dd>
							<p>None</p>
						</dd>

						<dt>Content Model:</dt>
						<dd>
							<p>In any order:</p>
							<ul class="nomark">
								<li>
									<p> [^dc:identifier^] <code>[1 or more]</code>
									</p>
								</li>
								<li>
									<p> [^dc:title^] <code>[1 or more]</code>
									</p>
								</li>
								<li>
									<p> [^dc:language^] <code>[1 or more]</code>
									</p>
								</li>
								<li>
									<p>
										<a href="#sec-opf-dcmes-optional">
											<code>Dublin Core Optional Elements</code>
										</a>
										<code>[0 or more]</code>
									</p>
								</li>
								<li>
									<p> [^meta^] <code>[1 or more]</code>
									</p>
								</li>
								<li>
									<p>
										<a href="#sec-opf2-meta">OPF2 <code>meta</code></a>
										<code>[0 or more]</code>
										<a href="#sec-pkg-legacy-intro" class="legacy">(legacy)</a>
									</p>
								</li>
								<li>
									<p> [^link^] <code>[0 or more]</code>
									</p>
								</li>
							</ul>
						</dd>
					</dl>

					<p>The [=package document=] <code>metadata</code> element has two primary functions:</p>

					<ol>
						<li>
							<p>to provide a minimal set of meta information for [=reading systems=] to use to internally
								catalogue an [=EPUB publication=] and make it available to a user (e.g., to present in a
								bookshelf).</p>
						</li>
						<li>
							<p>to provide access to all rendering metadata needed to control the layout and display of
								the content (e.g., <a href="#sec-fxl-package">fixed-layout properties</a>).</p>
						</li>
					</ol>

					<p>The package document does not provide complex metadata encoding capabilities. If [=EPUB
						creators=] need to provide more detailed information, they can associate metadata records (e.g.,
						that conform to an international standard such as [[onix]] or are created for custom purposes)
						using the [^link^] element. This approach allows reading systems to process the metadata in its
						native form, avoiding the potential problems and information loss caused by translating to use
						the minimal package document structure.</p>

					<p id="core-metadata-reqs">In keeping with this philosophy, the package document only has the
						following minimal metadata requirements: it MUST contain the [[dcterms]] [^dc:title^],
						[^dc:identifier^], and [^dc:language^] elements together with the [[dcterms]]
						[^dcterms:modified^] property. All other metadata is OPTIONAL.</p>

					<aside class="example" title="The minimal set of metadata required in the package document">
						<pre>&lt;package … unique-identifier="pub-id">
    …
    &lt;metadata …>
       &lt;dc:identifier
           id="pub-id">
          urn:uuid:A1B0D67E-2E81-4DF5-9E67-A64CBE366809
       &lt;/dc:identifier>
       &lt;dc:title>
          Norwegian Wood
       &lt;/dc:title>
       &lt;dc:language>
          en
       &lt;/dc:language>
       &lt;meta
           property="dcterms:modified">
          2011-01-01T12:00:00Z
       &lt;/meta>
    &lt;/metadata>
    …
&lt;/package>
</pre>
					</aside>

					<p>The [^meta^] element provides a generic mechanism for including <a href="#sec-vocab-assoc"
							>metadata properties from any vocabulary</a>. Although EPUB creators MAY use this mechanism
						for any metadata purposes, they will typically use it to include rendering metadata defined in
						EPUB specifications.</p>

					<div class="note">
						<p>See [[epub-a11y-11]] for accessibility metadata recommendations.</p>
					</div>
				</section>

				<section id="sec-metadata-values">
					<h4>Metadata values</h4>

					<p>The Dublin Core elements [[dcterms]] and [^meta^] element have mandatory [=child text content=]
						[[dom]]. In the descriptions for these elements, this specification refers to this content as
						the element's <dfn>value</dfn>.</p>

					<p>These elements MUST have non-empty values after <a
							data-lt="strip leading and trailing ascii whitespace">leading and trailing ASCII
							whitespace</a> [[infra]] is stripped (i.e., they must consist of at least one non-whitespace
						character).</p>

					<p>Whitespace within these element values is not significant. Sequences of one or more whitespace
						characters are <a data-lt="strip and collapse ascii whitespace">collapsed to a single
						space</a> [[infra]] during processing .</p>
				</section>

				<section id="sec-opf-dcmes-required">
					<h4>Dublin Core required elements</h4>

					<section id="sec-opf-dcidentifier">
						<h5>The <code>dc:identifier</code> element</h5>

						<p>The <code>dc:identifier</code> element [[dcterms]] contains an identifier such as a <abbr
								title="Universally Unique Identifier">UUID</abbr>, <abbr
								title="Digital Object Identfier">DOI</abbr> or <abbr
								title="International Standard Book Number">ISBN</abbr>.</p>

						<dl id="elemdef-opf-dcidentifier" class="elemdef">
							<dt>Element Name:</dt>
							<dd>
								<p>
									<dfn class="export" data-lt-no-plural="" data-dfn-type="element"
											><code>dc:identifier</code></dfn>
								</p>
							</dd>

							<dt>Namespace:</dt>
							<dd>
								<p>
									<code>http://purl.org/dc/elements/1.1/</code>
								</p>
							</dd>

							<dt>Usage:</dt>
							<dd>
								<p>REQUIRED child of [^metadata^]. Repeatable.</p>
							</dd>

							<dt>Attributes:</dt>
							<dd>
								<ul class="nomark">
									<li>
										<p>
											<a href="#attrdef-id">
												<code>id</code>
											</a>
											<code>[conditionally required]</code>
										</p>
									</li>
								</ul>
							</dd>

							<dt>Content Model:</dt>
							<dd>
								<p>Text</p>
							</dd>
						</dl>

						<p>The [=EPUB creator=] MUST provide an identifier that is unique to one and only one [=EPUB
							publication=] &#8212; its [=unique identifier=] &#8212; in an <code>dc:identifier</code>
							element. This <code>dc:identifier</code> element MUST specify an <code>id</code> attribute
							whose value is referenced from the [^package^] element's <a
								href="#attrdef-package-unique-identifier"><code>unique-identifier</code>
							attribute</a>.</p>

						<aside class="example" title="Specifying the element with the unique identifier">
							<pre>&lt;package … unique-identifier="pub-id">
    &lt;metadata …>
       &lt;dc:identifier id="pub-id">
           urn:uuid:A1B0D67E-2E81-4DF5-9E67-A64CBE366809
       &lt;/dc:identifier>
       …
    &lt;/metadata>
&lt;/package></pre>
						</aside>

						<p>Although not static, EPUB creators should make changes to the unique identifier for an EPUB
							publication as infrequently as possible. Unique Identifiers should have maximal persistence
							both for referencing and distribution purposes. EPUB creators should not issue new
							identifiers when making minor revisions such as updating metadata, fixing errata, or making
							similar minor changes.</p>

						<p>EPUB creators MAY specify additional identifiers. The identifiers should be fully qualified
							URIs.</p>

						<p>EPUB creators MAY use the <a href="#identifier-type"><code>identifier-type</code>
								property</a> to indicate that the value of a <code>dc:identifier</code> element conforms
							to an established system or an issuing authority granted it.</p>

						<aside class="example" title="Specifying the type of the identifier">
							<p>In this example, the <code>identifier-type</code> property is used with the <a
									href="https://ns.editeur.org/onix/en/5">ONIX codelist 5</a> scheme to indicate the
								product identifier type is a <a href="https://www.doi.org">DOI</a> (i.e., the value
									<code>06</code> in codelist 5 is for DOIs).</p>

							<pre>&lt;metadata …>
   &lt;dc:identifier
       id="pub-id">
      urn:doi:10.1016/j.iheduc.2008.03.001
   &lt;/dc:identifier>
   &lt;meta
       refines="#pub-id"
       property="identifier-type"
       scheme="onix:codelist5">
      06
   &lt;/meta>
   …
&lt;/metadata></pre>
						</aside>
					</section>

					<section id="sec-opf-dctitle">
						<h5>The <code>dc:title</code> element</h5>

						<p>The <code>dc:title</code> element [[dcterms]] represents an instance of a name for the [=EPUB
							publication=].</p>

						<dl id="elemdef-opf-dctitle" class="elemdef">
							<dt>Element Name:</dt>
							<dd>
								<p>
									<dfn class="export" data-lt-no-plural="" data-dfn-type="element"
											><code>dc:title</code></dfn>
								</p>
							</dd>

							<dt>Namespace:</dt>
							<dd>
								<p>
									<code>http://purl.org/dc/elements/1.1/</code>
								</p>
							</dd>

							<dt>Usage:</dt>
							<dd>
								<p>REQUIRED child of [^metadata^]. Repeatable.</p>
							</dd>

							<dt>Attributes:</dt>
							<dd>
								<ul class="nomark">
									<li>
										<p>
											<a href="#attrdef-dir">
												<code>dir</code>
											</a>
											<code>[optional]</code>
										</p>
									</li>
									<li>
										<p>
											<a href="#attrdef-id">
												<code>id</code>
											</a>
											<code>[optional]</code>
										</p>
									</li>
									<li>
										<p>
											<a href="#attrdef-xml-lang">
												<code>xml:lang</code>
											</a>
											<code>[optional]</code>
										</p>
									</li>
								</ul>
							</dd>

							<dt>Content Model:</dt>
							<dd>
								<p>Text</p>
							</dd>
						</dl>

						<p id="title-order">The first <code>dc:title</code> element in document order is the main title
							of the EPUB publication (i.e., the primary one reading systems present to users).</p>

						<aside class="example" title="A basic title element">
							<pre>&lt;metadata …>
   &lt;dc:title>
      Norwegian Wood
   &lt;/dc:title>
   …
&lt;/metadata>
</pre>
						</aside>

						<p>[=EPUB creators=] should use only a single <code>dc:title</code> element to ensure consistent
							rendering of the title in [=reading systems=].</p>

						<div class="note">
							<p>Although it is possible to include more than one <code>dc:title</code> element for
								multipart titles, reading system support for additional <code>dc:title</code> elements
								is inconsistent. Reading systems may ignore the additional segments or combine them in
								unexpected ways.</p>

							<p>For example, the following example shows a basic multipart title:</p>

							<pre>&lt;metadata …>
   &lt;dc:title>
      THE LORD OF THE RINGS
   &lt;/dc:title>
   &lt;dc:title>
      Part One: The Fellowship of the Ring
   &lt;/dc:title>
   …
&lt;/metadata>
</pre>

							<p>The same title could instead be expressed using a single <code>dc:title</code> element as
								follows:</p>

							<pre>&lt;metadata …>
   &lt;dc:title>
       THE LORD OF THE RINGS, Part One:
       The Fellowship of the Ring
   &lt;/dc:title>
   …
&lt;/metadata>
</pre>

							<p>Previous versions of this specification recommended using the <a href="#sec-title-type"
										><code>title-type</code></a> and <a href="#sec-display-seq"
										><code>display-seq</code></a> properties to identify and format the segments of
								multipart titles (see the <a href="#cookbook-ex">Great Cookbooks example</a>). It is
								still possible to add these semantics, but they are also not well supported.</p>
						</div>
					</section>

					<section id="sec-opf-dclanguage">
						<h5>The <code>dc:language</code> element</h5>

						<p>The <code>dc:language</code> element [[dcterms]] specifies the language of the content of the
							[=EPUB publication=].</p>

						<dl id="elemdef-opf-dclanguage" class="elemdef">
							<dt>Element Name:</dt>
							<dd>
								<p>
									<dfn class="export" data-lt-no-plural="" data-dfn-type="element"
											><code>dc:language</code></dfn>
								</p>
							</dd>

							<dt>Namespace:</dt>
							<dd>
								<p>
									<code>http://purl.org/dc/elements/1.1/</code>
								</p>
							</dd>

							<dt>Usage:</dt>
							<dd>
								<p>REQUIRED child of [^metadata^]. Repeatable.</p>
							</dd>

							<dt>Attributes:</dt>
							<dd>
								<p>
									<a href="#attrdef-id">
										<code>id</code>
									</a>
									<code>[optional]</code>
								</p>
							</dd>

							<dt>Content Model:</dt>
							<dd>
								<p>Text</p>
							</dd>
						</dl>

						<p>The [=value=] of each <code>dc:language</code> element MUST be a <a
								data-cite="bcp47#section-2.2.9">well-formed language tag</a> [[bcp47]].</p>

						<aside class="example" title="Specifying U.S. English as the language of the EPUB publication">
							<pre>&lt;metadata …>
   …
   &lt;dc:language>
      en-US
   &lt;/dc:language>
   …
&lt;/metadata></pre>
						</aside>

						<p>Although [=EPUB creators=] MAY specify additional <code>dc:language</code> elements for
							multilingual Publications, [=reading systems=] will treat the first <code>dc:language</code>
							element in document order as the primary language of the EPUB publication.</p>

						<div class="note">
							<p>[=Publication resources=] do not inherit their language from the <code>dc:language</code>
								element(s). EPUB creators must set the language of a resource using the intrinsic
								methods of the format.</p>
						</div>
					</section>
				</section>

				<section id="sec-opf-dcmes-optional">
					<h4>Dublin Core optional elements</h4>

					<section id="sec-opf-dcmes-optional-def">
						<h5>General definition</h5>

						<p>All [[dcterms]] elements except for [^dc:identifier^], [^dc:language^], and [^dc:title^] are
							designated as OPTIONAL. These elements conform to the following generalized definition:</p>

						<dl class="elemdef">
							<dt>Element Name:</dt>
							<dd>
								<p>
									<code>dc:contributor</code> | <code>dc:coverage</code> | <code>dc:creator</code> |
										<code>dc:date</code> | <code>dc:description</code> | <code>dc:format</code> |
										<code>dc:publisher</code> | <code>dc:relation</code> | <code>dc:rights</code> |
										<code>dc:source</code> | <code>dc:subject</code> | <code>dc:type</code></p>
							</dd>

							<dt>Namespace:</dt>
							<dd>
								<p>
									<code>http://purl.org/dc/elements/1.1/</code>
								</p>
							</dd>

							<dt>Usage:</dt>
							<dd>
								<p>OPTIONAL child of [^metadata^]. Repeatable.</p>
							</dd>

							<dt>Attributes:</dt>
							<dd>
								<ul class="nomark">
									<li>
										<p><a href="#attrdef-dir"><code>dir</code></a>
											<code>[optional]</code> – only allowed on <code>dc:contributor</code>,
												<code>dc:coverage</code>, <code>dc:creator</code>,
												<code>dc:description</code>, <code>dc:publisher</code>,
												<code>dc:relation</code>, <code>dc:rights</code>, and
												<code>dc:subject</code>.</p>
									</li>
									<li>
										<p><a href="#attrdef-id"><code>id</code></a>
											<code>[optional]</code> – allowed on any element.</p>
									</li>
									<li>
										<p><a href="#attrdef-xml-lang"><code>xml:lang</code></a>
											<code>[optional]</code> – only allowed on <code>dc:contributor</code>,
												<code>dc:coverage</code>, <code>dc:creator</code>,
												<code>dc:description</code>, <code>dc:publisher</code>,
												<code>dc:relation</code>, <code>dc:rights</code>, and
												<code>dc:subject</code>.</p>
									</li>
								</ul>
							</dd>

							<dt>Content Model:</dt>
							<dd>
								<p>Text</p>
							</dd>
						</dl>

						<p>This specification does not modify the [[dcterms]] element definitions except as noted in the
							following sections.</p>
					</section>

					<section id="sec-opf-dccontributor">
						<h5>The <code>dc:contributor</code> element</h5>

						<p>The <dfn class="export" data-lt-no-plural="" data-dfn-type="element"
									><code>dc:contributor</code></dfn> element [[dcterms]] is used to represent the name
							of a person, organization, etc. that played a secondary role in the creation of the
							content.</p>

						<p>The requirements for the <code>dc:contributor</code> element are identical to those for the
							[^dc:creator^] element in all other respects.</p>
					</section>

					<section id="sec-opf-dccreator">
						<h5>The <code>dc:creator</code> element</h5>

						<p>The <dfn class="export" data-lt-no-plural="" data-dfn-type="element"
								><code>dc:creator</code></dfn> element [[dcterms]] represents the name of a person,
							organization, etc. responsible for the creation of the content. [=EPUB creators=] MAY <a
								href="#subexpression">associate</a> a <a href="#role"><code>role</code> property</a>
							with the element to indicate the function the creator played.</p>

						<aside class="example" title="Specifying that a creator is an author">
							<p>In this example, the <a href="https://id.loc.gov/vocabulary/relators.html">MARC
									relators</a> scheme is used to indicate the role (i.e., the value <code>aut</code>
								indicates an author in MARC).</p>

							<pre>&lt;metadata …>
   …
   &lt;dc:creator
       id="creator">
      Haruki Murakami
   &lt;/dc:creator>
   &lt;meta
       refines="#creator"
       property="role"
       scheme="marc:relators"
       id="role">
      aut
   &lt;/meta>
   …
&lt;/metadata></pre>
						</aside>

						<p>The <code>dc:creator</code> element should contain the name of the creator as EPUB creators
							intend [=reading systems=] to display it to users.</p>

						<p>EPUB creators MAY use the <a href="#file-as"><code>file-as</code> property</a>
							<a href="#subexpression">to associate</a> a normalized form of the creator's name, and the
								<a href="#alternate-script"><code>alternate-script</code> property</a> to represent the
							creator's name in another language or script.</p>

						<aside class="example" title="Expressing sorting and rendering information for a creator">
							<pre>&lt;metadata …>
   …
   &lt;dc:creator
       id="creator">
      Haruki Murakami
   &lt;/dc:creator>
   &lt;meta
       refines="#creator"
       property="alternate-script"
       xml:lang="ja">
      村上 春樹
   &lt;/meta>
   &lt;meta
       refines="#creator"
       property="file-as">
      Murakami, Haruki
   &lt;/meta>
   …
&lt;/metadata></pre>
						</aside>

						<p>If an [=EPUB publication=] has more than one creator, EPUB creators should specify each in a
							separate <code>dc:creator</code> element.</p>

						<p>The document order of <code>dc:creator</code> elements in the <code>metadata</code> section
							determines the display priority, where the first <code>dc:creator</code> element encountered
							is the primary creator.</p>

						<aside class="example" title="Expressing the primary creator">
							<p>In this example, Lewis Carroll is the primary creator because he is listed first.</p>

							<pre>&lt;metadata …>
   …
   &lt;dc:creator
       id="creator01">
      Lewis Carroll
   &lt;/dc:creator>
   &lt;dc:creator
       id="creator02">
      John Tenniel
   &lt;/dc:creator>
   …
&lt;/metadata></pre>
						</aside>

						<p>EPUB creators should represent secondary contributors using the [^dc:contributor^]
							element.</p>
					</section>

					<section id="sec-opf-dcdate">
						<h5>The <code>dc:date</code> element</h5>

						<p>The <dfn class="export" data-lt-no-plural="" data-dfn-type="element"
								><code>dc:date</code></dfn> element [[dcterms]] defines the publication date of the
							[=EPUB publication=]. The publication date is not the same as the <a
								href="#last-modified-date">last modified date</a> (the last time the [=EPUB creator=]
							changed the EPUB publication).</p>

						<p>It is RECOMMENDED that the date string conform to [[iso8601]], particularly the subset
							expressed in W3C Date and Time Formats [[datetime]], as such strings are both human and
							machine readable.</p>

						<aside class="example" title="Expressing the publication date">
							<pre>&lt;metadata …>
   …
   &lt;dc:date>
      2000-01-01T00:00:00Z
   &lt;/dc:date>
   …
&lt;/metadata></pre>
						</aside>

						<p>EPUB creators should express additional dates using the specialized date properties available
							in the [[dcterms]] vocabulary, or similar.</p>

						<p>EPUB publications MUST NOT contain more than one <code>dc:date</code> element.</p>
					</section>

					<section id="sec-opf-dcsubject">
						<h5>The <code>dc:subject</code> element</h5>

						<p>The <dfn class="export" data-lt-no-plural="" data-dfn-type="element"
								><code>dc:subject</code></dfn> element [[dcterms]] identifies the subject of the [=EPUB
							publication=]. [=EPUB creators=] should set the [=value=] of the element to the
							human-readable heading or label, but may use a code value if the subject taxonomy does not
							provide a separate descriptive label.</p>

						<p>EPUB creators MAY identify the system or scheme they drew the element's [=value=] from using
							the <a href="#authority"><code>authority</code> property</a>.</p>

						<p>When a scheme is identified, EPUB creators MUST <a href="#subexpression">associate</a> a
							subject code using the <a href="#term"><code>term</code> property</a>.</p>

						<aside class="example" title="Specifying a BISAC code and heading">
							<pre>&lt;metadata …>
   &lt;dc:subject id="subject01">
      FICTION / Occult &amp;amp; Supernatural
   &lt;/dc:subject>
   &lt;meta
       refines="#subject01"
       property="authority">
      BISAC
   &lt;/meta>
   &lt;meta
       refines="#subject01"
       property="term">
      FIC024000
   &lt;/meta>
&lt;/metadata</pre>
						</aside>

						<aside class="example" title="Specifying a URL for the scheme">
							<pre>&lt;metadata …>
   &lt;dc:subject id="sbj01">
      Number Theory
   &lt;/dc:subject>
   &lt;meta
       refines="#sbj01"
       property="authority">
      http://www.ams.org/msc/msc2010.html
   &lt;/meta>
   &lt;meta
      refines="#sbj01"
      property="term">
     11
  &lt;/meta>
&lt;/metadata></pre>
						</aside>

						<p>The <code>term</code> property MUST NOT be <a href="#subexpression">associated with a
									<code>dc:subject</code> element</a> that does not specify a scheme.</p>

						<p>The [=values=] of the <code>dc:subject</code> element and <code>term</code> property are case
							sensitive only when the designated scheme requires.</p>
					</section>

					<section id="sec-opf-dctype">
						<h5>The <code>dc:type</code> element</h5>

						<p>The <dfn class="export" data-lt-no-plural="" data-dfn-type="element"
								><code>dc:type</code></dfn> element [[dcterms]] is used to indicate that the [=EPUB
							publication=] is of a specialized type (e.g., annotations or a dictionary packaged in EPUB
							format).</p>

						<p>[=EPUB creators=] MAY use any text string as a [=value=].</p>

						<div class="note">
							<p>The former <abbr title="International Digital Publishing Forum">IDPF</abbr> EPUB 3
								Working Group maintained a <a href="http://idpf.org/epub/vocab/package/types/"
									>non-normative registry of specialized EPUB publication types</a> for use with this
								element. This Working Group no longer maintains the registry and does not anticipate
								developing new specialized publication types.</p>
						</div>
					</section>
				</section>

				<section id="sec-meta-elem">
					<h4>The <code>meta</code> element</h4>

					<p>The <code>meta</code> element provides a generic means of including package metadata.</p>

					<dl id="elemdef-meta" class="elemdef">
						<dt>Element Name:</dt>
						<dd>
							<p>
								<dfn class="export" data-lt-no-plural="" data-dfn-type="element"><code>meta</code></dfn>
							</p>
						</dd>

						<dt>Usage:</dt>
						<dd>
							<p>As child of the [^metadata^] element. Repeatable.</p>
						</dd>

						<dt>Attributes:</dt>
						<dd>
							<ul class="nomark">
								<li>
									<p>
										<a href="#attrdef-dir">
											<code>dir</code>
										</a>
										<code>[optional]</code>
									</p>
								</li>
								<li>
									<p>
										<a href="#attrdef-id">
											<code>id</code>
										</a>
										<code>[optional]</code>
									</p>
								</li>
								<li>
									<p>
										<a href="#attrdef-meta-property">
											<code>property</code>
										</a>
										<code>[required]</code>
									</p>
								</li>
								<li>
									<p>
										<a href="#attrdef-refines">
											<code>refines</code>
										</a>
										<code>[optional]</code>
									</p>
								</li>
								<li>
									<p>
										<a href="#attrdef-scheme">
											<code>scheme</code>
										</a>
										<code>[optional]</code>
									</p>
								</li>
								<li>
									<p>
										<a href="#attrdef-xml-lang">
											<code>xml:lang</code>
										</a>
										<code>[optional]</code>
									</p>
								</li>
							</ul>
						</dd>

						<dt>Content Model:</dt>
						<dd>
							<p>Text</p>
						</dd>
					</dl>

					<p id="attrdef-meta-property">Each <code>meta</code> element defines a metadata expression. The
							<code>property</code> attribute takes a <a href="#sec-property-datatype"><var>property</var>
							data type value</a> that defines the statement made in the expression, and the text content
						of the element represents the assertion. (Refer to <a href="#sec-vocab-assoc"></a> for more
						information.)</p>

					<p id="meta-expr-types">This specification defines two types of metadata expressions that [=EPUB
						creators=] can define using the <code>meta</code> element:</p>

					<ul>
						<li id="primary-expression">A <em>primary expression</em> is one in which the expression defined
							in the <code>meta</code> element establishes some aspect of the [=EPUB publication=]. A
								<code>meta</code> element that omits a refines attribute defines a primary
							expression.</li>
						<li id="subexpression">A <em>subexpression</em> is one in which the expression defined in the
								<code>meta</code> element is associated with another expression or resource using the
								<code>refines</code> attribute to enhance its meaning. A subexpression might refine a
							media clip, for example, by expressing its duration, or refine a creator or contributor
							expression by defining the role of the person.</li>
					</ul>

					<p>EPUB creators MAY use subexpressions to refine the meaning of other subexpressions, thereby
						creating chains of information.</p>

					<p class="note">All the [[dcterms]] elements represent primary expressions, and permit refinement by
						meta element subexpressions.</p>

					<p>The <a href="#app-meta-property-vocab">Meta Properties Vocabulary</a> is the <a
							href="#sec-default-vocab">default vocabulary</a> for use with the <code>property</code>
						attribute.</p>

					<p>EPUB creators MAY add terms from other vocabularies as defined in <a href="#sec-vocab-assoc"
						></a>.</p>

					<aside class="example" title="Using properties with reserved prefixes">
						<p>For the full list of reserved prefixes, refer to <a href="#sec-reserved-prefixes"></a>.</p>

						<pre>&lt;metadata …>
   …
   &lt;meta
       property="dcterms:modified">
      2016-02-29T12:34:56Z
   &lt;/meta>
   &lt;meta
       property="rendition:layout">
      pre-paginated
   &lt;/meta>
   &lt;meta
       property="media:active-class">
      my-active-item
   &lt;/meta>
   …
&lt;/metadata></pre>
					</aside>

					<p id="attrdef-scheme">The <code>scheme</code> attribute identifies the system or scheme the EPUB
						creator obtained the element's [=value=] from. The value of the attribute MUST be a <a
							href="#sec-property-datatype"><var>property</var> data type value</a> that resolves to the
						resource that defines the scheme. The <code>scheme</code> attribute does not have a <a
							href="#sec-default-vocab">default vocabulary</a> (i.e., all values require a <a
							href="#property.ebnf.prefix">prefix</a>).</p>

					<aside class="example" title="Using values from a scheme">
						<p>In this example, the <code>scheme</code> attribute indicates that the [=value=] of the tag is
							from [[onix]] code list 5 (i.e., the value <code>15</code> indicates a 13 digit ISBN).</p>
						<pre>&lt;metadata &#8230;>
   &#8230;
   &lt;meta
       refines="#isbn-id"
       property="identifier-type"
       scheme="onix:codelist5">
      15
   &lt;/meta>
   &#8230;
&lt;/metadata></pre>
					</aside>
				</section>

				<section id="sec-metadata-last-modified">
					<h4>Last modified date</h4>

					<p id="last-modified-date">The <code>metadata</code> section MUST contain exactly one <dfn
							class="export" data-lt-no-plural=""><code>dcterms:modified</code></dfn> property [[dcterms]]
						containing the last modification date. The [=value=] of this property MUST be an [[xmlschema-2]]
						dateTime conformant date of the form: <code>CCYY-MM-DDThh:mm:ssZ</code></p>

					<p>[=EPUB creators=] MUST express the last modification date in Coordinated Universal Time (UTC) and
						MUST terminate it with the "<code>Z</code>" (Zulu) time zone indicator.</p>

					<aside class="example" title="Expressing a last modification date">
						<pre>&lt;metadata …>
   …
   &lt;meta
       property="dcterms:modified">
      2016-01-01T00:00:01Z
   &lt;/meta>
   …
&lt;/metadata></pre>
					</aside>

					<p>EPUB creators should update the last modified date whenever they make changes to the [=EPUB
						publication=].</p>

					<p>EPUB creators MAY specify additional modified properties in the [=package document=] metadata,
						but they MUST have a different subject (i.e., they require a <code>refines</code> attribute that
						references an element or resource).</p>

					<div class="note">
						<p>The requirements for the last modification date are to ensure compatibility with earlier
							versions of EPUB 3 that defined a <a
								href="https://www.w3.org/publishing/epub32/epub-packages.html#sec-metadata-elem-identifiers-pid"
								>release identifier</a> [[epubpackages-32]] for EPUB publications.</p>
					</div>
				</section>

				<section id="sec-link-elem">
					<h4>The <code>link</code> element</h4>

					<p>The <code>link</code> element associates resources with an [=EPUB publication=], such as metadata
						records.</p>

					<dl id="elemdef-opf-link" class="elemdef">
						<dt>Element Name:</dt>
						<dd>
							<p>
								<dfn class="export" data-lt-no-plural="" data-dfn-type="element"><code>link</code></dfn>
							</p>
						</dd>

						<dt>Usage:</dt>
						<dd>
							<p>As a child of [^metadata^]. Repeatable.</p>
						</dd>

						<dt>Attributes:</dt>
						<dd>
							<ul class="nomark">
								<li>
									<p>
										<a href="#attrdef-href">
											<code>href</code>
										</a>
										<code>[required]</code>
									</p>
								</li>
								<li>
									<p>
										<a href="#attrdef-hreflang">
											<code>hreflang</code>
										</a>
										<code>[optional]</code>
									</p>
								</li>
								<li>
									<p>
										<a href="#attrdef-id">
											<code>id</code>
										</a>
										<code>[optional]</code>
									</p>
								</li>
								<li>
									<p>
										<a href="#attrdef-link-media-type">
											<code>media-type</code>
										</a>
										<code>[conditionally required]</code>
									</p>
								</li>
								<li>
									<p>
										<a href="#attrdef-properties">
											<code>properties</code>
										</a>
										<code>[optional]</code>
									</p>
								</li>
								<li>
									<p>
										<a href="#attrdef-refines">
											<code>refines</code>
										</a>
										<code>[optional]</code>
									</p>
								</li>
								<li>
									<p>
										<a href="#attrdef-link-rel">
											<code>rel</code>
										</a>
										<code>[required]</code>
									</p>
								</li>
							</ul>
						</dd>

						<dt>Content Model:</dt>
						<dd>
							<p>Empty</p>
						</dd>
					</dl>

					<p>The [^metadata^] element MAY contain zero or more <code>link</code> elements, each of which
						identifies the location of a [=publication resource=] or a [=linked resource=] in its REQUIRED
							<code>href</code> attribute.</p>

					<p id="linked-res-manifest">Resources referenced from the <code>link</code> element are
						[=publication resources=] only when they are:</p>

					<ul>
						<li>
							<p>referenced from the [=EPUB spine | spine=]; or</p>
						</li>
						<li>
							<p>included or embedded in an [=EPUB content document=] (e.g., a metadata record serialized
								as RDFa [[?rdfa-core]] or as JSON-LD [[?json-ld11]] embedded in an [[html]] [^script^]
								element).</p>
						</li>
					</ul>

					<p>In all other cases (e.g., when linking to standalone [[?onix]] or [[?xmp]] records), the
						resources referenced are not [=publication resources=] (i.e., are not subject to <a
							href="#sec-core-media-types">core media type requirements</a>) and [=EPUB creators=] MUST
						NOT list them in the <a href="#sec-manifest-elem">manifest</a>.</p>

					<aside class="example" title="Reference to a record embedded in an XHTML content document">
						<p>In this example, the metadata record is embedded in a <code>script</code> element. Note that
							the media type of the embedded record (i.e., <code>application/ld+json</code>) is obtained
							from the <code>type</code> attribute on the <code>script</code> element; it is not specified
							in the <code>link</code> element.</p>

						<pre>Package document:

&lt;package …>
   &lt;metadata …>
      … 
      &lt;link rel="record"
          href="front.xhtml#meta-json"
          media-type="application/xhtml+xml"
          hreflang="en"/>
      …
   &lt;/metadata>
   …
&lt;/package>

XHTML:

&lt;html …>
   &lt;head>
      …
      &lt;script id="meta-json" type="application/ld+json">
          "@context" : "http://schema.org",
          "name" : "…",
         …
      &lt;/script>
      …
   &lt;/head>
   &lt;body>
      …
   &lt;/body>
&lt;/html></pre>
					</aside>

					<p id="linked-res-location">EPUB creators MAY locate linked resources within the [=EPUB container=]
						or externally, but should consider that [=reading systems=] are not required to retrieve
						resources outside the EPUB container.</p>

					<p id="attrdef-link-media-type">The <a href="#attrdef-media-type"><code>media-type</code>
							attribute</a> is OPTIONAL when a linked resource is located outside the EPUB container, as
						more than one media type could be served from the same URL [[url]]. EPUB creators MUST specify
						the attribute for all linked resources within the EPUB container.</p>

					<p id="attrdef-hreflang">The OPTIONAL <code>hreflang</code> attribute identifies the language of the
						linked resource. The value MUST be a <a data-cite="bcp47#section-2.2.9">well-formed language
							tag</a> [[bcp47]].</p>

					<p id="attrdef-link-rel">The REQUIRED <code>rel</code> attribute takes a space-separated list of <a
							href="#sec-property-datatype">property</a> values that establish the relationship the linked
						resource has with the EPUB publication.</p>

					<aside class="example" title="Linking to a MARC XML record">
						<pre>&lt;metadata …>
   …
   &lt;link
       rel="record"
       href="meta/9780000000001.xml" 
       media-type="application/marc"/>
   …
&lt;/metadata></pre>
					</aside>

					<p>The value of the <code>media-type</code> attribute is not always sufficient to identify the type
						of linked resource (e.g., many XML-based record formats use the media type
							"<code>application/xml</code>"). To aid reading systems in the identification of such
						generic resources, EPUB creators MAY specify a semantic identifier in the
							<code>properties</code> attribute.</p>

					<aside class="example" title="Identifying a record type via a property">
						<p>In this example, the <code>properties</code> attribute identifies the link is to a XMP
							record.</p>

						<pre>&lt;metadata …>
   …
   &lt;link rel="record"
       href="http://example.org/meta/12389347?format=xmp"
       media-type="application/xml"
       properties="xmp"/>
   …
&lt;/metadata></pre>
					</aside>

					<p>The <a href="#app-link-vocab">Metadata Link Vocabulary</a> is the <a href="#sec-default-vocab"
							>default vocabulary</a> for the <code>rel</code> and <code>properties</code> attributes.</p>

					<p>EPUB creators MAY add relationships and properties from other vocabularies as defined in <a
							href="#sec-vocab-assoc"></a>.</p>

					<aside class="example" title="Declaring a new link relationship">
						<p>In this example, the <code>link</code> element is used to associate an author's home page
							using the FOAF vocabulary. Note that as <code>foaf</code> is not a <a
								href="#sec-metadata-reserved-prefixes">predefined prefix</a>, it must be declared in the
								<a href="#attrdef-package-prefix">prefix attribute</a>.</p>

						<pre>&lt;package
    …
    prefix="foaf: http://xmlns.com/foaf/spec/">
   &lt;metadata …>
      … 
      &lt;link
          refines="#creator01"
          rel="foaf:homepage"
          href="http://example.org/book-info/12389347" />
      …
   &lt;/metadata> 
   …
&lt;/package>
</pre>
					</aside>

					<p id="sec-linked-records" data-tests="#pkg-linked-records">EPUB creators MAY provide one or more <a
							href="#record">linked metadata records</a> to enhance the information available to reading
						systems, but reading systems may ignore these records.</p>

					<p id="sec-linked-records-priority"
						data-tests="#pkg-linked-records_link-priority,#pkg-linked-records_link-order">When a reading
						system <a data-cite="epub-rs-33#sec-linked-records">processes linked records</a> [[epub-rs-33]],
						the document order of <code>link</code> elements is used to determine which has the highest
						priority in the case of conflicts (i.e., first in document order has the highest priority).</p>

					<aside class="example" title="Specifying metadata precedence">
						<p>In this example, the first remote record has the highest precedence, the local record has the
							next highest, and the metadata in the <code>metadata</code> element the lowest.</p>

						<pre>&lt;metadata …>
   &lt;link rel="record"
       href="http://example.org/onix/12389347"
       media-type="application/xml"
       properties="onix" />
    
   &lt;link rel="record"
       href="meta/meta.jsonld"
       media-type="application/ld+json" />
    
    &lt;dc:title>The Sound and The Fury&lt;/dc:title>
    &lt;dc:identifier>urn:isbn:9780101010101&lt;/dc:identifier>
    &lt;dc:language>en-us&lt;/dc:language>
    …
&lt;/metadata></pre>
					</aside>

					<div class="note">
						<p>Due to the variety of metadata record formats and serializations that an EPUB creator can
							link to an EPUB publication, and the complexity of comparing metadata properties between
							them, this specification does not require reading systems to process linked records.</p>
					</div>

					<p>In addition to full records, EPUB creators MAY also use the <code>link</code> element to identify
						individual metadata properties available in an alternative format.</p>

					<aside class="example" title="Link to a description">
						<p>In this example, the description of the EPUB publication is contained in an HTML
							document.</p>

						<pre>&lt;metadata …>
   …
   &lt;link
       rel="dcterms:description"
       href="description.html"
       media-type="text/html"/>
   …
&lt;/metadata></pre>
					</aside>
				</section>
			</section>

			<section id="sec-pkg-manifest">
				<h3>Manifest section</h3>

				<section id="sec-manifest-elem">
					<h4>The <code>manifest</code> element</h4>

					<p>The <code>manifest</code> element provides an exhaustive list of [=publication resources=] used
						in the rendering of the content.</p>

					<dl id="elemdef-opf-manifest" class="elemdef">
						<dt>Element Name:</dt>
						<dd>
							<p>
								<dfn class="export" data-lt-no-plural="" data-dfn-type="element"
									><code>manifest</code></dfn>
							</p>
						</dd>

						<dt>Usage:</dt>
						<dd>
							<p>REQUIRED second child of [^package^], following [^metadata^].</p>
						</dd>

						<dt>Attributes:</dt>
						<dd>
							<p>
								<a href="#attrdef-id">
									<code>id</code>
								</a>
								<code>[optional]</code>
							</p>
						</dd>

						<dt>Content Model:</dt>
						<dd>
							<p> [^item^] <code>[1 or more]</code>
							</p>
						</dd>
					</dl>

					<p id="confreq-rendition-manifest">[=EPUB creators=] MUST list all publication resources in the
							<code>manifest</code>, regardless of whether they are [=container resources=] or [=remote
						resources=]. Moreover, the <code>manifest</code> MUST only list publication resources.</p>

					<p>Note that the <code>manifest</code> is not self-referencing: EPUB creators MUST NOT specify an
							<code>item</code> element that refers to the [=package document=] itself.</p>

					<div class="note">
						<p>Failure to provide a complete manifest of resources may lead to rendering issues. [=Reading
							systems=] might not unzip such resources or could prevent access to them for security
							reasons.</p>
					</div>
				</section>

				<section id="sec-item-elem">
					<h4>The <code>item</code> element</h4>

					<p>The <code>item</code> element represents a [=publication resource=].</p>

					<dl id="elemdef-package-item" class="elemdef">
						<dt>Element Name:</dt>
						<dd>
							<p>
								<dfn class="export" data-lt-no-plural="" data-dfn-type="element"><code>item</code></dfn>
							</p>
						</dd>

						<dt>Usage:</dt>
						<dd>
							<p>As a child of [^manifest^]. Repeatable.</p>
						</dd>

						<dt>Attributes:</dt>
						<dd>
							<ul class="nomark">
								<li>
									<p>
										<a href="#attrdef-item-fallback">
											<code>fallback</code>
										</a>
										<code>[conditionally required]</code>
									</p>
								</li>
								<li>
									<p>
										<a href="#attrdef-href">
											<code>href</code>
										</a>
										<code>[required]</code>
									</p>
								</li>
								<li>
									<p>
										<a href="#attrdef-id">
											<code>id</code>
										</a>
										<code>[required]</code>
									</p>
								</li>
								<li>
									<p>
										<a href="#attrdef-item-media-overlay">
											<code>media-overlay</code>
										</a>
										<code>[optional]</code>
									</p>
								</li>
								<li>
									<p>
										<a href="#attrdef-item-media-type">
											<code>media-type</code>
										</a>
										<code>[required]</code>
									</p>
								</li>
								<li>
									<p>
										<a href="#sec-item-resource-properties">
											<code>properties</code>
										</a>
										<code>[optional]</code>
									</p>
								</li>
							</ul>
						</dd>
						<dt>Content Model:</dt>
						<dd>
							<p>Empty</p>
						</dd>
					</dl>

					<p>Each <code>item</code> element identifies a publication resource by the URL [[url]] in its
							<code>href</code> attribute. The value MUST be an <a data-lt="absolute-url string"
							>absolute-</a> or <a data-lt="path-relative-scheme-less-url string"
							>path-relative-scheme-less-URL</a> string [[url]]. [=EPUB creators=] MUST ensure each URL is
						unique within the <code>manifest</code> scope after <a href="#sec-parse-package-urls"
							>parsing</a>.</p>

					<p id="attrdef-item-media-type">The publication resource identified by an <code>item</code> element
						MUST conform to the applicable specification(s) as inferred from the MIME media type [[rfc2046]]
						provided in the <a href="#attrdef-media-type"><code>media-type</code> attribute</a>. For [=core
						media type resources=], EPUB creators MUST use the media type designated in <a
							href="#sec-core-media-types"></a>.</p>

					<p id="attrdef-item-fallback">The <code>fallback</code> attribute specifies the fallback for the
						referenced publication resource. The <code>fallback</code> attribute's <a data-cite="xml#idref"
							>IDREF</a> [[xml]] value MUST resolve to another <code>item</code> in the
							<code>manifest</code>.</p>

					<p>The fallback for one <code>item</code> MAY specify a fallback to another <code>item</code>, and
						so on, creating a chain of fallback options. Refer to <a href="#sec-manifest-fallbacks"></a> for
						additional requirements related to the use of fallback chains.</p>

					<p id="attrdef-item-media-overlay">The <code>media-overlay</code> attribute takes an IDREF [[xml]]
						that identifies the [=media overlay document=] for the resource described by this
							<code>item</code>. Refer to <a href="#sec-docs-package"></a> for more information.</p>

					<div class="note">
						<p>The order of <code>item</code> elements in the <code>manifest</code> is not significant. The
							[^spine^] element provides the presentation sequence of content documents.</p>
					</div>

					<section id="sec-item-resource-properties">
						<h6>Resource properties</h6>

						<p>The <a href="#attrdef-properties"><code>properties</code> attribute</a> provides information
							to [=reading systems=] about the content of a resource. This information enables discovery
							of key resources, such as the cover image and [=EPUB navigation document=]. It also allows
							reading systems to optimize rendering by indicating, for example, whether the resource
							contains embedded scripting, MathML, or SVG.</p>

						<p id="attrdef-item-properties">The <a href="#app-item-properties-vocab">Manifest Properties
								Vocabulary</a> is the <a href="#sec-default-vocab">default vocabulary</a> for the
								<code>properties</code> attribute.</p>

						<p>[=EPUB creators=] MUST set the following properties whenever a resource referenced by an
								<code>item</code> element matches their respective definitions:</p>

						<ul>
							<li><a href="#sec-mathml">mathml</a></li>
							<li><a href="#sec-remote-resources">remote-resources</a></li>
							<li><a href="#sec-scripted">scripted</a></li>
							<li><a href="#sec-svg">svg</a></li>
							<li><a href="#sec-switch">switch</a></li>
						</ul>

						<aside class="example" id="example-item-properties-scripted-mathml"
							title="Identifying a scripted content document with embedded MathML">
							<pre class="synopsis">&lt;item
    properties="scripted mathml"
    id="c2"
    href="c2.xhtml"
    media-type="application/xhtml+xml" /&gt;
</pre>
						</aside>

						<p>These properties do not apply recursively to content included into a resource (e.g., via the
							[[html]] [^iframe^] element). For example, if a non-scripted [=XHTML content document=]
							embeds a [=scripted content document=], only the embedded document's manifest
								<code>item</code>
							<code>properties</code> attribute will have the <code>scripted</code> value.</p>

						<p>EPUB creators MUST declare exactly one <code>item</code> as the EPUB navigation document
							using the <a href="#sec-nav-prop"><code>nav</code> property</a>.</p>

						<aside class="example" id="example-item-properties-nav"
							title="Identifying the EPUB navigation document">
							<pre class="synopsis">&lt;item
    properties="nav"
    id="c1"
    href="c1.xhtml"
    media-type="application/xhtml+xml" /&gt;</pre>
						</aside>

						<p>If an EPUB publication contains a cover image, it is recommended to set the <a
								href="#sec-cover-image"><code>cover-image</code> property</a>, but setting this property
							is OPTIONAL.</p>

						<aside class="example" id="example-item-properties-cover-image"
							title="Identifying the cover image">
							<pre class="synopsis">&lt;item
    properties="cover-image"
    id="ci"
    href="cover.svg"
    media-type="image/svg+xml" /&gt;</pre>
						</aside>

						<p>EPUB creators MAY add terms from other vocabularies as defined in <a href="#sec-vocab-assoc"
							></a>.</p>
					</section>

					<section id="sec-item-elem-examples">
						<h6>Examples</h6>

						<aside class="example" id="example-manifest-cmt"
							title="A manifest with only core media type resources">
							<pre>&lt;package …>
   …
   &lt;manifest>
      &lt;item
          id="nav" 
          href="nav.xhtml" 
          properties="nav"
          media-type="application/xhtml+xml"/>
      &lt;item
          id="intro" 
          href="intro.xhtml" 
          media-type="application/xhtml+xml"/>
      &lt;item
          id="c1" 
          href="chap1.xhtml" 
          media-type="application/xhtml+xml"/>
      &lt;item
          id="c1-answerkey" 
          href="chap1-answerkey.xhtml" 
          media-type="application/xhtml+xml"/>
      &lt;item
          id="c2" 
          href="chap2.xhtml" 
          media-type="application/xhtml+xml"/>
      &lt;item
          id="c2-answerkey" 
          href="chap2-answerkey.xhtml" 
          media-type="application/xhtml+xml"/>
      &lt;item
          id="c3" 
          href="chap3.xhtml" 
          media-type="application/xhtml+xml"/>
      &lt;item
          id="c3-answerkey" 
          href="chap3-answerkey.xhtml" 
          media-type="application/xhtml+xml"/>    
      &lt;item
          id="notes" 
          href="notes.xhtml" 
          media-type="application/xhtml+xml"/>
      &lt;item
          id="cover" 
          href="./images/cover.svg" 
          properties="cover-image"
          media-type="image/svg+xml"/>
      &lt;item
          id="f1" 
          href="./images/fig1.jpg" 
          media-type="image/jpeg"/>
      &lt;item
          id="f2" 
          href="./images/fig2.jpg" 
          media-type="image/jpeg"/>
      &lt;item
          id="css" 
          href="./style/book.css" 
          media-type="text/css"/>   
   &lt;/manifest>
   …
&lt;/package></pre>
						</aside>

						<aside class="example" id="example-manifest-flbk"
							title="Foreign content document in spine with fallback">
							<p>The following example shows the [=manifest fallback chain=] allowing a [=foreign content
								document=] (JPEG) to be listed in the spine with fallback to an SVG content
								document.</p>

							<pre>&lt;package …>
   …
   &lt;manifest>
      …
      &lt;item
          id="page-001"
          href="images/page-001.jpg"
          media-type="image/jpeg"
          fallback="page-001-svg"/>

      &lt;item
          id="page-001-svg"
          href="images/page-001.svg"
          media-type="image/svg+xml"/>
      … 
      …
   &lt;/manifest>
   &lt;spine>
      …
      &lt;itemref idref="page-001"/>
      …
   &lt;/spine>
&lt;/package></pre>
						</aside>

						<aside class="example"
							title="Embedded core media type resource with Link to View as top-level content document">
							<p>The following example shows a JPEG embedded in an [=EPUB content document=] (via the
									<code>img</code> tag) with a hyperlink that allows it to open as a separate page
								(e.g., for easier zooming). Although embedding the image using the <code>img</code> tag
								does not require it to be listed in the [=EPUB spine | spine=] or have a fallback,
								adding the hyperlink causes the document to open as a [=top-level content document=]. As
								its use in the spine makes it a [=foreign content document=], the [=EPUB creator=] must
								include a fallback to an EPUB content document.</p>

							<pre>XHTML:
&lt;html …>
   …
   &lt;body>
      …
      &lt;img
          src="images/infographic.jpg"
          alt="…"/>
      &lt;a
          href="images/infographic.jpg">
         Expand Image
      &lt;/a>
      …
   &lt;/body>
&lt;/html>

Package document:
&lt;package …>
   …
   &lt;manifest>
      …
      &lt;item
          id="img01"
          href="images/infographic.jpg"
          media-type="image/jpeg"
          fallback="infographic-svg"/>

      &lt;item
          id="infographic-svg"
          href="images/infographic.svg"
          media-type="image/svg+xml"/>
      …
   &lt;/manifest>
   &lt;spine>
      …
      &lt;itemref
          idref="img01"
          properties="layout-pre-paginated"
          linear="no"/>
      …
   &lt;/spine>
&lt;/package></pre>
						</aside>

						<aside class="example" title="Link to View foreign resource as top-level content document">
							<p>The following example shows a link to the raw CSV data file. As the data will open in the
								[=reading system=] as a [=top-level content document=], the [=EPUB creator=] must list
								it in the spine. As its use in the spine makes it a [=foreign content document=], the
								EPUB creator must also provide a fallback to an [=EPUB content document=]. Because there
								is no guarantee users will be able to access the data in its raw form, instructions on
								how to extract the file from the [=EPUB container=] are also provided.</p>

							<pre>XHTML:
&lt;html …>
   …
   &lt;body>
      …
      &lt;p>
         &lt;a href="../data/raw.csv">
            [Open the raw CSV data for this project.]
         &lt;/a>
      &lt;/p>
      &lt;p class="small">To extract the data file
         from this publication, unzip the EPUB file.
         The data is located in the
      	&lt;code>/EPUB/data/raw.csv&lt;/code> file.
      &lt;/p>
      …
   &lt;/body>
&lt;/html>

Package document:
&lt;package …>
   …
   &lt;manifest>
      …
      &lt;item
          id="data01"
          href="data/raw.csv"
          media-type="text/csv"
          fallback="data-html"/>

      &lt;item
          id="data-html"
          href="xhtml/data-table.html"
          media-type="application/xhtml+xml"/>
      …
   &lt;/manifest>
   &lt;spine>
      …
      &lt;itemref
          idref="data01"
          linear="no"/>
      …
   &lt;/spine>
&lt;/package></pre>
						</aside>

						<aside class="example" title="Remote resources that are publication resources">
							<p>The following example shows a reference to a remote audio file. Because the
									<code>audio</code> element embeds the audio in its [=EPUB content document=], the
								file is considered a [=publication resource=]. The [=EPUB creator=] therefore must list
								the audio file in the manifest and indicate that its host EPUB content document contains
								a [=remote resource=].</p>

							<pre>XHTML:
&lt;html …>
   …
   &lt;body>
      …
      &lt;audio
          src="http://www.example.com/book/audio/ch01.mp4"
          controls="controls"/>
      …
   &lt;/body>
&lt;/html>

Package document:
&lt;package …>
   …
   &lt;manifest>
      …
      &lt;item
          id="audio01"
          href="http://www.example.com/book/audio/ch01.mp4"
          media-type="audio/mp4"/>
   
      &lt;item
          id="c01"
          href="XHTML/chapter001.xhtml"
          media-type="application/xhtml+xml"
          properties="remote-resources"/>
      …
   &lt;/manifest>
   …
&lt;/package></pre>
						</aside>

						<aside class="example" title="External Resources that are not publication resources">
							<p>The following example shows a hyperlink to an audio file hosted on the web. [=Reading
								systems=] will open such external content in a new browser window; the audio file is not
								rendered within the publication. In this case, the [=EPUB creator=] does not list the
								file in the manifest because it is not a [=publication resource=].</p>

							<pre>XHTML:
&lt;html …>
   …
   &lt;body>
      …
      &lt;a
          href="http://www.example.com/book/audio/ch01.mp4">
         Listen to audio
      &lt;/a>
      …
   &lt;/body>
&lt;/html>

Manifest:
No Entry</pre>
						</aside>
					</section>
				</section>

				<section id="sec-opf-bindings">
					<h4>The <code>bindings</code> element (deprecated)</h4>

					<p>The <code>bindings</code> element defines a set of custom handlers for media types not supported
						by this specification.</p>

					<p>Use of the element is <a href="#deprecated">deprecated</a>.</p>

					<p>Refer to the <a
							href="https://idpf.org/epub/301/spec/epub-publications-20140626.html#sec-bindings-elem"
								><code>bindings</code> element definition</a> in [[epubpublications-301]] for more
						information.</p>
				</section>
			</section>

			<section id="sec-pkg-spine">
				<h3>Spine section</h3>

				<section id="sec-spine-elem">
					<h4>The <code>spine</code> element</h4>

					<p>The <code>spine</code> element defines an ordered list of <a href="#sec-itemref-elem">manifest
								<code>item</code> references</a> that represent the default reading order.</p>

					<dl id="elemdef-opf-spine" class="elemdef">
						<dt>Element Name:</dt>
						<dd>
							<p>
								<dfn class="export" data-lt-no-plural="" data-dfn-type="element"
									><code>spine</code></dfn>
							</p>
						</dd>

						<dt>Usage:</dt>
						<dd>
							<p>REQUIRED third child of [^package^], following [^manifest^].</p>
						</dd>

						<dt>Attributes:</dt>
						<dd>
							<ul class="nomark">
								<li>
									<p>
										<a href="#attrdef-id">
											<code>id</code>
										</a>
										<code>[optional]</code>
									</p>
								</li>
								<li>
									<p>
										<a href="#attrdef-spine-page-progression-direction">
											<code>page-progression-direction</code>
										</a>
										<code>[optional]</code>
									</p>
								</li>
								<li>
									<p>
										<a href="#sec-opf2-ncx">
											<code>toc</code>
										</a>
										<code>[optional]</code>
										<a href="#sec-pkg-legacy-intro" class="legacy">(legacy)</a>
									</p>
								</li>
							</ul>
						</dd>

						<dt>Content Model:</dt>
						<dd>
							<p> [^itemref^] <code>[1 or more]</code>
							</p>
						</dd>
					</dl>

					<p id="confreq-pub-resource">The <code>spine</code> MUST specify at least one [=EPUB content
						document=] or [=foreign content document=].</p>

					<p id="spine-inclusion-req">[=EPUB creators=] MUST list in the <code>spine</code> all EPUB and
						foreign content documents that are hyperlinked to from publication resources in the
							<code>spine</code>, where hyperlinking encompasses any linking mechanism that requires the
						user to navigate away from the current resource. Common hyperlinking mechanisms include the
						[^a/href^] attribute of the [[html]] [^a^] and [^area^] elements and scripted links (e.g., using
						DOM Events and/or form elements). The requirement to list hyperlinked resources applies
						recursively (i.e., EPUB creators must list all EPUB and foreign content documents hyperlinked to
						from hyperlinked documents, and so on.).</p>

					<p>EPUB creators also MUST list in the <code>spine</code> all EPUB and foreign content documents
						hyperlinked to from the [=EPUB navigation document=], regardless of whether EPUB creators
						include the EPUB navigation document in the <code>spine</code>.</p>

					<div class="note">
						<p>As hyperlinks to resources outside the EPUB container are not [=publication resources=], they
							are not subject to the requirement to include in the spine (e.g., web pages and web-hosted
							resources).</p>

						<p>Publication resources used in the rendering of spine items (e.g., referenced from [[html]]
							[=embedded content=]) similarly do not have to be included in the spine.</p>
					</div>

					<p id="attrdef-spine-page-progression-direction">The <code>page-progression-direction</code>
						attribute sets the global direction in which the content flows. Allowed values are
							<code>ltr</code> (left-to-right), <code>rtl</code> (right-to-left) and <code>default</code>.
						When EPUB creators specify the <code>default</code> value, they are expressing no preference and
						the [=reading system=] can choose the rendering direction.</p>

					<p>Although the <code>page-progression-direction</code> attribute sets the global flow direction,
						individual EPUB content documents and parts of EPUB content documents MAY override this setting
						(e.g., via the <code>writing-mode</code> CSS property). Reading systems may also provide
						mechanisms to override the default direction (e.g., buttons or settings that allow the
						application of alternate style sheets).</p>

					<p>The <a href="#sec-pkg-legacy-intro">legacy</a>
						<code>toc</code> attribute takes an <a data-cite="xml#idref">IDREF</a> [[xml]] that identifies
						the manifest item that represents the <a href="#sec-opf2-ncx">NCX</a>.</p>
				</section>

				<section id="sec-itemref-elem">
					<h4>The <code>itemref</code> element</h4>

					<p>The <code>itemref</code> element identifies an [=EPUB content document=] or [=foreign content
						document=] in the default reading order.</p>

					<dl id="elemdef-spine-itemref" class="elemdef">
						<dt>Element Name:</dt>
						<dd>
							<p>
								<dfn class="export" data-lt-no-plural="" data-dfn-type="element"
									><code>itemref</code></dfn>
							</p>
						</dd>

						<dt>Usage:</dt>
						<dd>
							<p>As a child of [^spine^]. Repeatable.</p>
						</dd>

						<dt>Attributes:</dt>
						<dd>
							<ul class="nomark">
								<li>
									<p>
										<a href="#attrdef-id">
											<code>id</code>
										</a>
										<code>[optional]</code>
									</p>
								</li>
								<li>
									<p>
										<a href="#attrdef-itemref-idref">
											<code>idref</code>
										</a>
										<code>[required]</code>
									</p>
								</li>
								<li>
									<p>
										<a href="#attrdef-itemref-linear">
											<code>linear</code>
										</a>
										<code>[optional]</code>
									</p>
								</li>
								<li>
									<p>
										<a href="#attrdef-properties">
											<code>properties</code>
										</a>
										<code>[optional]</code>
									</p>
								</li>
							</ul>
						</dd>

						<dt>Content Model:</dt>
						<dd>
							<p>Empty</p>
						</dd>
					</dl>

					<p id="attrdef-itemref-idref">Each <code>itemref</code> element MUST reference the <a
							data-cite="xml#id">ID</a> [[xml]] of an [^item^] in the [=EPUB manifest | manifest=] via the
							<a data-cite="xml#idref">IDREF</a> [[xml]] in its <code>idref</code> attribute.
							<code>item</code> element IDs MUST NOT be referenced more than once. </p>

					<p id="confreq-spine-itemtypes">Each referenced manifest <code>item</code> MUST be either a) an
						[=EPUB content document=] or b) a [=foreign content document=] that includes an EPUB content
						document in its [=manifest fallback chain=].</p>

					<div class="note">
						<p>Although [=EPUB publications=] <a href="#confreq-nav">require an EPUB navigation
							document</a>, it is not mandatory to include it in the [=EPUB spine | spine=].</p>
					</div>

					<p id="attrdef-itemref-linear">The <code>linear</code> attribute indicates whether the referenced
							<code>item</code> contains content that contributes to the primary reading order and that
						[=reading systems=] must read sequentially ("<code>yes</code>"), or auxiliary content that
						enhances or augments the primary content that reading systems can access out of sequence
							("<code>no</code>"). Examples of auxiliary content include notes, descriptions, and answer
						keys.</p>

					<p>The <code>linear</code> attribute allows reading systems to distinguish content that a user
						should access as part of the default reading order from supplementary content which a reading
						system might, for example, present in a popup window or omit from an aural rendering.</p>

					<p>Specifying that content is non-linear does not require reading systems to present it in a
						specific way, however; it is only a hint to the purpose. Reading systems may present non-linear
						content where it occurs in the spine, for example, or may skip it until users reach the end of
						the spine.</p>

					<div class="note">
						<p>[=EPUB creators=] should list non-linear content at the end of the spine except when it makes
							sense for users to encounter it between linear spine items.</p>
					</div>

					<p id="linear-itemrefs">A linear <code>itemref</code> element is one whose <code>linear</code>
						attribute value is explicitly set to "<code>yes</code>" or that omits the attribute — reading
						systems will assume the value "<code>yes</code>" for <code>itemref</code> elements without the
						attribute. The spine MUST contain at least one linear <code>itemref</code> element.</p>

					<p id="confreq-spine-nonlinear" data-tests="#pkg-spine-nonlinear">EPUB creators MUST provide a means
						of accessing all non-linear content (e.g., hyperlinks in the content or from the <a
							href="#sec-nav">EPUB navigation document</a>).</p>

					<p id="attrdef-itemref-properties">The <a href="#app-itemref-properties-vocab">Spine Properties
							Vocabulary</a> is the <a href="#sec-default-vocab">default vocabulary</a> for the
							<code>properties</code> attribute.</p>

					<p>EPUB creators MAY add terms from other vocabularies as defined in <a href="#sec-vocab-assoc"
						></a>.</p>

					<aside class="example" title="A basic spine">
						<p>In this example, the spine entries correspond to <a href="#example-manifest-cmt">the manifest
								example above</a>.</p>

						<pre>&lt;spine
    page-progression-direction="ltr">
   &lt;itemref
       idref="intro"/>
   &lt;itemref
       idref="c1"/>
   &lt;itemref
       idref="c1-answerkey"
       linear="no"/>
   &lt;itemref
       idref="c2"/>
   &lt;itemref
       idref="c2-answerkey"
       linear="no"/>
   &lt;itemref
       idref="c3"/>
   &lt;itemref
       idref="c3-answerkey"
       linear="no"/>
   &lt;itemref
       idref="notes"
       linear="no"/>
&lt;/spine>
</pre>
					</aside>
				</section>
			</section>

			<section id="sec-pkg-collections">
				<h3>Collections</h3>

				<section id="sec-collection-elem">
					<h4>The <code>collection</code> element</h4>

					<p>The <code>collection</code> element defines a related group of resources.</p>

					<dl id="elemdef-collection" class="elemdef">
						<dt>Element Name:</dt>
						<dd>
							<p>
								<dfn class="export" data-lt-no-plural="" data-dfn-type="element"
									><code>collection</code></dfn>
							</p>
						</dd>

						<dt>Usage:</dt>
						<dd>
							<p>OPTIONAL sixth element of <code>package</code>. Repeatable.</p>
						</dd>

						<dt>Attributes:</dt>
						<dd>
							<ul class="nomark">
								<li>
									<p>
										<a href="#attrdef-dir">
											<code>dir</code>
										</a>
										<code>[optional]</code>
									</p>
								</li>
								<li>
									<p>
										<a href="#attrdef-id">
											<code>id</code>
										</a>
										<code>[optional]</code>
									</p>
								</li>
								<li>
									<p>
										<a href="#attrdef-collection-role">
											<code>role</code>
										</a>
										<code>[required]</code>
									</p>
								</li>
								<li>
									<p>
										<a href="#attrdef-xml-lang">
											<code>xml:lang</code>
										</a>
										<code>[optional]</code>
									</p>
								</li>
							</ul>
						</dd>

						<dt>Content Model:</dt>
						<dd>
							<p>In this order: <code>metadata</code>
								<code>[0 or 1]</code>, ( [^collection^] <code>[1 or more]</code> or ( [^collection^]
									<code>[0 or more]</code>, <code>link</code>
								<code>[1 or more]</code> ))</p>
						</dd>
					</dl>

					<p>The <code>collection</code> element allows [=EPUB creators=] to assemble resources into logical
						groups for a variety of potential uses: enabling reassembly into a meaningful unit of content
						split across multiple [=EPUB content documents=] (e.g., an index split across multiple
						documents), identifying resources for specialized purposes (e.g., preview content), or
						collecting together resources that present additional information about the [=EPUB
						publication=].</p>

					<p id="attrdef-collection-role">EPUB creators MUST identify the role of each <code>collection</code>
						element in its <code>role</code> attribute, whose value MUST be one or more NMTOKENs
						[[xmlschema-2]] and/or [=absolute-URL-with-fragment strings=] [[url]].</p>

					<p>The requirements for authoring specialized collections are defined by their respective
						specifications.</p>

					<div class="note">
						<p>The former <abbr title="International Digital Publishing Forum">IDPF</abbr> EPUB 3 Working
							Group maintained both a <a href="https://idpf.org/epub/registries/roles/">registry of role
								extensions</a> and a list of <a href="https://idpf.org/epub/extensions/roles/">custom
								extension roles</a>. This Working Group no longer maintains these registries.</p>
					</div>

					<aside class="example" title="A multi-document index">
						<pre>&lt;collection role="index">
   &lt;link href="subjectIndex01.xhtml"/>
   &lt;link href="subjectIndex02.xhtml"/>
   &lt;link href="subjectIndex03.xhtml"/>
&lt;/collection></pre>
					</aside>
				</section>

				<section id="sec-defining-collection-types">
					<h4>Defining collection types (deprecated)</h4>

					<p>The creation of new <code>collection</code> element roles is now <a href="#deprecated"
							>deprecated</a>.</p>

					<p>Refer to the <a
							href="https://www.w3.org/publishing/epub32/epub-packages.html#sec-collection-elem"
								><code>collection</code> element definition</a> in [[epubpackages-32]] for more
						information about the creation of specialized collections, including the requirements and
						restrictions on their use.</p>
				</section>
			</section>

			<section id="sec-pkg-legacy">
				<h3>Legacy features</h3>

				<section id="sec-pkg-legacy-intro">
					<h4>Introduction</h4>

					<p>The package document <strong>legacy</strong> features are retained from EPUB 2 only to allow
						[=EPUB creators=] to author content that can function, to some degree, in [=reading systems=]
						that only support EPUB 2 publications.</p>

					<p>These features were added primarily to address the overlap period as EPUB 3 reading systems were
						developed, as there was still a high probability at that time that users would be opening EPUB 3
						publications on EPUB 2 reading systems.</p>

					<p>As reading systems that only handle EPUB 2 publications are now rare, EPUB creators should
						consider the likelihood of their publications still being opened on these types of older devices
						before making the effort to add these legacy features.</p>
				</section>

				<section id="pkg-legacy-support">
					<h4>Support</h4>

					<p>[=EPUB creators=] MAY include the legacy features defined in this section for compatibility
						purposes with EPUB 2 reading systems.</p>

					<p>EPUB 3 reading systems will not use these features when presenting publications to users.</p>

					<div class="note">
						<p>[=EPUB conformance checkers=] should not alert EPUB creators about the presence of legacy
							features in an [=EPUB publication=], as their inclusion is valid for backwards
							compatibility. EPUB conformance checkers must alert EPUB creators if a legacy feature does
							not conform to its definition or otherwise breaks a usage requirement.</p>
					</div>
				</section>

				<section id="sec-opf2-meta">
					<h4>The <code>meta</code> element</h4>

					<p>The <a href="https://idpf.org/epub/20/spec/OPF_2.0.1_draft.htm#Section2.2"><code>meta</code>
							element</a> [[opf-201]] provides a means of including generic metadata for EPUB 2 [=reading
						systems=].</p>

					<p>Refer to the <a href="https://idpf.org/epub/20/spec/OPF_2.0.1_draft.htm#Section2.2"
								><code>meta</code> element definition</a> in [[opf-201]] for more information.</p>

					<div class="note">
						<p>The EPUB 3 [^meta^] element, which uses different attributes and requires text content,
							provides metadata capabilities for EPUB 3 reading systems.</p>

						<p>The [[opf-201]] <code>meta</code> element also allows [=EPUB creators=] to identify a cover
							image for EPUB 2 reading systems. In EPUB 3, the cover image must be identified using the <a
								href="#sec-cover-image"><code>cover-image</code> property</a> on the manifest [^item^]
							for the image.</p>
					</div>
				</section>

				<section id="sec-opf2-guide">
					<h4>The <code>guide</code> element</h4>

					<p>The <a href="https://idpf.org/epub/20/spec/OPF_2.0.1_draft.htm#Section2.6"><code>guide</code>
							element</a> [[opf-201]] provides machine-processable navigation to key structures in EPUB 2
						[=reading systems=].</p>

					<p>Refer to the <a href="https://idpf.org/epub/20/spec/OPF_2.0.1_draft.htm#Section2.6"
								><code>guide</code> element definition</a> in [[opf-201]] for more information.</p>

					<div class="note">
						<p>The <a href="#sec-nav-landmarks">landmarks nav</a> in the [=EPUB navigation document=]
							provides this functionality in EPUB 3 reading systems.</p>
					</div>
				</section>

				<section id="sec-opf2-ncx">
					<h4>NCX</h4>

					<p>The <a href="https://idpf.org/epub/20/spec/OPF_2.0.1_draft.htm#Section2.4.1">NCX</a> [[opf-201]]
						provides a table of contents for EPUB 2 [=reading systems=].</p>

					<p>Refer to the <a href="https://idpf.org/epub/20/spec/OPF_2.0.1_draft.htm#Section2.4.1">NCX
							definition</a> in [[opf-201]] for more information.</p>

					<div class="note">
						<p>The <a href="#sec-nav">EPUB navigation document</a> replaces the NCX for EPUB 3 reading
							systems.</p>
					</div>
				</section>
			</section>
		</section>
		<section id="sec-contentdocs">
			<h2>EPUB content documents</h2>

			<section id="sec-xhtml">
				<h3>XHTML content documents</h3>

				<section id="sec-xhtml-intro" class="informative">
					<h4>Introduction</h4>

					<p>This section defines a profile of [[html]] for creating [=XHTML content documents=]. An instance
						of an XML document that conforms to this profile is a [=core media type resource=] and is
						referred to in this specification as an XHTML content document.</p>
				</section>

				<section id="sec-xhtml-req">
					<h4>XHTML requirements</h4>

					<p>An [=XHTML content document=]:</p>

					<ul class="conformance-list">
						<li>
							<p id="confreq-cd-html-docprops-syntax">MUST be an [[html]] document that conforms to the <a
									data-cite="html#the-xhtml-syntax">XML</a> syntax.</p>
						</li>
						<li>
							<p id="confreq-cd-html-docprops-html">MUST conform to the conformance criteria for all
								document constructs defined by [[html]] unless explicitly overridden in <a
									href="#sec-xhtml-deviations"></a>.</p>
						</li>
						<li>
							<p id="confreq-cd-html-docprops-schema">MAY include extensions to the [[html]] grammar as
								defined in <a href="#sec-xhtml-extensions"></a>, and MUST conform to all content
								conformance constraints defined therein.</p>
						</li>
					</ul>

					<p>Unless specified otherwise, XHTML content documents inherit all definitions of semantics,
						structure, and processing behaviors from the [[html]] specification.</p>

					<div class="note">
						<p>The recommendation that [=EPUB publications=] follow the accessibility requirements in
							[[epub-a11y-11]] applies to XHTML content documents. See <a href="#confreq-a11y"
								>Accessibility</a>.</p>
					</div>
				</section>

				<section id="sec-xhtml-extensions">
					<h4>HTML extensions</h4>

					<p>This section defines EPUB 3 [=XHTML content document=] extensions to the underlying [[html]]
						document model.</p>

					<div class="note">
						<p>Although [[html]] allows user agents to support <a data-cite="html#extensibility-2"
								>vendor-neutral extensions</a>, unless such extensions are listed in this section, they
							are not supported features of EPUB 3.</p>
					</div>

					<section id="sec-xhtml-structural-semantics">
						<h5>Structural semantics</h5>

						<p>[=EPUB creators=] MAY use the [^/epub:type^] attribute in [=XHTML content documents=] to
							express <a href="#sec-structural-semantics-intro">structural semantics</a>.</p>

						<p>The attribute MUST only be used on [=palpable content=] [[html]].</p>
					</section>

					<section id="sec-xhtml-rdfa">
						<h5>RDFa</h5>

						<p>The [[html-rdfa]] specification defines a set of attributes that [=EPUB creators=] MAY use in
							[=XHTML content documents=] to semantically enrich the content. The use of these attributes
							MUST conform to the requirements defined in [[html-rdfa]].</p>

						<p>The [[html-rdfa]] specification defines changes to the [[html]] content model when authors
							use RDFa attributes. This modified content model is valid in XHTML content documents.</p>

						<div class="note">
							<p>The listing of RDFa does not express a preference on the part of the Working Group, only
								that these attributes represent an extension of the HTML grammar. EPUB creators can also
								specify <a data-cite="html#microdata">microdata attributes</a> [[html]] and <a
									data-cite="json-ld11#">linked data</a> [[json-ld11]] in XHTML content documents as
								both are natively supported.</p>
						</div>
					</section>

					<section id="sec-xhtml-content-switch">
						<h5>Content switching (deprecated)</h5>

						<p>The <code>switch</code> element provides a simple mechanism through which [=EPUB creators=]
							can tailor the content displayed to users, one that is not dependent on the scripting
							capabilities of the [=EPUB reading system=].</p>

						<p>Use of the element is <a href="#deprecated">deprecated</a>.</p>

						<p>Refer to the <a
								href="https://idpf.org/epub/301/spec/epub-contentdocs-20140626.html#sec-xhtml-epub-switch"
									><code>switch</code> element definition</a> in [[epubcontentdocs-301]] for more
							information.</p>
					</section>

					<section id="sec-xhtml-epub-trigger">
						<h5>The <code>epub:trigger</code> element (deprecated)</h5>

						<p>The <code>trigger</code> element enables the creation of markup-defined user interfaces for
							controlling multimedia objects, such as audio and video playback, in both scripted and
							non-scripted contexts.</p>

						<p>Use of the element is <a href="#deprecated">deprecated</a>.</p>

						<p>Refer to the <a
								href="https://idpf.org/epub/301/spec/epub-contentdocs-20140626.html#sec-xhtml-epub-trigger"
									><code>epub:trigger</code> element definition</a> in [[epubcontentdocs-301]] for
							more information.</p>
					</section>

					<section id="sec-xhtml-custom-attributes">
						<h5>Custom attributes</h5>

						<p>[=XHTML content documents=] MAY contain custom attributes, which are <a
								data-cite="xml-names#NT-Prefix">prefixed</a> [[xml-names]] attributes whose namespace
							URL does not include either of the following strings in its [=domain=] [[url]]:</p>

						<ul>
							<li><code>w3.org</code></li>
							<li><code>idpf.org</code></li>
						</ul>

						<p>When using custom attributes, the content MUST remain consumable by a user without any
							information loss or other significant deterioration, regardless of the [=reading system=] it
							is rendered on.</p>

						<div class="note">
							<p>Custom attributes are usually defined in a reading system-specific manner and are not
								intended for use by other reading systems. This specification should be extended to
								provide extensions that multiple independent reading systems can use.</p>
						</div>
					</section>
				</section>

				<section id="sec-xhtml-deviations">
					<h4>HTML deviations and constraints</h4>

					<p>This section defines deviations from, and constraints on, the underlying [[html]] document model
						applicable to EPUB 3 [=XHTML content documents=].</p>

					<section id="sec-xhtml-mathml">
						<h5>Embedded MathML</h5>

						<p>[=XHTML content documents=] support embedded [[mathml3]]. Occurrences of MathML markup MUST
							conform to the constraints expressed in the MathML specification [[mathml3]], with the
							following additional restrictions:</p>

						<dl class="conformance-list">
							<dt id="math-pres">Presentation MathML</dt>
							<dd>
								<p id="confreq-mathml-pres">The <code>math</code> element MUST contain only <a
										data-cite="mathml3/chapter3.html#">Presentation MathML</a>, except within the
										<code>annotation-xml</code> element.</p>
							</dd>

							<dt id="math-cont">Content MathML</dt>
							<dd>
								<p id="confreq-mathml-annot-cont">[=EPUB creators=] MAY include <a
										data-cite="mathml3/chapter4.html#">Content MathML</a> within MathML markup in
									XHTML content documents, and, when present, MUST include it within an
										<code>annotation-xml</code> child element of a <code>semantics</code>
									element.</p>
								<p id="confreq-mathml-annot-cont-attrs">When EPUB creators include Content MathML per
									the previous condition, they MUST set the given <code>annotation-xml</code>
									element's <code>encoding</code> attribute to either of the functionally-equivalent
									values <code>MathML-Content</code> or <code>application/mathml-content+xml</code>,
									and the <code>name</code> attribute to <code>contentequiv</code>.</p>
							</dd>
						</dl>

						<p>This subset eases the implementation burden on [=reading systems=] and promotes
							accessibility, while retaining compatibility with [[html]] user agents.</p>

						<div class="note">
							<p>The <a href="#mathml"><code>mathml</code> property</a> of the [=EPUB manifest |
								manifest=] <code>item</code> element indicates that an XHTML content document contains
								embedded MathML.</p>
						</div>
					</section>

					<section id="sec-xhtml-svg">
						<h5>Embedded SVG</h5>

						<p>[=XHTML content documents=] support the embedding of <a
								href="https://www.w3.org/TR/SVG/conform.html#ConformingSVGXMLFragments">SVG document
								fragments</a> [[svg]] <em>by reference</em> (embedding via reference, for example, from
							an <code>img</code> or <code>object</code> element) and <em>by inclusion</em> (embedding via
							direct inclusion of the <code>svg</code> element in the XHTML content document).</p>

						<p>The content conformance constraints for SVG embedded in XHTML content documents are the same
							as defined for [=SVG content documents=] in <a href="#sec-svg-restrictions"></a>.</p>

						<div class="note">
							<p>The <a href="#svg"><code>svg</code> property</a> of the [=EPUB manifest | manifest=]
								[^item^] element indicates that an XHTML content document contains embedded SVG.</p>
						</div>
					</section>

					<section id="sec-xhtml-deviations-discouraged" class="informative">
						<h5>Discouraged constructs</h5>

						<section id="sec-xhtml-deviations-base">
							<h6>The <code>base</code> element</h6>

							<p id="confreq-html-vocab-base"> The [[html]] <a data-lt="base"><code>base</code>
								</a> element can be used to specify the [=document base URL=] for the purposes of
								parsing URLs. When using it in an [=EPUB publication=], the interpretation of the
									<code>base</code> element may inadvertently result in references to [=remote
								resources=]. It may also cause [=reading systems=] to misinterpret the location of
								hyperlinks (e.g., relative links to other documents in the publication might appear as
								links to a web site if the <code>base</code> element specifies an absolute URL). To
								avoid significant interoperability issues, [=EPUB creators=] should not use the
									<code>base</code> element. </p>
						</section>

						<section id="sec-xhtml-deviations-rp">
							<h6>The <code>rp</code> element</h6>

							<p id="confreq-html-vocab-rp">The [[html]] [^rp^] element is intended to provide a fallback
								for older [=reading systems=] that do not recognize ruby markup (i.e., a parenthesis
								display around <code>ruby</code> markup). As EPUB 3 reading systems are ruby-aware, and
								can provide fallbacks, [=EPUB creators=] should not use <code>rp</code> elements.</p>
						</section>

						<section id="sec-xhtml-deviations-embed">
							<h6>The <code>embed</code> element</h6>

							<p id="confreq-html-vocab-embed">Since the [[html]] <a data-lt="embed"><code>embed</code>
									element</a> element does not include intrinsic facilities to provide fallback
								content for [=reading systems=] that do not support scripting, [=EPUB creators=] are
								discouraged from using the element when the referenced resource includes scripting. The
								[[html]] [^object^] element is a better alternative, as it includes intrinsic fallback
								capabilities.</p>
						</section>
					</section>
				</section>
			</section>

			<section id="sec-svg">
				<h3>SVG content documents</h3>

				<div class="caution">
					<p>[=Reading systems=] may not support all the features of [[svg]] or support them across all
						platforms that reading systems run on. When utilizing such features, [=EPUB creators=] should
						consider the inherent risks on interoperability and document longevity.</p>
				</div>

				<section id="sec-svg-intro" class="informative">
					<h4>Introduction</h4>

					<p>The Scalable Vector Graphics (SVG) specification [[svg]] defines a format for representing
						final-form vector graphics and text.</p>

					<p>Although [=EPUB creators=] typically use <a href="#sec-xhtml">XHTML content documents</a> as the
						[=top-level content document | top-level=] document type, the use of [=SVG content documents=]
						is also permitted. EPUB creators will typically only need SVGs for certain special cases, such
						as when final-form page images are the only suitable representation of the content (e.g., for
						cover art or in the context of manga or comic books).</p>

					<p>This section defines a profile for [[svg]] documents. An instance of an XML document that
						conforms to this profile is a [=core media type resource=] and is referred to in this
						specification as an [=SVG content document=].</p>

					<div class="note">
						<p>This section defines conformance requirements for SVG content documents. Refer to <a
								href="#sec-xhtml-svg"></a> for the conformance requirements for SVG embedded in XHTML
							content documents.</p>
					</div>
				</section>

				<section id="sec-svg-req">
					<h4>SVG requirements</h4>

					<p>An [=SVG content document=]:</p>

					<ul class="conformance-list">
						<li>
							<p id="confreq-cd-svg-docprops-schema">MUST be a <a
									href="https://www.w3.org/TR/SVG/conform.html#ConformingSVGStandAloneFiles"
									>conforming SVG stand-alone file</a> [[svg]] and conform to all content conformance
								constraints expressed in <a href="#sec-svg-restrictions"></a>.</p>
						</li>
						<li>
							<p id="confreq-svg-structural-semantics">MAY include the [^/epub:type^] attribute for
								expressing <a href="#app-structural-semantics">structural semantics</a>. When specified,
								the attribute MUST only be included on <a
									href="https://www.w3.org/TR/SVG11/intro.html#TermStructuralElement">structural</a>,
									<a href="https://www.w3.org/TR/SVG11/intro.html#TermShapeElement">shape</a>, or <a
									href="https://www.w3.org/TR/SVG11/text.html">text</a> elements [[svg]].</p>
						</li>
						<li>
							<p id="confreq-svg-vocab-assoc">MAY include all applicable <a href="#sec-vocab-assoc"
									>vocabulary association mechanisms</a>.</p>
						</li>
					</ul>
					<div class="note">
						<p>The recommendation that [=EPUB publications=] follow the accessibility requirements in
							[[epub-a11y-11]] applies to SVG content documents. See <a href="#confreq-a11y"
								>Accessibility</a>.</p>
					</div>
				</section>

				<section id="sec-svg-restrictions">
					<h4>Restrictions on SVG</h4>

					<p>This specification restricts the content model of [=SVG content documents=] and <a
							href="#sec-xhtml-svg">SVG embedded in XHTML content documents</a> as follows:</p>

					<ul class="conformance-list">
						<li>
							<p id="confreq-svg-foreignObject">The [[svg]] <a
									href="https://www.w3.org/TR/SVG/embedded.html#ForeignObjectElement"
										><code>foreignObject</code></a> element:</p>
							<ul class="conformance-list">
								<li>
									<p id="confreq-svg-foreignObject-xhtml-content">MUST contain either [[html]] [=flow
										content=] or exactly one [[html]] <a data-cite="html#the-body-element"
												><code>body</code></a> element.</p>
									<p class="note">In the case of <a href="#sec-xhtml-svg">embedded SVGs</a>, a
											<code>body</code> element is not permitted per the <a data-cite="html#svg-0"
											>restrictions on SVG</a> defined in [[html]].</p>
								</li>
								<li>
									<p id="confreq-svg-foreignObject-xhtml-frag">MUST contain a valid document fragment
										that conforms to the XHTML content document model defined in <a
											href="#sec-xhtml-req"></a>.</p>
								</li>
							</ul>
						</li>
						<li>
							<p id="confreq-svg-title" data-cite="svg">If the [[svg]] [^title^] element contains
								marked-up text, the markup MUST contain only elements declared in the <a
									data-cite="infra#html-namespace">HTML namespace</a> [[infra]].</p>
						</li>
					</ul>
					<div class="note">
						<p>Although the [[svg]] <code>title</code> element allows markup elements, support for this
							feature is limited. [=EPUB creators=] are advised to use text-only titles for maximum
							interoperability.</p>
					</div>
				</section>
			</section>

			<section id="sec-common-resource-req">
				<h3>Common resource requirements</h3>

				<p>This section defines requirements for technologies usable in both [=XHTML content documents | XHTML=]
					and [=SVG content documents=].</p>

				<section id="sec-css">
					<h3>Cascading Style Sheets (CSS)</h3>

					<section id="sec-css-intro" class="informative">
						<h4>Introduction</h4>

						<p>CSS is an integral part of the Open Web Platform. Readers, publishers, and document authors
							expect CSS to "just work," as they expect HTML to just work.</p>

						<p>In the past, EPUB defined a profile of CSS that mandated support for certain properties and
							provided prefixed versions of numerous other properties. Although the CSS Working Group no
							longer recommends the use of prefixed properties, this specification maintains some prefixed
							properties to avoid breaking existing content. But with the minor exceptions defined in this
							section, EPUB defers to the W3C to define CSS.</p>

						<div class="note">
							<p>Keep in mind that some [=reading systems=] will not support all desired features of CSS.
								The following are known to be particularly problematic:</p>

							<ul>
								<li>
									<p>Reading system-induced pagination can interact poorly with style sheets as
										reading systems sometimes paginate using columns. This may result in incorrect
										values for viewport sizes. Fixed and absolute positioning are particularly
										problematic.</p>
								</li>
								<li>
									<p>Some types of screens will render animations and transitions poorly (e.g., those
										with high latency).</p>
								</li>
							</ul>
						</div>
					</section>

					<section id="sec-css-req">
						<h4>CSS requirements</h4>

						<p>A CSS style sheet:</p>

						<ul class="conformance-list">
							<li>
								<p id="confreq-css-props">MAY include any CSS properties, with the following
									exceptions:</p>
								<ul class="conformance-list">
									<li>
										<p id="confreq-css-props-exc-direction">It MUST NOT include the <a
												data-cite="css-writing-modes-3#direction"><code>direction</code>
												property</a> [[css-writing-modes-3]].</p>
									</li>
									<li>
										<p id="confreq-css-props-exc-unicode-bidi">It MUST NOT include the <a
												data-cite="css-writing-modes-3#unicode-bidi"><code>unicode-bidi</code>
												property</a> [[css-writing-modes-3]].</p>
									</li>
								</ul>
							</li>
							<li>
								<p id="confreq-css-prefixed">MAY include the prefixed properties defined in <a
										href="#sec-css-prefixed"></a>.</p>
							</li>
							<li>
								<p id="confreq-css-encoding">MUST be encoded in UTF-8 or UTF-16 [[unicode]], with UTF-8
									as the RECOMMENDED encoding.</p>
							</li>
						</ul>
						<div class="note">
							<p>This specification restricts the use of the <code>direction</code> and
									<code>unicode-bidi</code> properties because [=reading systems=] might not
								implement, or might switch off, CSS processing. [=EPUB creators=] must use the following
								format-specific methods when they need control over these aspects of the rendering:</p>

							<ul>
								<li>
									<p>the [^html-global/dir^] attribute [[html]] and <a
											href="https://www.w3.org/TR/SVG/text.html#DirectionProperty"
												><code>direction</code></a> attribute [[svg]] for inline base
										directionality.</p>
								</li>
								<li>
									<p>the [^bdo^] element with the [^html-global/dir^] attribute [[html]] and the <a
											href="https://www.w3.org/TR/SVG/styling.html#PresentationAttributes"
											>presentation attribute alternative</a> for <code>unicode-bidi</code>
										[[svg]] for bidirectionality.</p>
								</li>
							</ul>
						</div>
					</section>

					<section id="sec-css-prefixed">
						<h4>Prefixed properties</h4>

						<p>Earlier version of EPUB included prefixed CSS properties, as many CSS features related to
							world languages were not yet mature. To ensure backwards compatibility for content authored
							using these prefixes, they have been retained in this specification. Unless otherwise noted,
							prefixed properties and values behave exactly as their unprefixed equivalents as described
							in the appropriate CSS specification. The prefixed properties are documented in <a
								href="#css-prefixes"></a>. </p>

						<div class="caution">
							<p>[=EPUB creators=] should use unprefixed properties and [=reading systems=] should support
								current CSS specifications. This specification retains the widely used prefixed
								properties from [[epubcontentdocs-301]] but removes support for the less-used ones. EPUB
								creators should use CSS-native solutions for the removed properties whenever
								available.</p>

							<p>The Working Group recommends that EPUB creators currently using these prefixed properties
								move to unprefixed versions as soon as support allows, as the Working Group does not
								anticipate supporting them in the next major version of EPUB.</p>
						</div>
					</section>
				</section>

				<section id="sec-scripted-content">
					<h3>Scripting</h3>

					<section id="sec-scripted-support">
						<h4>Script inclusion</h4>

						<p>[=EPUB content documents=] MAY contain scripting using the facilities defined for this in the
							respective underlying specifications ([[html]] and [[svg]]). When an EPUB content document
							contains scripting, this specification refers to it as a [=scripted content document=]. This
							label also applies to [=XHTML content documents=] when they contain instances of [[html]]
							[=forms=].</p>

						<p>The <a href="#scripted"><code>scripted</code> property</a> of the [=EPUB manifest |
							manifest=] <code>item</code> element is used to indicate that an EPUB content document is a
							scripted content document.</p>

						<p>When an [[html]] <code>script</code> element contains a <a data-cite="html#data-block">data
								block</a> [[html]], it does not represent scripted content.</p>

						<div class="note">
							<p>[[svg]] does not define data blocks as of publication, but the same exclusion would apply
								if a future update adds the concept.</p>
						</div>

						<p>[=EPUB creators=] should note that [=reading systems=] are required to behave as though a
							unique <a data-cite="html#origin">origin</a> [[html]] has been assigned to each [=EPUB
							publication=]. In practice, this means that it is not possible for scripts to share data
							between EPUB publications.</p>

						<p>Which <a href="#sec-scripted-context">context</a> a script is used in also determines the
							rights and restrictions that a reading system places on it (refer to <a
								data-cite="epub-rs-33#sec-scripted-content">Scripting</a> [[?epub-rs-33]] for more
							information).</p>

						<div class="note">
							<p>Reading systems may render scripted content documents in a manner that disables other
								EPUB capabilities and/or provides a different rendering and user experience (e.g., by
								disabling pagination).</p>
						</div>
					</section>

					<section id="sec-scripted-context">
						<h4>Scripting contexts</h4>

						<p>EPUB 3 defines two contexts for script execution:</p>

						<ul>
							<li><a href="#sec-scripted-container-constrained">container constrained</a> &#8212; when the
								execution of a script occurs within an [[html]] [^iframe^] element; and</li>
							<li><a href="#sec-scripted-spine">spine level</a> &#8212; when the execution of a script
								occurs directly within a [=top-level content document=].</li>
						</ul>

						<div class="note">
							<p>Scripts may execute in other contexts, but [=reading system=] support for these contexts
								is optional. For example, a scripted SVG document may be referenced from an [[html]]
								[^object^] element.</p>
							<p>Refer to the <a data-cite="epub-rs-33#sec-scripted-content">processing of scripts</a>
								[[epub-rs-33]] for more information.</p>
						</div>

						<p>Whether [=EPUB creators=] embed the code directly in a <code>script</code> element or
							reference it via the element's <code>src</code> attribute makes no difference to its
							executing context.</p>

						<p>Which context EPUB creators use for their scripts affects both what actions the scripts can
							perform and the likelihood of support in reading systems, as described in the following
							subsections.</p>

						<div class="note">
							<p>Refer to <a href="#scripted-contexts-example"></a> for an example of the difference
								between the two contexts.</p>
						</div>

						<section id="sec-scripted-container-constrained">
							<h5>Container-constrained scripts</h5>

							<p>A <em>container-constrained script</em> is either of the following:</p>

							<ul>
								<li>
									<p>An instance of the [[html]] [^script^] element contained in an [=XHTML content
										document=] that is embedded in an XHTML content document using the [[html]]
										[^iframe^] element.</p>
								</li>
								<li>
									<p>An instance of the [[svg]] <a
											href="https://www.w3.org/TR/SVG/interact.html#ScriptElement"
												><code>script</code></a> element contained in an [=SVG content
										document=] that is embedded in a XHTML content document using the [[html]]
										[^iframe^] element.</p>
								</li>
							</ul>

							<p id="confreq-cd-scripted-container">A container-constrained script MUST NOT contain
								instructions for modifying the DOM of the [=EPUB content document=] that embeds it
								(i.e., the one that contains the <code>iframe</code> element). It also MUST NOT contain
								instructions for manipulating the size of its containing rectangle.</p>

							<p>[=EPUB creators=] should note that <a data-cite="epub-rs-33#sec-scripted-content">support
									for container-constrained scripting in reading systems</a> is only recommended in
								reflowable documents [[epub-rs-33]]. Furthermore, [=reading system=] support in
								[=fixed-layout documents=] is optional.</p>

							<p>EPUB creators should ensure container-constrained scripts degrade gracefully in reading
								systems without scripting support (see <a href="#sec-scripted-fallbacks"></a>).</p>

							<div class="note">
								<p>EPUB creators choosing to restrict the usage of scripting to the
									container-constrained model will ensure a more consistent user experience between
									scripted and non-scripted content (e.g., consistent pagination behavior).</p>
							</div>
						</section>

						<section id="sec-scripted-spine">
							<h5>Spine-level scripts</h5>

							<p>A <em>spine-level script</em> is an instance of the [[html]] [^script^] or [[svg]] <a
									href="https://www.w3.org/TR/SVG/interact.html#ScriptElement"><code>script</code></a>
								element contained in a [=top-level content document=].</p>

							<p>[=EPUB creators=] should note that support for spine-level scripting in [=reading
								systems=] is only recommended in <a
									data-cite="epub-rs-33#confreq-rs-scripted-fxl-support">fixed-layout documents</a>
								and <a data-cite="epub-rs-33#confreq-rs-scripted-scrolled">reflowable documents set to
									scroll</a> [[epub-rs-33]]. Furthermore, reading system support in all other contexts
								is optional.</p>

							<p id="confreq-cd-scripted-spine">[=Top-level content documents=] that include spine-level
								scripting SHOULD remain consumable by the user without any information loss or other
								significant deterioration when scripting is disabled or not available (e.g., by
								employing progressive enhancement techniques or <a href="#sec-scripted-fallbacks"
									>fallbacks</a>). Failing to account for non-scripted environments in top-level
								content documents can result in [=EPUB publications=] being unreadable.</p>
						</section>
					</section>

					<section id="sec-scripted-content-events" class="informative">
						<h4>Event model</h4>

						<p>[=EPUB creators=] should consider the wide variety of possible [=reading system=]
							implementations when adding scripting functionality to their [=EPUB publications=] (e.g.,
							not all devices have physical keyboards, and in many cases a soft keyboard is activated only
							for text input elements). Consequently, EPUB creators should not rely on keyboard events
							alone; they should always provide alternative ways to trigger a desired action.</p>
					</section>

					<section id="sec-scripted-a11y">
						<h4>Scripting accessibility</h4>

						<p id="confreq-cd-scripted-a11y">[=EPUB content documents=] that contain scripting SHOULD employ
							relevant [[wai-aria]] accessibility techniques to ensure that the content remains consumable
							by all users.</p>
					</section>

					<section id="sec-scripted-fallbacks">
						<h4 id="confreq-cd-scripted-flbk">Scripting fallbacks</h4>

						<p id="confreq-cd-scripted-fallback">[=EPUB content documents=] that contain scripting MAY
							provide fallbacks for such content, either by using intrinsic fallback mechanisms (such as
							those available for the [[html]] [^object^] and [^canvas^] elements) or, when an intrinsic
							fallback is not applicable, by using a <a href="#sec-manifest-fallbacks">manifest-level
								fallback</a>.</p>

						<p id="confreq-cd-scripted-foreign-resources">[=EPUB creators=] MUST ensure that scripts only
							generate <a href="#sec-core-media-types">core media type resources</a> or fragments
							thereof.</p>
					</section>
				</section>
			</section>
		</section>
		<section id="sec-nav">
			<h2>EPUB navigation document</h2>

			<section id="sec-nav-intro" class="informative">
				<h3>Introduction</h3>

				<p>The [=EPUB navigation document=] is a <a href="#confreq-nav">mandatory component</a> of an [=EPUB
					publication=]. It allows [=EPUB creators=] to include a human- and machine-readable global
					navigation layer, thereby ensuring increased usability and accessibility for the user.</p>

				<p>The EPUB navigation document is a special type of [=XHTML content document=] that defines the <a
						href="#sec-nav-toc">table of contents</a> for [=reading systems=]. It may also include other
					specialized navigation elements, such as a <a href="#sec-nav-pagelist">page list</a> and a list of
					key <a href="#sec-nav-landmarks">landmarks</a>. These navigation elements have <a
						href="#sec-nav-def-model">additional restrictions</a> on their content to facilitate their
					processing.</p>

				<p>The EPUB navigation document is not exclusively for machine processing, however. There are no
					restrictions on the structure or content of the EPUB navigation document outside of the specialized
					navigation elements (i.e., EPUB creators can mark the rest of the document up like any other XHTML
					content document). As a result, it can also be part of the linear reading order, avoiding the need
					for duplicate tables of contents. EPUB creators can hide navigation elements that are only for
					machine processing (e.g., the page list) with the <a href="#sec-nav-doc-use-spine"
							><code>hidden</code> attribute</a>.</p>

				<p>Note that reading systems may strip scripting, styling, and HTML formatting as they generate
					navigational interfaces from information found in the EPUB navigation document, and this may make
					the result difficult to read. If EPUB creators require such formatting and functionality, then they
					should also include the EPUB navigation document in the [=EPUB spine | spine=]. The use of
					progressive enhancement techniques for scripting and styling of the navigation document will help
					ensure the content will retain its integrity when rendered in a non-browser context.</p>
			</section>

			<section id="sec-nav-content-req">
				<h3>Navigation document requirements</h3>

				<p>A valid EPUB navigation document:</p>

				<ul class="conformance-list">
					<li>
						<p id="confreq-navdoc-xhtml">MUST conform to the content conformance constraints for [=XHTML
							content documents=] defined in <a href="#sec-xhtml-req"></a>;</p>
					</li>
					<li>
						<p id="confreq-navdoc-navs">MUST conform to the <code>nav</code> element constraints defined <a
								href="#sec-nav-def-model"></a>;</p>
					</li>
					<li>
						<p id="confreq-navdoc-toc">MUST include exactly one <code>toc nav</code> element as defined in
								<a href="#sec-nav-toc"></a>.</p>
					</li>
				</ul>
			</section>

			<section id="sec-nav-def-model">
				<h3>The <code>nav</code> element: restrictions</h3>

				<p>When a <code>nav</code> element carries the [^/epub:type^] attribute in an [=EPUB navigation
					document=], this specification restricts the content model of the element and its descendants as
					follows:</p>

				<dl class="elemdef">
					<dt>Content Model:</dt>
					<dd>
						<dl class="variablelist">
							<dt>[^nav^]</dt>
							<dd>
								<p>In this order:</p>
								<ul class="nomark">
									<li>
										<p>
											<a data-cite="html#the-h1,-h2,-h3,-h4,-h5,-and-h6-elements">
												<code>h1-h6</code>
											</a>
											<code>[0 or 1]</code>
										</p>
									</li>
									<li>
										<p> [^ol^] <code>[exactly 1]</code>
										</p>
									</li>
								</ul>
							</dd>

							<dt>[^ol^]</dt>
							<dd>
								<p>In this order:</p>
								<ul class="nomark">
									<li>
										<p> [^li^] <code>[1 or more]</code>
										</p>
									</li>
								</ul>
							</dd>

							<dt>[^li^]</dt>
							<dd>
								<p>In this order:</p>
								<ul class="nomark">
									<li>
										<p> ([^span^] or [^a^]) <code>[exactly 1]</code></p>
									</li>
									<li>
										<p> [^ol^] <code>[conditionally required]</code>
										</p>
									</li>
								</ul>
							</dd>

							<dt>[^span^] and [^a^]</dt>
							<dd>
								<p>In any order:</p>
								<ul class="nomark">
									<li>
										<p> [=phrasing content | HTML Phrasing content=] <code>[1 or more]</code>
										</p>
									</li>
								</ul>
							</dd>
						</dl>
						<p>Note that there are no restrictions on the attributes allowed on these elements.</p>
						<p>Refer the definition below for additional requirements.</p>
					</dd>
				</dl>

				<p>The following elaboration of the content model of the <code>nav</code> element explains the purpose
					and restrictions of the various elements:</p>

				<ul class="conformance-list">
					<li>
						<p id="confreq-nav-ol">The <code>ol</code> child of the <code>nav</code> element represents the
							primary level of content navigation.</p>
					</li>
					<li>
						<p id="confreq-nav-a">Each list item of the ordered list represents a heading, structure, or
							other item of interest. A child <code>a</code> element describes the target that the link
							points to, while a <code>span</code> element serves as a heading for breaking down lists
							into distinct groups (for example, an EPUB creator could segment a large list of
							illustrations into several lists, one for each chapter).</p>
					</li>
					<li>
						<p id="confreq-nav-a-cnt">The child <code>a</code> or <code>span</code> element MUST provide a
							non-zero-length text label after concatenation of all child content and application of white
							space normalization rules. When determining compliance with this requirement, the
							concatenated label MUST include text content contained in <code>title</code> or
								<code>alt</code> attributes for non-textual descendant elements.</p>
					</li>
					<li>
						<p id="confreq-nav-a-title">If an <code>a</code> or <code>span</code> element contains instances
							of [=embedded content | HTML embedded content=] [[html]] that do not provide intrinsic text
							alternatives, the element MUST also contain a <code>title</code> attribute with an alternate
							text rendering of the link label.</p>
					</li>
					<li>
						<p id="confreq-nav-a-href">The URL [[url]] reference provided in the <code>href</code> attribute
							of the <code>a</code> element:</p>
						<ul class="conformance-list">
							<li>
								<p id="confreq-nav-a-href-default">MUST, in the case of the <a href="#sec-nav-toc"
											><code>toc nav</code></a>, <a href="#sec-nav-landmarks"><code>landmarks
											nav</code></a> and <a href="#sec-nav-pagelist"><code>page-list
										nav</code></a>, resolve to a [=top-level content document=] or fragment
									therein.</p>
							</li>
							<li>
								<p id="confreq-nav-a-href-other">MAY, for all other <code>nav</code> types, also
									reference content outside the [=EPUB container=] (e.g., web-hosted resources).</p>
							</li>
						</ul>
					</li>
					<li>
						<p id="confreq-nav-a-nest">An <code>ol</code> (ordered list) element representing a subsidiary
							content level (e.g., all the subsection headings of a section) MAY follow an <code>a</code>
							element.</p>
					</li>
					<li>
						<p id="confreq-nav-span-nest">An <code>ol</code> (ordered list) element MUST follow a
								<code>span</code> element (<code>span</code> elements cannot occur in "leaf"
								<code>li</code> elements).</p>
					</li>
					<li>
						<p id="confreq-nav-sublist">Regardless of whether an <code>a</code> or <code>span</code> element
							precedes it, every sublist MUST adhere to the content requirements defined in this section
							for constructing the primary navigation list.</p>
					</li>
				</ul>
				<aside class="example" title="Basic patterns of a navigation element">
					<pre>&lt;nav epub:type="…">
   &lt;h1>…&lt;/h1>
   &lt;ol>
      &lt;li>
         &lt;a href="chap1.xhtml">
            A basic leaf node
         &lt;/a>
      &lt;/li>
      &lt;li>
         &lt;a href="chap2.xhtml">
            A linked heading
         &lt;/a>
         &lt;ol>
            …
         &lt;/ol>
      &lt;/li>
      &lt;li>
         &lt;span>An unlinked heading&lt;/span>
         &lt;ol>
            …
         &lt;/ol>
      &lt;/li>
      &lt;li>
         &lt;a href="appendix.xhtml">
            &lt;img src="app1.jpg" alt="An image-based heading"/>
         &lt;/a>
      &lt;/li>
   &lt;/ol>
&lt;/nav></pre>
				</aside>

				<div class="caution">
					<p>Although the headings and links in <code>nav</code> elements allow any [[html]] [=phrasing
						content=], app-based reading systems often only support simple text labels. Because these apps
						create their own navigation widgets that are not based on HTML rendering, they often cannot
						retain embedded images and multimedia, MathML, inline styling and other element- and
						attribute-based rendering instructions. EPUB creators should avoid using these types of elements
						where their absence may lead to usability issues.</p>
				</div>

				<p id="confreq-cd-nav-docprops-spine">As a conforming [=XHTML content document=], EPUB creators MAY
					include the EPUB navigation document in the [=EPUB spine | spine=].</p>

				<p id="confreq-nav-ol-style">In the context of this specification, the default display style of list
					items within <code>nav</code> elements is equivalent to the <a
						href="https://www.w3.org/TR/CSS2/generate.html#propdef-list-style"><code>list-style:</code>
						<code>none</code> property</a> [[csssnapshot]]. EPUB creators MAY specify alternative list
					styling using CSS for rendering of the document in the spine.</p>
			</section>

			<section id="sec-nav-def-types">
				<h3>The <code>nav</code> element: types</h3>

				<section id="sec-nav-def-types-intro" class="informative">
					<h4>Introduction</h4>

					<p>The <code>nav</code> elements defined in an [=EPUB navigation document=] are distinguished
						semantically by the value of their [^/epub:type^] attribute.</p>

					<p>This specification defines three types of navigation aid:</p>

					<dl class="variablelist">
						<dt>
							<a href="#sec-nav-toc">
								<code>toc</code>
							</a>
						</dt>
						<dd>
							<p>Identifies the <code>nav</code> element that contains the table of contents. The
									<code>toc nav</code> is the only navigation aid that [=EPUB creators=] must include
								in the EPUB navigation document.</p>
						</dd>

						<dt>
							<a href="#sec-nav-pagelist">
								<code>page-list</code>
							</a>
						</dt>
						<dd>
							<p>Identifies the <code>nav</code> element that contains a list of pages for a print or
								other statically paginated source.</p>
						</dd>

						<dt>
							<a href="#sec-nav-landmarks">
								<code>landmarks</code>
							</a>
						</dt>
						<dd>
							<p>Identifies the <code>nav</code> element that contains a list of points of interest.</p>
						</dd>
					</dl>

					<p>An EPUB navigation document may contain at most one navigation aid for each of these types.</p>

					<p>The EPUB navigation document may include additional navigation types. See <a
							href="#sec-nav-def-types-other"></a> for more information.</p>
				</section>

				<section id="sec-nav-toc">
					<h4>The <code>toc nav</code> element </h4>

					<p>The <code>toc nav</code> element defines the primary navigational hierarchy. It conceptually
						corresponds to a table of contents in a printed work (i.e., it provides navigation to the major
						structural sections of the publication).</p>

					<p>[=EPUB creators=] SHOULD order the references in the <code>toc nav</code> element such that they
						reflect both:</p>

					<ul>
						<li>
							<p>the order of the <a href="#confreq-nav-a-href">referenced EPUB content documents</a> in
								the [=EPUB spine | spine=]; and</p>
						</li>
						<li>
							<p>the order of the targeted elements within their respective [=EPUB content
								documents=].</p>
						</li>
					</ul>
				</section>

				<section id="sec-nav-pagelist">
					<h4>The <code>page-list nav</code> element </h4>

					<p>The <code>page-list</code> element provides navigation to static page boundaries in the content.
						These boundaries may correspond to a statically paginated source such as print or may be defined
						exclusively for the [=EPUB publication=].</p>

					<p>The <code>page-list nav</code> element is OPTIONAL in [=EPUB navigation documents=] and MUST NOT
						occur more than once.</p>

					<p>The <code>page-list nav</code> element SHOULD contain only a single <code>ol</code> descendant
						(i.e., no nested sublists).</p>

					<p>[=EPUB creators=] MAY identify the destinations of the <code>page-list</code> references in their
						respective [=EPUB content documents=] using the <a data-cite="epub-ssv-11/#pagebreak"
								><code>pagebreak</code> term</a> [[epub-ssv-11]].</p>
				</section>

				<section id="sec-nav-landmarks">
					<h4>The <code>landmarks nav</code> element</h4>

					<p>The <code>landmarks nav</code> element identifies fundamental structural components in the
						content to enable [=reading systems=] to provide the user efficient access to them (e.g.,
						through a dedicated button in the user interface).</p>

					<p>The <code>landmarks nav</code> element is OPTIONAL in [=EPUB navigation documents=] and MUST NOT
						occur more than once.</p>

					<p>The <code>landmarks nav</code> element SHOULD contain only a single <code>ol</code> descendant
						(i.e., no nested sublists).</p>

					<p>The [^/epub:type^] attribute is REQUIRED on <code>a</code> element descendants of the
							<code>landmarks nav</code> element. The structural semantics of each link target within the
							<code>landmarks nav</code> element is determined by the value of this attribute.</p>

					<aside class="example" title="A basic landmarks nav">
						<p>In this example, the <code>epub:type</code> attribute value are drawn from structural
							semantics drawn from [[epub-ssv-11]].</p>

						<pre>&lt;nav epub:type="landmarks">
   &lt;h2>Guide&lt;/h2>
   &lt;ol>
       &lt;li>
          &lt;a epub:type="toc"
             href="#toc">
            Table of Contents
          &lt;/a>
       &lt;/li>
       &lt;li>
          &lt;a epub:type="loi"
             href="content.html#loi">
            List of Illustrations
          &lt;/a>
       &lt;/li>
       &lt;li>
          &lt;a epub:type="bodymatter"
             href="content.html#bodymatter">
            Start of Content
          &lt;/a>
       &lt;/li>
   &lt;/ol>
&lt;/nav></pre>
					</aside>

					<p>The <code>landmarks nav</code> MUST NOT include multiple entries with the same
							<code>epub:type</code> value that reference the same resource, or fragment thereof.</p>

					<p>[=EPUB creators=] should limit the number of items they define in the <code>landmarks nav</code>
						to only items that a reading system is likely to use in its user interface. The element is not
						meant to repeat the table of contents.</p>

					<p>The following landmarks are recommended to include when available:</p>

					<ul>
						<li><a data-cite="epub-ssv-11#bodymatter"><code>bodymatter</code></a> [[?epub-ssv-11]] &#8212;
							Reading systems often use this landmark to automatically jump users past the front matter
							when they begin reading.</li>
						<li><a data-cite="epub-ssv-11#toc-1"><code>toc</code></a> [[?epub-ssv-11]] &#8212; If the table
							of contents is available in the spine, reading systems may use this landmark to take users
							to the document containing it.</li>
					</ul>

					<p>Other possibilities for inclusion in the <code>landmarks nav</code> are key reference sections
						such as indexes and glossaries.</p>

					<p>Although the <code>landmarks nav</code> is intended for reading system use, EPUB creators should
						still ensure that the labels for the <code>landmarks nav</code> are human readable. Reading
						systems may expose the links directly to users.</p>
				</section>

				<section id="sec-nav-def-types-other">
					<h4>Other <code>nav</code> elements</h4>

					<p>[=EPUB navigation documents=] MAY contain one or more <code>nav</code> elements in addition to
						the <code>toc</code>, <code>page-list</code>, and <code>landmarks nav</code> elements defined in
						the preceding sections. If these <code>nav</code> elements are intended for [=reading system=]
						processing, they MUST have an [^/epub:type^] attribute and are subject to the content model
						restrictions defined in <a href="#sec-nav-def-model"></a>.</p>

					<p>This specification imposes no restrictions on the semantics of any additional <code>nav</code>
						elements: they MAY represent navigational semantics for any information domain, and they MAY
						contain link targets with homogeneous or heterogeneous semantics.</p>

					<aside class="example" title="Adding a custom navigation element">
						<p>In this example, the <code>lot</code> semantic indicates that the EPUB creator is adding a
							"list of tables" navigation element.</p>

						<pre>&lt;nav
    epub:type="lot"
    aria-labelledby="lot">
   &lt;h2 id="lot">List of tables&lt;/h2>
   &lt;ol>
      &lt;li>
         &lt;span>Tables in Chapter 1&lt;/span>
         &lt;ol>
            &lt;li>
               &lt;a href="chap1.xhtml#table-1.1">
                  Table 1.1
               &lt;/a>
            &lt;/li>
            &lt;li>
               &lt;a href="chap1.xhtml#table-1.2">
                  Table 1.2
               &lt;/a>
            &lt;/li>
         &lt;/ol>
      &lt;/li>
      …
   &lt;/ol>
&lt;/nav></pre>
					</aside>
				</section>
			</section>

			<section id="sec-nav-doc-use-spine" class="informative">
				<h3>Using in the spine</h3>

				<p>Although it is possible to reuse the [=EPUB navigation document=] in the [=EPUB spine | spine=], it
					is often the case that not all of the navigation structures, or branches within them, are needed.
					[=EPUB creators=] will often want to hide the <a href="#sec-nav-pagelist">page list</a> and <a
						href="#sec-nav-landmarks">landmarks</a> navigation elements or trim the branches of the table of
					contents for books that have many levels of subsections.</p>

				<p>While the <a href="https://www.w3.org/TR/CSS2/visuren.html#propdef-display"><code>display</code>
						property</a> [[csssnapshot]] controls the visual rendering of EPUB navigation documents in
					[=reading systems=] with [=viewports=], reading systems without viewports may not support CSS. To
					better ensure the proper rendering in these reading systems, EPUB creators should use the [[html]]
					[^html-global/hidden^] attribute to indicate which (if any) portions of the navigation data are
					excluded from rendering in the content flow.</p>

				<p>The <code>hidden</code> attribute has no effect on how reading systems render the navigation data
					outside of the content flow (such as in dedicated navigation user interfaces provided by reading
					systems).</p>

				<div class="note">
					<p>The <code>hidden</code> attribute can be used together with the <code>display</code> property to
						maximize interoperability across all reading systems.</p>
				</div>

				<aside class="example" title="Hiding a nav element in spine">
					<p>In this example, the presence of the <code>hidden</code> attribute on the <code>nav</code>
						element indicates the page list will be excluded from rendering in the content flow when the
						document is rendered in the spine.</p>

					<pre>&lt;nav
    epub:type="page-list"
    hidden="hidden">
   &lt;h2>Pagebreaks of the print version, third edition&lt;/h2>
   &lt;ol>
      &lt;li>
         &lt;a href="frontmatter.xhtml#pi">
            I
         &lt;/a>
      &lt;/li>
      …
   &lt;/ol>
&lt;/nav>
</pre>
				</aside>

				<aside class="example" title="Hiding branches of a nav element">
					<p>In this example, the branch (<code>ol</code> element) not wanted for rendering in the spine has
						the <code>hidden</code> attribute on it. When rendered, this limits the table of content to the
						two top-most hierarchical levels.</p>

					<pre>&lt;nav
    epub:type="toc"
    id="toc">
   &lt;h1>Table of contents&lt;/h1>
   &lt;ol>
      &lt;li>
         &lt;a href="chap1.xhtml">
            Chapter 1
         &lt;/a>
         &lt;ol>
            &lt;li>
               &lt;a href="chap1.xhtml#sec-1.1">
                  Chapter 1.1
               &lt;/a>
               &lt;ol hidden="">
                  &lt;li>
                     &lt;a href="chap1.xhtml#sec-1.1.1">
                        Section 1.1.1
                     &lt;/a>
                  &lt;/li>
                  …
               &lt;/ol>
            &lt;/li>
            …
         &lt;/ol>
      &lt;/li>
      …
   &lt;/ol>
&lt;/nav></pre>
				</aside>
			</section>
		</section>
		<section id="sec-rendering-control">
			<h2>Layout rendering control</h2>

			<section id="sec-general-rendering-intro" class="informative">
				<h3>Introduction</h3>

				<p>Not all rendering information can be expressed through the underlying technologies that EPUB is built
					upon. For example, although HTML with CSS provides powerful layout capabilities, those capabilities
					are limited to the scope of the document being rendered.</p>

				<p>This section defines properties that allow [=EPUB creators=] to express package-level rendering
					intentions (i.e., functionality that can only be implemented by the [=EPUB reading system=]). If a
					reading system supports the desired rendering, these properties enable the user to be presented the
					content as the EPUB creator optimally designed it.</p>
			</section>

			<section id="sec-fixed-layouts">
				<h3>Fixed layouts</h3>

				<section id="fxl-intro" class="informative">
					<h4>Introduction</h4>

					<p>[=EPUB publications=], unlike print books or PDF files, are designed to change. The content
						flows, or reflows, to fit the screen and to fit the needs of the user. As noted in <a
							data-cite="epub-overview-33#sec-rendering">Rendering and CSS</a> "content presentation
						adapts to the user, rather than the user having to adapt to a particular presentation of
						content." [[epub-overview-33]]</p>

					<p>But this principle does not work for all types of documents. Sometimes content and design are so
						intertwined it is not possible to separate them. Any change in appearance risks changing the
						meaning or losing all meaning. [=Fixed-layout documents=] give [=EPUB creators=] greater control
						over presentation when a reflowable EPUB is not suitable for the content.</p>

					<p>EPUB creators define fixed layouts using a <a href="#sec-fxl-package">set of package document
							properties</a> to control the rendering in [=reading systems=]. In addition, they set <a
							href="#sec-fxl-package">the dimensions of each fixed-layout document</a> in its respective
						[=EPUB content document=].</p>

					<div class="note" id="note-mechanisms">
						<p>EPUB 3 affords multiple mechanisms for representing fixed-layout content. When fixed-layout
							content is necessary, the EPUB creator's choice of mechanism will depend on many factors
							including desired degree of precision, file size, accessibility, etc. This section does not
							attempt to dictate the EPUB creator's choice of mechanism.</p>
					</div>
				</section>

				<section id="sec-fxl-package">
					<h4>Fixed-layout package settings</h4>

					<section id="layout">
						<h5>Layout</h5>

						<p>The <code>rendition:layout</code> property specifies whether the content is reflowable or
							pre-paginated.</p>

						<p id="property-layout-global">When the <a href="#layout"><code>rendition:layout</code>
								property</a> is specified on a <code>meta</code> element, it indicates that the
							paginated or reflowable layout style applies globally (i.e., for all spine items).</p>

						<p>[=EPUB creators=] MUST use one of the following values with the <code>rendition:layout</code>
							property:</p>

						<dl class="variablelist">
							<dt id="def-layout-reflowable">reflowable</dt>
							<dd>
								<p>The content is not pre-paginated (i.e., [=reading systems=] apply dynamic pagination
									when rendering). Default value.</p>
							</dd>

							<dt id="def-layout-pre-paginated">pre-paginated</dt>
							<dd>
								<p>The content is pre-paginated (i.e., reading systems produce exactly one page per
									[=EPUB spine | spine=] [^itemref^] when rendering).</p>
							</dd>
						</dl>

						<div class="note" id="uaag">
							<p>Reading systems typically restrict or deny the application of user or user agent style
								sheets to pre-paginated documents because dynamic style changes are likely to have
								unintended consequence on the intrinsic properties of such documents. EPUB creators
								should consider the negative impact on usability and accessibility that these
								restrictions have when choosing to use pre-paginated instead of reflowable content.
								Refer to <a data-cite="UAAG20#gl-text-config">Guideline 1.4 - Provide text
									configuration</a> [[uaag20]] for related information.</p>
						</div>

						<p id="fxl-layout-duplication" data-tests="#lay-fxl-layout-duplication">When the property is set
							to <code>pre-paginated</code> for a spine item, its content dimensions MUST be set as
							defined in <a href="#sec-fxl-content-dimensions"></a>.</p>

						<p>EPUB creators MUST NOT declare the <code>rendition:layout</code> property more than once.</p>

						<p>They also MUST NOT declare the property using the <a href="#attrdef-refines"
									><code>refines</code> attribute</a>. Refer to <a href="#layout-overrides"></a> for
							setting the property for individual [=EPUB content documents=].</p>

						<aside class="example" id="fxl-ex1" title="Fixed Layout Document with media queries">
							<p>In this example, the document's layout is set to <code>pre-paginated</code> (i.e., it is
								defined to be a [=fixed-layout document=]). Furthermore, media queries
								[[mediaqueries-3]] are used to apply different style sheets for three different device
								categories. Note that the media queries only affect the style sheet applied to the
								document; the size of the content area set in the <code>viewport meta</code> tag is
								static.</p>

							<p>Package document:</p>

							<pre>&lt;package …>
   &lt;metadata …>
      …
      &lt;meta
          property="rendition:layout">
         pre-paginated
      &lt;/meta>
      …
   &lt;/metadata>
   …
&lt;/package></pre>

							<p>XHTML</p>

							<pre>&lt;html …>
   &lt;head>
      &lt;meta
          name="viewport"
          content="width=1200,
          height=900"/>
      
      &lt;link
          rel="stylesheet"
          href="eink-style.css"
          media="(max-monochrome: 3)"/>
         
      &lt;link
          rel="stylesheet"
          href="skinnytablet-style.css"
          media="((color) and (max-height:600px) and (orientation:landscape),
                  (color) and (max-width:600px) and (orientation:portrait))"/>
      
      &lt;link
          rel="stylesheet"
          href="fattablet-style.css"
          media="((color) and (min-height:601px) and (orientation:landscape),
                  (color) and (min-width:601px) and (orientation:portrait))"/>	
   &lt;/head>
   …
&lt;/html></pre>
						</aside>

						<section id="layout-overrides">
							<h6>Layout overrides</h6>

							<p id="property-layout-local">[=EPUB creators=] MAY specify the following properties locally
								on [=EPUB spine | spine=] [^itemref^] elements to override the <a
									href="#property-layout-global">global value</a> for the given spine item:</p>

							<dl>
								<dt id="layout-pre-paginated">rendition:layout-pre-paginated</dt>
								<dd>Specifies that the given spine item is pre-paginated.</dd>

								<dt id="layout-reflowable">rendition:layout-reflowable</dt>
								<dd>Specifies that the given spine item is reflowable.</dd>
							</dl>

							<p>EPUB creators MUST NOT use more than one of these overrides on any given spine item.</p>
						</section>
					</section>

					<section id="orientation">
						<h5>Orientation</h5>

						<p>The <code>rendition:orientation</code> property specifies which orientation the [=EPUB
							creator=] intends the content to be rendered in. </p>

						<p id="property-orientation-global">When the <a href="#orientation"
									><code>rendition:orientation</code> property</a> is specified on a [^meta^] element,
							it indicates that the intended orientation applies globally (i.e., for all [=EPUB spine |
							spine=] items).</p>

						<p>[=EPUB creators=] MUST use one of the following values with the
								<code>rendition:orientation</code> property:</p>

						<dl class="variablelist">
							<dt>landscape</dt>
							<dd>
								<p>[=Reading systems=] should render the content in landscape orientation.</p>
							</dd>

							<dt>portrait</dt>
							<dd>
								<p>Reading systems should render the content in portrait orientation.</p>
							</dd>

							<dt>auto</dt>
							<dd>
								<p>The content is not orientation constrained. Default value.</p>
							</dd>
						</dl>

						<p id="fxl-orientation-duplication" data-tests="#lay-fxl-orientation-duplication">EPUB creators
							MUST NOT declare the <code>rendition:orientation</code> property more than once.</p>

						<p>They also MUST NOT declare the property using the <a href="#attrdef-refines"
									><code>refines</code> attribute</a>. Refer to <a href="#orientation-overrides"></a>
							for setting the property for individual [=EPUB content documents=].</p>

						<aside class="example" id="fxl-ex2" title="Specifying global landscape orientation">
							<p>In this example, items in the spine are to be rendered in landscape mode.</p>

							<pre>&lt;package …>
   &lt;metadata …>
      …
      &lt;meta
          property="rendition:layout">
         pre-paginated
      &lt;/meta>

      &lt;meta
          property="rendition:orientation">
         landscape
      &lt;/meta>
   &lt;/metadata>
   …
&lt;/package></pre>
						</aside>

						<section id="orientation-overrides">
							<h6>Orientation overrides</h6>

							<p id="property-orientation-local">[=EPUB creators=] MAY specify the following properties
								locally on [=EPUB spine | spine=] [^itemref^] elements to override the <a
									href="#property-orientation-global">global value</a> for the given spine item:</p>

							<dl>
								<dt id="orientation-auto">rendition:orientation-auto</dt>
								<dd>Specifies that the [=reading system=] determines the orientation to render the spine
									item in.</dd>

								<dt id="orientation-landscape">rendition:orientation-landscape</dt>
								<dd>Specifies that reading systems should render the given spine item in landscape
									orientation.</dd>

								<dt id="orientation-portrait">rendition:orientation-portrait</dt>
								<dd>Specifies that reading systems should render the given spine item in portrait
									orientation.</dd>
							</dl>

							<p>EPUB creators MUST NOT use more than one of these overrides on any given spine item.</p>
						</section>
					</section>

					<section id="spread">
						<h5>Synthetic spreads</h5>

						<p>The <code>rendition:spread</code> property specifies the intended [=reading system=]
							synthetic spread behavior.</p>

						<p id="property-spread-global">When the <code>rendition:spread</code> property is specified on a
								<code>meta</code> element, it indicates that the intended [=synthetic spread=] behavior
							applies globally (i.e., for all spine items).</p>

						<p>[=EPUB creators=] MUST use one of the following values with the <code>rendition:spread</code>
							property:</p>

						<dl class="variablelist">
							<dt>none</dt>
							<dd>
								<p>Do not incorporate spine items in a synthetic spread. Reading systems should display
									the items in a single [=viewport=] positioned at the center of the screen.</p>
							</dd>

							<dt>landscape</dt>
							<dd>
								<p>Render a synthetic spread for spine items only when the device is in landscape
									orientation.</p>
							</dd>

							<dt>portrait (deprecated)</dt>
							<dd>
								<p>The use of spreads only in portrait orientation is <a href="#deprecated"
										>deprecated</a>.</p>
								<p>EPUB creators should use the value "<code>both</code>" instead, as spreads that are
									readable in portrait orientation are also readable in landscape.</p>
							</dd>

							<dt>both</dt>
							<dd>
								<p>Render a synthetic spread regardless of device orientation.</p>
							</dd>

							<dt>auto</dt>
							<dd>
								<p>The EPUB creator is not defining an explicit synthetic spread behavior. Default
									value.</p>
							</dd>
						</dl>

						<p>EPUB creators MUST NOT declare the <code>rendition:spread</code> property more than once.</p>

						<p>They also MUST NOT declare the property using the <a href="#attrdef-refines"
									><code>refines</code> attribute</a>. Refer to <a href="#spread-overrides"></a> for
							setting the property for individual [=EPUB content documents=].</p>

						<div class="note">
							<p>When synthetic spreads are used in the context of [=XHTML content document | XHTML=] and
								[=SVG content documents=], the dimensions given via the <a href="#sec-fxl-icb-html"
										><code>viewport meta</code> element</a> and <a href="#sec-fxl-icb-svg"
										><code>viewBox</code> attribute</a> represents the size of one page in the
								spread, respectively.</p>
						</div>

						<div class="note">
							<p>Refer to the [^spine^] element for information about declaration of global flow
								directionality using the <code>page-progression-direction</code> attribute and that of
								local page-progression-direction within content documents.</p>
						</div>

						<aside class="example" id="spread-none-example"
							title="A fixed-layout EPUB publication without synthetic spread">
							<pre>&lt;package …>
   &lt;metadata …>
      …
      &lt;meta
          property="rendition:layout">
         pre-paginated
      &lt;/meta>
      
      &lt;meta
          property="rendition:spread">
         none
      &lt;/meta>
   &lt;/metadata>
   …
&lt;/package></pre>

							<figure id="spread-none-figure">
								<figcaption> Rendering of three fixed-layout documents without synthetic spread.
										<br /><span class="attribution">(Comics courtesy of <a
											href="https://xkcd.com/927/">xkcd</a>, licensed under <a
											href="https://creativecommons.org/licenses/by-nc/2.5/">cc by-nc
										2.5</a>.)</span>
								</figcaption>
								<img src="images/example_spread_none.svg" width="600" aria-details="spread-none-diagram"
									alt="Progression of FXL pages both in portrait and in landscape modes, showing one page at a time everywhere"
								 />
							</figure>

							<details id="spread-none-diagram" class="desc">
								<summary>Image description</summary>
								<p>Two rows of schematic views of tablets (three in each row). The tablets in the top
									row are in portrait mode, and in landscape mode in the bottom one. The schematic
									views of the tablets within a row are linked with left-to-right arrows.</p>
								<p>In the tablets of each row the consecutive panels of a comics are displayed; the
									panels are centered in their respective tablets.</p>
							</details>
						</aside>


						<aside class="example" id="spread-landscape-example"
							title="Specifying the usage of syntetic spreads in landscape orientation only">
							<pre>&lt;package …>
   &lt;metadata …>
      …
      &lt;meta
          property="rendition:layout">
         pre-paginated
      &lt;/meta>
      
      &lt;meta
          property="rendition:spread">
         landscape
      &lt;/meta>
   &lt;/metadata>
   …
&lt;/package></pre>


							<figure id="spread-landscape-figure">
								<figcaption> Rendering of three fixed-layout documents, with synthetic spread in
									landscape orientation only. <br /><span class="attribution">(Comics courtesy of <a
											href="https://xkcd.com/927/">xkcd</a>, licensed under <a
											href="https://creativecommons.org/licenses/by-nc/2.5/">cc by-nc
										2.5</a>.)</span>
								</figcaption>
								<img src="images/example_spread_landscape.svg" width="600"
									aria-details="spread-landscape-diagram"
									alt="Progression of FXL pages both in portrait and in landscape modes, showing one page at a time in portrait and using synthetic spread in landscape."
								 />
							</figure>

							<details id="spread-landscape-diagram" class="desc">
								<summary>Image description</summary>
								<p>Two rows of schematic views of tablets (three in top row, and two in the bottom). The
									tablets in the top row are in portrait mode, and in landscape mode in the bottom
									one. The schematic views of the tablets within a row are linked with left-to-right
									arrows.</p>
								<p>In both rows three panels of a comics are displayed. In the top row the panels are
									centered in their respective tablets. In the bottom row, the first tablet contains
									the first and second panels of the comics side by side; the second tablet contains
									the second and third panels of the comics side-by-side.</p>
							</details>
						</aside>


						<aside class="example" id="spread-both-example"
							title="Specifying to use synthetic spreads both in portrait and in landscape orientations">
							<p>See also <a href="#spread-both-figure"></a>.</p>
							<pre>&lt;package …>
   &lt;metadata …>
      …
      &lt;meta
          property="rendition:layout">
         pre-paginated
      &lt;/meta>
      
      &lt;meta
          property="rendition:spread">
         both
      &lt;/meta>
   &lt;/metadata>
   …
&lt;/package></pre>

							<figure id="spread-both-figure">
								<figcaption> Rendering of three fixed-layout documents, with synthetic spread in both
									portrait and landscape orientations. <br /><span class="attribution">(Comics
										courtesy of <a href="https://xkcd.com/927/">xkcd</a>, licensed under <a
											href="https://creativecommons.org/licenses/by-nc/2.5/">cc by-nc
										2.5</a>.)</span>
								</figcaption>
								<img src="images/example_spread_both.svg" width="600" aria-details="spread-both-diagram"
									alt="Progression of FXL pages both in portrait and in landscape modes, using synthetic spread in both cases."
								 />
							</figure>

							<details id="spread-both-diagram" class="desc">
								<summary>Image description</summary>
								<p>Two rows of schematic views of tablets (two in each row). The tablets in the top row
									are in portrait mode, and in landscape mode in the bottom one. The schematic views
									of the tablets within a row are linked with left-to-right arrows.</p>
								<p>In both rows three panels of a comics are displayed. The first tablet in a row
									contains the first and second panels of the comics side by side; the second tablet
									contains the second and third panels of the comics side-by-side.</p>
							</details>
						</aside>


						<aside class="example" id="spread-both-with-intro-example"
							title="Overriding the global spread behavior">
							<p>In this example, the EPUB creator overrides the global reflowable setting in the spine
								for the introductory page. The intention is for reading systems to render it as a
								reflowable document.</p>

							<pre>&lt;package …>
   &lt;metadata …>
      …
      &lt;meta
          property="rendition:layout">
         pre-paginated
      &lt;/meta>
      &lt;meta
          property="rendition:spread">
         both
      &lt;/meta>
   &lt;/metadata>
   
   &lt;spine>
      &lt;itemref
          idref="introduction"
          properties="rendition:layout-reflowable"/>
      …
   &lt;/spine>
   …
&lt;/package></pre>

							<figure id="spread-both-with-intro-figure">
								<figcaption>Rendering of an introduction document in reflowable layout, followed by
									three fixed-layout documents with synthetic spread in portrait orientation.
										<br /><span class="attribution">(Comics courtesy of <a
											href="https://xkcd.com/927/">xkcd</a>, licensed under <a
											href="https://creativecommons.org/licenses/by-nc/2.5/">cc by-nc
										2.5</a>.)</span>
								</figcaption>
								<img src="images/example_spread_both_with_reflowable_intro.svg" width="600"
									aria-details="spread-both-with-intro-diagram"
									alt="Progression of FXL pages both in portrait using synthetic spread in both cases, preceded by an introduction with reflowable contnt."
								 />
							</figure>

							<details id="spread-both-with-intro-diagram" class="desc">
								<summary>Image description</summary>
								<p>A row of schematic views of three tablets in portrait mode, and linked with
									left-to-right arrows.</p>
								<p>The first tablet views includes a single, column-like strip (i.e., a rectangle
									without a bottom edge following beyond the bottom of the tablet) with a text flowing
									down the strip, and starting with the word "Introduction". This is followed by two
									schematic tablets with three panels of comics displayed. The first tablet in the row
									contains the first and second panels of the comics side by side; the second tablet
									contains the second and third panels of the comics side-by-side.</p>
							</details>
						</aside>

						<section id="spread-overrides">
							<h6>Synthetic spread overrides</h6>

							<p id="property-spread-local">[=EPUB creators=] MAY specify the following properties locally
								on [=EPUB spine | spine=] [^itemref^] elements to override the <a
									href="#property-spread-global">global value</a> for the given spine item:</p>

							<dl>
								<dt id="spread-auto">rendition:spread-auto</dt>
								<dd>Specifies the [=reading system=] determines when to render a synthetic spread for
									the spine item. </dd>

								<dt id="spread-both">rendition:spread-both</dt>
								<dd>Specifies the reading system should render a synthetic spread for the spine item in
									both portrait and landscape orientations. </dd>

								<dt id="spread-landscape">rendition:spread-landscape</dt>
								<dd>Specifies the reading system should render a synthetic spread for the spine item
									only when in landscape orientation.</dd>

								<dt id="spread-none">rendition:spread-none</dt>
								<dd>Specifies the reading system should not render a synthetic spread for the spine
									item.</dd>

								<dt id="spread-portrait">rendition:spread-portrait</dt>
								<dd>
									<p>The <code>rendition:spread-portrait</code> property is <a href="#deprecated"
											>deprecated</a>.</p>
									<p></p>Refer to the <a
										href="https://idpf.org/epub/301/spec/epub-publications-20140626.html#spread-portrait"
											><code>spread-portrait</code> property definition</a>
									in [[epubpublications-301]] for more information.</dd>
							</dl>

							<p>EPUB creators MUST NOT use more than one of these overrides on any given spine item.</p>
						</section>
					</section>

					<section id="page-spread">
						<h5>Spread placement</h5>

						<p>When a [=reading system=] renders a [=synthetic spread=], the default behavior is to populate
							the spread by rendering the next [=EPUB content document=] in the next available unpopulated
							[=viewport=], where the next available viewport is determined by the given <a
								href="#attrdef-spine-page-progression-direction">page progression direction</a> or by
							local declarations within [=EPUB content documents=]. An [=EPUB creator=] MAY override this
							automatic population behavior and force reading systems to place a document in a particular
							viewport by specifying one of the following properties on its spine <code>itemref</code>
							element:</p>

						<dl>
							<dt id="page-spread-center">
								<code>rendition:page-spread-center</code></dt>
							<dd>The <code>rendition:page-spread-center</code> property is an alias of the <a
									href="#spread-none"><code>spread-none</code> property</a> for centering a spine
								item.</dd>

							<dt id="fxl-page-spread-left">
								<code>rendition:page-spread-left</code>
							</dt>
							<dd>The <code>rendition:page-spread-left</code> property is an alias of the <code><a
										href="#page-spread-left">page-spread-left</a></code> property for placing a
								spine item in the left-hand slot of a two-page spread.</dd>

							<dt id="fxl-page-spread-right">
								<code>rendition:page-spread-right</code>
							</dt>
							<dd>The <code>rendition:page-spread-right</code> property is an alias of the <code><a
										href="#page-spread-right">page-spread-right</a></code> property for placing a
								spine item in the right-hand slot of a two-page spread.</dd>
						</dl>

						<p>The <code>rendition:page-spread-center</code>, <code>rendition:page-spread-left</code>, and
								<code>rendition:page-spread-right</code> properties apply to both pre-paginated and
							reflowable content. They only apply when the reading system is creating synthetic
							spreads.</p>

						<p>Although EPUB creators often indicate to use a spread in certain device orientations, the
							content itself does not represent true spreads (i.e., two consecutive pages that reading
							systems must render side-by-side for readability, such as a two-page map). To indicate that
							two consecutive pages represent a true spread, EPUB creators SHOULD use the
								<code>rendition:page-spread-left</code> and <code>rendition:page-spread-right</code>
							properties on the [=EPUB spine | spine=] items for the two adjacent EPUB content documents,
							and omit the properties on spine items where one-up or two-up presentation is equally
							acceptable.</p>

						<p>EPUB creators MUST NOT declare more than one <code>rendition:page-spread-*</code> property,
							and/or their unprefixed equivalents, on any given spine item (e.g., it is valid to specify
							both "<code>rendition:page-spread-left page-spread-left</code>" in case reading systems only
							support one of properties).</p>

						<div class="note" id="note-page-spread-aliases">
							<p>The <code>rendition:page-spread-left</code> and <code>rendition:page-spread-right</code>
								properties were created to allow the use of a single vocabulary for all fixed-layout
								properties. EPUB creators can use either property set, but older reading systems might
								only recognize the unprefixed versions.</p>

							<p>The <code>rendition:page-spread-center</code> was created to make it easier for EPUB
								creators to understand the process of switching between two-page spreads and single
								centered pages. EPUB creators can use either <code>rendition:page-spread-center</code>
								or <code>spread-none</code> to disable spread behavior in reading systems.</p>
						</div>

						<aside class="example" id="spread-page-spread-right-example"
							title="Starting the first document on the right">
							<pre>&lt;package …>
   &lt;metadata …>
      …
      &lt;meta
          property="rendition:layout">
          reflowable
      &lt;/meta>
	  
      &lt;meta
          property="rendition:spread">
          landscape
      &lt;/meta>
      …
   &lt;/metadata>
   &lt;spine page-progression-direction="ltr">
      …
      &lt;itemref
          idref="first-panel"
          properties="rendition:page-spread-right"/>
      …
   &lt;/spine>
&lt;/package></pre>

							<figure id="spread-page-spread-right-figure">
								<figcaption>Rendering of three fixed-layout documents, with synthetic spread in
									landscape orientation starting on the right. <br /><span class="attribution">(Comics
										courtesy of <a href="https://xkcd.com/927/">xkcd</a>, licensed under <a
											href="https://creativecommons.org/licenses/by-nc/2.5/">cc by-nc
										2.5</a>.)</span>
								</figcaption>
								<img src="images/example_spread_page_spread_right.svg" width="600"
									aria-details="spread-page-spread-right-diagram"
									alt="Progression of FXL pages in landscape modes, showing synthetic spread in both cases but with the first page appearing on the right side of the first page."
								 />
							</figure>

							<details id="spread-page-spread-right-diagram" class="desc">
								<summary>Image description</summary>
								<p>A row of schematic views of two tablets in landscape mode, and linked with a
									left-to-right arrow.</p>
								<p>Three panels of a comics are displayed in the tablets. The first tablet in the row
									contains the first panels of the comics on the right hand of the tablet, with the
									left side empty; the second tablet contains the second and third panels of the
									comics side-by-side.</p>
							</details>
						</aside>

						<aside class="example" id="fxl-ex5" title="Placing individual spine items in a spread">
							<p>In this example, the EPUB creator intends the reading system to create a two-page
								fixed-layout center plate using synthetic spreads in any device orientation. Note that
								the EPUB creator has left spread behavior for the other (reflowable) parts undefined,
								since the global value of <code>rendition:spread</code> initializes to <code>auto</code>
								by default.</p>

							<pre>&lt;package …>
   …
   &lt;spine page-progression-direction="ltr">
      …
      &lt;itemref
          idref="center-plate-left"
          properties="rendition:spread-both rendition:page-spread-left"/>
      &lt;itemref
          idref="center-plate-right"
          properties="rendition:spread-both rendition:page-spread-right"/>
      …
   &lt;/spine>
&lt;/package></pre>
						</aside>

						<aside class="example" id="fxl-ex6" title="Creating a centered layout">
							<pre>&lt;package …>
   &lt;metadata …>
      …
      &lt;meta
          property="rendition:layout">
         pre-paginated
      &lt;/meta>
      &lt;meta
          property="rendition:spread">
         auto
      &lt;/meta>
   &lt;/metadata>
   &lt;spine>
      …
      &lt;itemref
          idref="center-plate"
          properties="rendition:page-spread-center"/>
      …
   &lt;/spine>
   …
&lt;/package></pre>
						</aside>
					</section>

					<section id="viewport">
						<h5>Viewport dimensions (deprecated)</h5>

						<p>The <code>rendition:viewport</code> property allows [=EPUB creators=] to express the CSS
							initial containing block (ICB) [[css2]] for [=XHTML content document | XHTML=] and [=SVG
							content documents=] whose <code>rendition:layout</code> property has been set to
								<code>pre-paginated</code>.</p>

						<p>Use of the property is <a href="#deprecated">deprecated</a>.</p>

						<p>Refer to the <a
								href="https://idpf.org/epub/301/spec/epub-publications-20140626.html#fxl-property-viewport"
									><code>rendition:viewport</code> property definition</a> in [[epubpublications-301]]
							for more information.</p>
					</section>

					<section id="sec-fxl-content-dimensions">
						<h4>Content document dimensions</h4>

						<p>This section defines rules for the expression and interpretation of dimensional properties of
							[=fixed-layout documents=].</p>

						<p id="confreg-fxl-icb">Fixed-layout documents specify their <a
								href="https://www.w3.org/TR/CSS2/visudet.html#containing-block-details">initial
								containing block</a> [[css2]] in the manner applicable to their format:</p>

						<dl class="conformance-list" id="sec-fxl-html-svg-dimensions">
							<dt id="sec-fxl-icb-html" data-tests="#lay-fxl-xhtml-icb,#lay-fxl-xhtml-icb_multi"
								>Expressing in XHTML</dt>
							<dd>
								<p>For XHTML [=fixed-layout documents=], the <a
										href="https://www.w3.org/TR/CSS2/visudet.html#containing-block-details">initial
										containing block</a> [[css2]] is obtained from the REQUIRED <code>height</code>
									and <code>width</code> definitions in a <a href="#app-viewport-meta"><code>viewport
											meta</code> tag</a>, where:</p>
								<ul>
									<li>the <code>height</code>
										<a href="#viewport.ebnf.property">property</a> MUST have as its <a
											href="#viewport.ebnf.value">value</a> a positive number or the keyword
											<code>device-height</code>; and</li>
									<li>the <code>width</code> property MUST have as its value a positive number or the
										keyword <code>device-width</code>.</li>
								</ul>
								<p>The <code>device-width</code> and <code>device-height</code> values refer to the 100%
									of the width and height, respectively, of the reading system's [=viewport=].</p>
								<p>EPUB creators MUST NOT specify duplicate <code>height</code> or <code>width</code>
									definitions either within a single <code>viewport meta</code> tag or by specifying
									multiple <code>viewport meta</code> tags.</p>
								<aside class="example"
									title="Specifying the initial containing block in a viewport meta tag">
									<pre>&lt;html …>
   &lt;head>
      …
      &lt;meta
          name="viewport"
          content="width=1200, height=600"/>
      …
   &lt;/head>
   …
&lt;/html></pre>
								</aside>
							</dd>

							<dt id="sec-fxl-icb-svg" data-tests="#fxl-svg-icb_multi">Expressing in SVG</dt>
							<dd>
								<p>For SVG [=fixed-layout documents=], the initial containing block [[css2]] dimensions
									MUST be expressed using the <a
										href="https://www.w3.org/TR/SVG/coords.html#ViewBoxAttribute"
											><code>viewBox</code> attribute</a> [[svg]].</p>
								<aside class="example"
									title="Specifying the initial containing block in the viewBox attribute">
									<p>In this example, the <code>viewBox</code> attribute sets the ICB to an aspect
										ratio of 844 pixels wide by 1200 pixels high.</p>

									<pre>
&lt;svg xmlns="http://www.w3.org/2000/svg"
     version="1.1" 
     viewBox="0 0 844 1200">
   …
&lt;/svg></pre>
								</aside>
							</dd>
						</dl>

						<p class="note"> The initial containing block definition affects only the document where it is
							defined. The dimensions of the containing blocks in the other content documents within the
							same publication may be different. </p>
					</section>
				</section>
			</section>

			<section id="sec-reflowable-layouts">
				<h3>Reflowable layouts</h3>

				<p>Although control over the rendering of [=EPUB content documents=] to create <a
						href="#sec-fixed-layouts">fixed layouts</a> is an obvious need not handled by other
					technologies, there are also considerations for reflowable content that are unique to [=EPUB
					publications=] (e.g., how to handle the flow of content in the [=viewport=]). This section defines
					properties that allow [=EPUB creators=] to control presentation aspects of reflowable content.</p>

				<section id="flow">
					<h4>The <code>rendition:flow</code> property</h4>

					<p>The <code>rendition:flow</code> property specifies the [=EPUB creator=] preference for how
						[=reading systems=] should handle content overflow. </p>

					<p id="property-flow-global">When the <a href="#flow"><code>rendition:flow</code> property</a> is
						specified on a <code>meta</code> element, it indicates the EPUB creator's global preference for
						overflow content handling (i.e., for all [=EPUB spine | spine=] items). EPUB creators MAY
						indicate a preference for dynamic pagination or scrolling. For scrolled content, it is also
						possible to specify whether consecutive [=EPUB content documents=] are to be rendered as a
						continuous scrolling view or whether each is to be rendered separately (i.e., with a dynamic
						page break between each).</p>

					<p>EPUB creators MUST use one of the following values with the <code>rendition:flow</code>
						property:</p>

					<dl class="variablelist">
						<dt id="paginated">paginated</dt>
						<dd id="paginated-dd" data-tests="#lay-pkg-flow-paginated">
							<p>Dynamically paginate all overflow content.</p>
						</dd>

						<dt id="scrolled-continuous">scrolled-continuous</dt>
						<dd id="scrolled-continuous-dd" data-tests="#lay-pkg-flow-scrolled-continuous">
							<p>Render all EPUB content documents such that overflow content is scrollable, and the
								[=EPUB publication=] is presented as one continuous scroll from spine item to spine item
								(except where <a href="#flow-overrides">locally overridden</a>).</p>
							<p>Note that EPUB creators SHOULD NOT create publications in which different resources have
								different block flow directions, as continuous scrolled rendition in EPUB reading
								systems would be problematic.</p>
						</dd>

						<dt id="scrolled-doc">scrolled-doc</dt>
						<dd id="scrolled-doc-dd" data-tests="#lay-pkg-flow-scrolled-doc">
							<p>Render all EPUB content documents such that overflow content is scrollable, and each
								spine item is presented as a separate scrollable document.</p>
						</dd>

						<dt id="auto">auto</dt>
						<dd>
							<p>Render overflow content using the reading system default method or a user preference,
								whichever is applicable. Default value.</p>
						</dd>
					</dl>

					<p id="html-body-page-break-before">Note that when two reflowable EPUB content documents occur
						sequentially in the spine, the default rendering for their [[!html]] <a
							data-cite="html#the-body-element"><code>body</code></a> elements is consistent with the <a
							href="https://www.w3.org/TR/CSS2/page.html#propdef-page-break-before"
								><code>page-break-before</code> property</a> [[!csssnapshot]] having been set to
							<code>always</code>. In addition to using the <code>rendition:flow</code> property, EPUB
						creators MAY override this behavior through an appropriate style sheet declaration, if the
						reading system supports such overrides.</p>

					<p>EPUB creators MUST NOT declare the <code>rendition:flow</code> property more than once.</p>

					<p>They also MUST NOT declare the property using the <a href="#attrdef-refines"><code>refines</code>
							attribute</a>. Refer to <a href="#flow-overrides"></a> for setting the property for
						individual EPUB content documents.</p>

					<figure id="fig-flow-paginated-single">
						<figcaption>Rendering of an EPUB publication with a single spine item, and with the
								<code>rendition:flow</code> set to <code>paginated</code>.</figcaption>
						<img src="images/example_rendering_paginated_single_spine.svg" width="600"
							aria-details="flow-paginated-single-diagram"
							alt="The continuous progression of paginated content produced for a single document." />
					</figure>

					<details id="flow-paginated-single-diagram" class="desc">
						<summary>Image description</summary>
						<p>Three column-like rectangles linked left-to-middle and middle-to-right with respective
							arrows, with a text flowing from one rectangle to the next one. The text is sectioned with
							headers figuring 'Chapter 1', '2', and '3'. The leftmost rectangle is enclosed in a
							schematic view of a tablet.</p>
					</details>

					<figure id="fig-flow-paginated-multiple">
						<figcaption>Rendering of an EPUB publication with multiple spine items, and with the
								<code>rendition:flow</code> set to <code>paginated</code>.</figcaption>
						<img src="images/example_rendering_paginated_multiple_spine.svg" width="600"
							aria-details="flow-paginated-multiple-diagram"
							alt="The continuous progression of paginated content produced for each document with transitions to
					new pages between documents." />
					</figure>

					<details id="flow-paginated-multiple-diagram" class="desc">
						<summary>Image description</summary>
						<p>Three column-like rectangles linked left-to-middle and middle-to-right with respective
							arrows, with a text flowing from one rectangle to the next one. The text is sectioned with
							headers figuring 'Chapter 1', '2'. The section with 'Chapter 2' starts at the top of the
							rightmost rectangle, leaving an empty space at the bottom of the middle rectangle. The
							leftmost rectangle is enclosed in a schematic view of a tablet.</p>
					</details>

					<figure id="fig-flow-scrolled-continuous">
						<figcaption>Rendering of an EPUB publication with a single spine item, and with the
								<code>rendition:flow</code> set to <code>scrolled-continuous</code>.</figcaption>
						<img src="images/example_rendering_scrolled_continuous.svg" width="220"
							aria-details="flow-scrolled-continuous-diagram"
							alt="The progression of a continuous scroll of content extends vertically off the user's screen,
					with new documents added to the bottom as encountered." />
					</figure>

					<details id="flow-scrolled-continuous-diagram" class="desc">
						<summary>Image description</summary>
						<p>A single, column-like strip (i.e., a rectangle without a bottom edge) with a text flowing
							down the strip. The text is sectioned with headers figuring 'Chapter 1', '2'. The top part
							of the strip is enclosed in a schematic view of a tablet.</p>
					</details>

					<figure id="fig-flow-scrolled-doc">
						<figcaption>Rendering of an EPUB publication with multiple spine items, and with the
								<code>rendition:flow</code> set to <code>scrolled-doc</code>.</figcaption>
						<img src="images/example_rendering_scrolled_doc.svg" width="600"
							aria-details="flow-scrolled-doc-diagram"
							alt="The progression of scrollable documents depicting how only the content within each document
					is scrollable." />
					</figure>

					<details id="flow-scrolled-doc-diagram" class="desc">
						<summary>Image description</summary>
						<p>Three column-like strips (i.e., a rectangles without bottom edges) linked left-to-middle and
							middle-to-right with respective arrows, each containing a text flowing down the strip. The
							text is sectioned with headers figuring 'Chapter 1', '2' and '3'. Each strip starts with a
							chapter header and flows down the strip. The top part of the leftmost strip is enclosed in a
							schematic view of a tablet.</p>
					</details>

					<section id="flow-overrides">
						<h5>Spine overrides</h5>

						<p id="layout-property-flow-local">[=EPUB creators=] MAY specify the following properties
							locally on [=EPUB spine | spine=] [^itemref^] elements to override the <a
								href="#property-flow-global">global value</a> for the given spine item:</p>

						<dl>
							<dt id="flow-auto">rendition:flow-auto</dt>
							<dd>Indicates no preference for overflow content handling by the EPUB creator.</dd>

							<dt id="flow-paginated">rendition:flow-paginated</dt>
							<dd>Indicates the EPUB creator preference is to dynamically paginate content overflow.</dd>

							<dt id="flow-scrolled-continuous">rendition:flow-scrolled-continuous</dt>
							<dd>Indicates the EPUB creator preference is to provide a scrolled view for overflow
								content, and that consecutive spine items with this property are to be rendered as a
								continuous scroll.</dd>

							<dt id="flow-scrolled-doc">rendition:flow-scrolled-doc</dt>
							<dd>Indicates the EPUB creator preference is to provide a scrolled view for overflow
								content, and each spine item with this property is to be rendered as a separate
								scrollable document.</dd>
						</dl>

						<p>EPUB creators MUST NOT use more than one of these overrides on any given spine item.</p>

						<aside class="example" id="property-flow-ex1"
							title="Overriding a global paginated flow declaration">
							<p>In this example, the EPUB creator's intent is to have a paginated [=EPUB publication=]
								with a scrollable table of contents.</p>
							<pre>&lt;package …>
&lt;metadata …&gt;
	…
	&lt;meta
		property="rendition:flow"&gt;
		paginated
	&lt;/meta&gt;
	…
&lt;/metadata&gt;

…

&lt;spine&gt;
	&lt;itemref
		idref="toc"
		properties="rendition:flow-scrolled-doc"/&gt;
	&lt;itemref
		idref="c01"/&gt;
&lt;/spine&gt;
&lt;/package></pre>
						</aside>
					</section>
				</section>

				<section id="align-x-center">
					<h4>The <code>rendition:align-x-center</code> property</h4>

					<p>The <code>rendition:align-x-center</code> property specifies that the given [=EPUB spine |
						spine=] item should be centered horizontally in the [=viewport=] or spread.</p>

					<p>The property MUST NOT be set globally for all [=EPUB content documents=] (i.e., in a [^meta^]
						element without a <a href="#attrdef-refines"><code>refines</code> attribute</a>). It is only
						available as a spine override for individual EPUB content documents via the [^itemref^]
						element's <code>properties</code> attribute.</p>

					<div class="note">
						<p>This property was developed primarily to handle "Naka-Tobira (中扉)" (sectional title pages),
							in the absence of reliable centering control within the content rendering. As support for
							paged media evolves in CSS, however, this property is expected to be deprecated. [=EPUB
							creators=] are encouraged to use CSS solutions when effective.</p>
					</div>
				</section>
			</section>
		</section>
		<section id="sec-media-overlays">
			<h2>Media overlays</h2>

			<section id="sec-overlays-introduction" class="informative">
				<h4>Introduction</h4>

				<p>Mainstream ebooks, educational tools and ebooks formatted for persons with print disabilities are
					some examples of works that contain synchronized audio narration. In EPUB 3, [=EPUB creators=] can
					create these types of books using media overlay documents to describe the timing for the
					pre-recorded audio narration and how it relates to the [=EPUB content document=] markup. The
					specification defines the file format for media overlays as a subset of [[smil3]], a W3C
					recommendation for representing synchronized multimedia information in XML.</p>

				<p>The text and audio synchronization enabled by media overlays provides enhanced accessibility for any
					user who has difficulty following the text of a traditional book. Media overlays also provide a
					continuous listening experience for readers who are unable to read the text for any reason,
					something that traditional audio embedding techniques cannot offer. They are even useful for
					purposes not traditionally considered accessibility concerns (e.g., for language learning).</p>

				<p>The media overlays feature is transparent to [=EPUB reading systems=] that do not support the
					feature. The inclusion of media overlays in an [=EPUB publication=] has no impact on the ability of
					media overlay-unaware reading systems to render the EPUB publication as though the media overlays
					are not present.</p>

				<p>Media overlays in EPUB are not an equivalent to audiobooks, as audiobooks are primarily audio-based
					with text occasionally provided as an alternate format. The W3C [[audiobooks]] recommendation is for
					building audio publications.</p>

				<p>Although future versions of this specification might incorporate support for video media (e.g.,
					synchronized text/sign-language books), this version supports only synchronizing audio media with
					the EPUB content document.</p>
			</section>

			<section id="sec-overlay-docs">
				<h3>Media overlay documents</h3>

				<section id="sec-overlay-req">
					<h4>Media overlay document requirements</h4>

					<p>A [=media overlay document=]:</p>

					<ul class="conformance-list">
						<li>
							<p id="confreq-mo-docprops-schema">MUST be valid to the media overlays schema as defined in
									<a href="#app-schema-overlays"></a> and conform to all content conformance
								constraints expressed in <a href="#sec-overlays-def"></a>.</p>
						</li>
						<li>
							<p id="confreq-mo-docprops-references">MAY refer to more than one [=EPUB content document=],
								but more than one media overlay document MUST NOT reference the same EPUB content
								document.</p>
						</li>
					</ul>
				</section>

				<section id="sec-overlays-def">
					<h3>Media overlay document definition</h3>

					<p>All elements [[xml]] defined in this section are in the <code>https://www.w3.org/ns/SMIL</code>
						namespace [[xml-names]] unless otherwise specified.</p>

					<section id="sec-smil-smil-elem">
						<h5>The <code>smil</code> element</h5>

						<p>The <code>smil</code> element encapsulates all the information in an [=media overlay
							document=].</p>

						<dl class="elemdef" id="elemdef-smil">
							<dt>Element Name:</dt>
							<dd>
								<p>
									<dfn class="export" data-lt-no-plural="" data-dfn-type="element"
										><code>smil</code></dfn>
								</p>
							</dd>

							<dt>Usage:</dt>
							<dd>
								<p>REQUIRED <a data-cite="xml#dt-root">root element</a> [[xml]] of the media overlay
									document.</p>
							</dd>

							<dt>Attributes:</dt>
							<dd>
								<dl>
									<dt>
										<code>version</code>
										<code>[required]</code>
									</dt>
									<dd>
										<p>Specifies the version number of the [[smil3]] specification to which the
											media overlay document adheres.</p>
										<p>This attribute MUST have the value "<code>3.0</code>".</p>
									</dd>

									<dt>
										<code>id</code>
										<code>[optional]</code>
									</dt>
									<dd>
										<p>The <a data-cite="xml#id">ID</a> [[xml]] of the element, which MUST be unique
											within the document scope.</p>
									</dd>

									<dt id="attrdef-smil-prefix">
										<code>epub:prefix</code>
										<code>[optional]</code>
									</dt>
									<dd>
										<p>Declares additional metadata vocabulary prefixes.</p>
										<p>Refer to <a href="#sec-docs-structural-semantic"></a> for more
											information.</p>
									</dd>
								</dl>
							</dd>

							<dt>Content Model:</dt>
							<dd>
								<p>In this order:</p>
								<ul class="nomark">
									<li>
										<p> [^head^] <code>[0 or 1]</code>
										</p>
									</li>
									<li>
										<p> [^body^] <code>[exactly 1]</code>
										</p>
									</li>
								</ul>
							</dd>
						</dl>
					</section>

					<section id="sec-smil-head-elem">
						<h5>The <code>head</code> element</h5>

						<p>The <code>head</code> element is the container for metadata in the [=media overlay
							document=].</p>

						<dl class="elemdef" id="elemdef-smil-head">
							<dt>Element Name:</dt>
							<dd>
								<p>
									<dfn class="export" data-lt-no-plural="" data-dfn-type="element"
										><code>head</code></dfn>
								</p>
							</dd>

							<dt>Usage:</dt>
							<dd>
								<p>The <code>head</code> element is the OPTIONAL first child of the [^smil^]
									element.</p>
							</dd>

							<dt>Attributes:</dt>
							<dd>
								<p>None</p>
							</dd>

							<dt>Content Model:</dt>
							<dd>
								<p> [^metadata^] <code>[0 or 1]</code>
								</p>
							</dd>
						</dl>

						<p>As this specification does not define any metadata properties that must occur in the media
							overlay document, the <code>head</code> element is OPTIONAL.</p>
					</section>

					<section id="sec-smil-metadata-elem">
						<h5>The <code>metadata</code> element</h5>

						<p>The <code>metadata</code> element represents metadata for the [=media overlay document=]. The
								<code>metadata</code> element is an extension point that allows the inclusion of
							metadata from any metainformation structuring language.</p>

						<dl class="elemdef" id="elemdef-smil-metadata">
							<dt>Element Name:</dt>
							<dd>
								<p>
									<code>metadata</code>
								</p>
							</dd>

							<dt>Usage:</dt>
							<dd>
								<p>As a child of the [^head^] element.</p>
							</dd>

							<dt>Attributes:</dt>
							<dd>
								<p>None</p>
							</dd>

							<dt>Content Model:</dt>
							<dd>
								<p><code>[0 or more]</code> elements from any namespace</p>
							</dd>
						</dl>

						<p>This specification does not require any metadata properties in the media overlay document;
							the <code>metadata</code> element is provided for custom metadata requirements.</p>
					</section>

					<section id="sec-smil-body-elem">
						<h5>The <code>body</code> element</h5>

						<p>The <code>body</code> element is the starting point for the presentation contained in the
							[=media overlay document=]. It contains the main sequence of [^par^] and [^seq^]
							elements.</p>

						<dl class="elemdef" id="elemdef-smil-body">
							<dt>Element Name:</dt>
							<dd>
								<p>
									<dfn class="export" data-lt-no-plural="" data-dfn-type="element"
										><code>body</code></dfn>
								</p>
							</dd>

							<dt>Usage:</dt>
							<dd>
								<p>The <code>body</code> element is a REQUIRED child of the [^smil^] element. It follows
									the [^head^] element, when that element is present.</p>
							</dd>

							<dt>Attributes:</dt>
							<dd>
								<dl>
									<dt id="addrdef-smil-body-type">
										<code>epub:type</code>
										<code>[optional]</code>
									</dt>
									<dd>
										<p>An expression of the structural semantics of the corresponding element in the
											[=EPUB content document=].</p>
										<p>The value is a white space separated list of <a href="#sec-property-datatype"
												>property</a> types. Refer to <a href="#sec-docs-structural-semantic"
											></a> for more information.</p>
									</dd>

									<dt>
										<code>id</code>
										<code>[optional]</code>
									</dt>
									<dd>
										<p>The <a data-cite="xml#id">ID</a> [[xml]] of the element, which MUST be unique
											within the document scope.</p>
									</dd>

									<dt id="attrdef-body-textref">
										<code>epub:textref</code>
										<code>[optional]</code>
									</dt>
									<dd>
										<p>Refers to the associated EPUB content document and, optionally, identifies a
											specific part of it.</p>
										<p>The value MUST be a [=path-relative-scheme-less-URL string=], optionally
											followed by <code>U+0023 (#)</code> and a [=URL-fragment string=].</p>
									</dd>
								</dl>
							</dd>

							<dt>Content Model:</dt>
							<dd>
								<p>In any order:</p>
								<ul class="nomark">
									<li>
										<p> [^seq^] <code>[0 or more]</code>
										</p>
									</li>
									<li>
										<p> [^par^] <code>[0 or more]</code>
										</p>
									</li>
								</ul>
								<p>MUST include at least one <code>par</code> or <code>seq</code>.</p>
							</dd>
						</dl>
					</section>

					<section id="sec-smil-seq-elem">
						<h5>The <code>seq</code> element</h5>

						<p>The <code>seq</code> element is a sequential time container for media objects and/or child
							time containers.</p>

						<dl class="elemdef" id="elemdef-smil-seq">
							<dt>Element Name:</dt>
							<dd>
								<p>
									<dfn class="export" data-lt-no-plural="" data-dfn-type="element"
										><code>seq</code></dfn>
								</p>
							</dd>

							<dt>Usage:</dt>
							<dd>
								<p>One or more <code>seq</code> elements MAY occur as children of the [^body^] element
									and of the [^seq^] element.</p>
							</dd>

							<dt>Attributes:</dt>
							<dd>
								<dl>
									<dt>
										<code>epub:type</code>
										<code>[optional]</code>
									</dt>
									<dd>
										<p>An expression of the structural semantics of the corresponding element in the
											[=EPUB content document=].</p>
										<p>The value is a white space separated list of <a href="#sec-property-datatype"
												>property</a> types. Refer to <a href="#sec-docs-structural-semantic"
											></a> for more information.</p>
									</dd>

									<dt>
										<code>id</code>
										<code>[optional]</code>
									</dt>
									<dd>
										<p>The <a data-cite="xml#id">ID</a> [[xml]] of the element, which MUST be unique
											within the document scope.</p>
									</dd>

									<dt id="attrdef-seq-textref">
										<code>epub:textref</code>
										<code>[required]</code>
									</dt>
									<dd>
										<p>Refers to the associated [=EPUB content document=] and, optionally,
											identifies a specific part of it.</p>
										<p>The value MUST be a [=path-relative-scheme-less-URL string=], optionally
											followed by <code>U+0023 (#)</code> and a [=URL-fragment string=].</p>
										<p>Refer to <a href="#sec-media-overlays-structure"></a> for more
											information.</p>
									</dd>
								</dl>
							</dd>

							<dt>Content Model:</dt>
							<dd>
								<p>In any order:</p>
								<ul class="nomark">
									<li>
										<p> [^seq^] <code>[0 or more]</code>
										</p>
									</li>
									<li>
										<p> [^par^] <code>[0 or more]</code>
										</p>
									</li>
								</ul>
								<p>MUST include at least one <code>par</code> or <code>seq</code>.</p>
							</dd>
						</dl>
					</section>

					<section id="sec-smil-par-elem">
						<h5>The <code>par</code> element</h5>

						<p>The <code>par</code> element is a parallel time container for media objects.</p>

						<dl class="elemdef" id="elemdef-smil-par">
							<dt>Element Name:</dt>
							<dd>
								<p>
									<dfn class="export" data-lt-no-plural="" data-dfn-type="element"
										><code>par</code></dfn>
								</p>
							</dd>

							<dt>Usage:</dt>
							<dd>
								<p>One or more <code>par</code> elements MAY occur as children of the [^body^] and
									[^seq^] elements.</p>
							</dd>

							<dt>Attributes:</dt>
							<dd>
								<dl>
									<dt>
										<code>epub:type</code>
										<code>[optional]</code>
									</dt>
									<dd>
										<p>An expression of the structural semantics of the corresponding element in the
											[=EPUB content document=].</p>
										<p>The value is a white space separated list of <a href="#sec-property-datatype"
												>property</a> types. Refer to <a href="#sec-docs-structural-semantic"
											></a> for more information.</p>
									</dd>

									<dt>
										<code>id</code>
										<code>[optional]</code>
									</dt>
									<dd>
										<p>The <a data-cite="xml#id">ID</a> [[xml]] of the element, which MUST be unique
											within the document scope.</p>
									</dd>
								</dl>
							</dd>

							<dt>Content Model:</dt>
							<dd>
								<p>In any order:</p>
								<ul class="nomark">
									<li>
										<p> [^text^] <code>[exactly 1]</code>
										</p>
									</li>
									<li>
										<p> [^audio^] <code>[0 or 1]</code>
										</p>
									</li>
								</ul>
							</dd>
						</dl>
					</section>

					<section id="sec-smil-text-elem">
						<h5>The <code>text</code> element</h5>

						<p>The <code>text</code> element references an element in an [=EPUB content document=]. A
								<code>text</code> element typically refers to a textual element but can also refer to
							other [=EPUB content document=] media elements. In the absence of a sibling [^audio^]
							element, textual content referred to by this element may be rendered via <a href="#sec-tts"
								>text-to-speech</a>.</p>

						<dl class="elemdef" id="elemdef-smil-text">
							<dt>Element Name:</dt>
							<dd>
								<p>
									<dfn class="export" data-lt-no-plural="" data-dfn-type="element"
										><code>text</code></dfn>
								</p>
							</dd>

							<dt>Usage:</dt>
							<dd>
								<p>As a REQUIRED child of the [^par^] element.</p>
							</dd>

							<dt>Attributes:</dt>
							<dd>
								<dl>
									<dt>
										<code>src</code>
										<code>[required]</code>
									</dt>
									<dd>
										<p>Refers to the associated EPUB content document and, optionally, identifies a
											specific part of it.</p>
										<p>The value MUST be a [=path-relative-scheme-less-URL string=], optionally
											followed by <code>U+0023 (#)</code> and a [=URL-fragment string=].</p>
									</dd>

									<dt>
										<code>id</code>
										<code>[optional]</code>
									</dt>
									<dd>
										<p>The <a data-cite="xml#id">ID</a> [[xml]] of the element, which MUST be unique
											within the document scope.</p>
									</dd>
								</dl>
							</dd>

							<dt>Content Model:</dt>
							<dd>
								<p>Empty</p>
							</dd>
						</dl>

						<p class="note">This specification places no restriction on the <code>src</code> attribute of a
								<code>text</code> element. [=EPUB creators=] should, however, refer to a content that
							can be styled with CSS to make the <a href="#sec-docs-assoc-style">association with style
								information</a> effective (i.e., [=palpable content=] for XHTML or <a
								href="https://www.w3.org/TR/SVG11/paths.html">paths</a>, <a
								href="https://www.w3.org/TR/SVG11/shapes.html">basic shapes</a>, or <a
								href="https://www.w3.org/TR/SVG11/text.html">text</a> elements in SVG). </p>

						<p class="note">[[epub-rs-33]] no longer provides guidance for reading systems on the playback
							of timed media (i.e., the automatic starting of the referenced media). Although the
								<code>src</code> attribute of a <code>text</code> element may refer to embedded timed
							media (e.g., via an [[html]] [^video^] element), referencing such media may have
							unpredictable results.</p>
					</section>

					<section id="sec-smil-audio-elem">
						<h5>The <code>audio</code> element</h5>

						<p>The <code>audio</code> element represents a clip of audio media.</p>

						<dl class="elemdef" id="elemdef-smil-audio">
							<dt>Element Name:</dt>
							<dd>
								<p>
									<dfn class="export" data-lt-no-plural="" data-dfn-type="element"
										><code>audio</code></dfn>
								</p>
							</dd>

							<dt>Usage:</dt>
							<dd>
								<p>An OPTIONAL child of the [^par^] element.</p>
							</dd>

							<dt>Attributes:</dt>
							<dd>
								<dl>
									<dt>
										<code>id</code>
										<code>[optional]</code>
									</dt>
									<dd>
										<p>The <a data-cite="xml#id">ID</a> [[xml]] of the element, which MUST be unique
											within the document scope.</p>
									</dd>

									<dt>
										<code>src</code>
										<code>[required]</code>
									</dt>
									<dd>
										<p>The [=relative-url string | relative-=] or <a data-lt="absolute-url string"
												>absolute-URL string</a> [[url]] reference to an audio file. The audio
											file MUST be one of the audio formats listed in the <a
												href="#sec-core-media-types">core media type resources</a> table.</p>
									</dd>

									<dt id="attrdef-smil-clipBegin">
										<code>clipBegin</code>
										<code>[optional]</code>
									</dt>
									<dd>
										<p>A clock value that specifies the offset into the physical media corresponding
											to the start point of an audio clip.</p>
										<p>MUST be a [[smil3]] <a data-cite="smil3/smil-timing.html#q22">clock
											value</a>.</p>
										<p>See <a href="#clock-examples"></a>.</p>
									</dd>

									<dt id="attrdef-smil-clipEnd">
										<code>clipEnd</code>
										<code>[optional]</code>
									</dt>
									<dd>
										<p>A clock value that specifies the offset into the physical media corresponding
											to the end point of an audio clip.</p>
										<p>MUST be a [[smil3]] <a data-cite="smil3/smil-timing.html#q22">clock
											value</a>.</p>
										<p>See <a href="#clock-examples"></a>.</p>
										<p>The chronological offset of the terminating position MUST be after the
											starting offset specified in the <code>clipBegin</code> attribute.</p>
									</dd>
								</dl>
							</dd>

							<dt>Content Model:</dt>
							<dd>
								<p>Empty</p>
							</dd>
						</dl>
					</section>
				</section>
			</section>

			<section id="sec-overlay-doc-create">
				<h3>Creating media overlays</h3>

				<section id="sec-docs-intro" class="informative">
					<h4>Introduction</h4>

					<p>[=EPUB creators=] can represent a pre-recorded narration of a publication as a series of audio
						clips, each corresponding to part of an [=EPUB content document=]. A single audio clip, for
						example, typically represents a single phrase or paragraph, but infers no order relative to the
						other clips or to the text of a document. Media overlays solve this problem of synchronization
						by tying the structured audio narration to its corresponding text (or other media) in the EPUB
						content document using [[smil3]] markup. Media overlays are, in fact, a simplified subset of
						SMIL 3.0 that define the playback sequence of these clips.</p>

					<p>The SMIL elements primarily used for structuring media overlays are [^body^] (used for the main
						sequence), [^seq^] (sequence) and [^par^] (parallel). (Refer to <a href="#sec-overlays-def"></a>
						for more information on these and other SMIL elements.)</p>

					<p>The <code>par</code> element is the basic building block of a media overlay and corresponds to a
						phrase in the EPUB content document. The element provides two key pieces of information for
						synchronizing content: 1) the audio clip containing the narration for the phrase; and 2) a
						pointer to the associated EPUB content document fragment. The <code>par</code> element uses two
						media element children to represent this information: an [^audio^] element and a [^text^]
						element. Because <code>par</code> elements' media object children are timed in parallel, reading
						systems render the audio clip and EPUB content document fragment at the same time, resulting in
						a synchronized presentation.</p>

					<p>The <code>text</code> element <code>src</code> attribute references the associated phrase,
						sentence, or other segment of the EPUB content document by its URL [[url]] reference. The
							<code>audio</code> element <code>src</code> attribute similarly references the location of
						the corresponding audio clip and adds the OPTIONAL <a href="#attrdef-smil-clipBegin"
								><code>clipBegin</code></a> and <a href="#attrdef-smil-clipEnd"><code>clipEnd</code></a>
						attributes to indicate a specific offset within the clip.</p>

					<aside class="example" title="Media overlays markup for a single phrase or sentence">
						<pre>&lt;par>                        
   &lt;text
       src="chapter1.xhtml#sentence1"/>
   &lt;audio
       src="chapter1_audio.mp3"
       clipBegin="23s"
       clipEnd="30s"/>
&lt;/par></pre>
					</aside>

					<p>EPUB creators place <code>par</code> elements together sequentially to form a series of phrases
						or sentences. Not every element of the EPUB content document will have a corresponding
							<code>par</code> element in a media overlay document, only those relevant to the audio
						narration.</p>

					<aside class="example" title="A basic media overlay document containing a sequence of phrases">
						<p>In this example, the <code>body</code> element acts as the main sequence for the whole
							document.</p>

						<pre>&lt;smil
    xmlns="http://www.w3.org/ns/SMIL" 
    version="3.0">
   &lt;body>
      &lt;par id="par1">
         &lt;text
             src="chapter1.xhtml#sentence1"/>
         &lt;audio
             src="chapter1_audio.mp3"
             clipBegin="0s"
             clipEnd="10s"/>
      &lt;/par>
      &lt;par id="par2">
         &lt;text
             src="chapter1.xhtml#sentence2"/>
         &lt;audio
             src="chapter1_audio.mp3"
             clipBegin="10s"
             clipEnd="20s"/>
      &lt;/par>
      &lt;par id="par3">
         &lt;text
             src="chapter1.xhtml#sentence3"/>
         &lt;audio
             src="chapter1_audio.mp3"
             clipBegin="20s"
             clipEnd="30s"/>
      &lt;/par>
   &lt;/body>
&lt;/smil></pre>
					</aside>

					<p>EPUB creators can also add <code>par</code> elements to <code>seq</code> elements to define more
						complex structures such as parts and chapters (see <a href="#sec-media-overlays-structure"
						></a>).</p>
				</section>

				<section id="sec-docs-relations">
					<h4>Relationship to the EPUB content document</h4>

					<div class="note">
						<p>In this section, the [=EPUB content document=] is assumed to be an [=XHTML content
							document=]. While [=EPUB creators=] may use media overlays with [=SVG content documents=],
							playback behavior might not be consistent and therefore interoperability is not
							guaranteed.</p>
					</div>

					<section id="sec-media-overlays-structure">
						<h5>Overlay structure</h5>

						<p>The [^body^] of a [=media overlay document=] consists of two elements: the [^par^] element
							and the [^seq^] element. The ordering of these elements represents how [=reading systems=]
							render the content in the corresponding [=EPUB content documents=] during playback.</p>

						<p>The <code>par</code> element represents a segment of content, such as a word, phrase,
							sentence, table cell, list item, image, or other identifiable piece of content in the
							markup. Each element identifies both the content to display (in the [^text^] element) and
							audio to synchronize (in the [^audio^] element) during playback.</p>

						<p>The <code>seq</code> element represents sequences &#8212; sets of <code>seq</code> and/or
								<code>par</code> elements that together represent a logical component of the content.
							[=EPUB creators=] can use it to represent nested containers such as sections, asides,
							headers, tables, lists, and footnotes. It allows EPUB creators to retain the structure
							inherent in these containers in the media overlay document.</p>

						<p>The <code>seq</code> element MUST contain an <a href="#attrdef-body-textref"
									><code>epub:textref</code> attribute</a>. As <code>seq</code> elements do not
							provide synchronization instructions, this attribute allows a [=reading system=] to match
							the fragment to a location in the text.</p>

						<div class="note">
							<p>The reason for grouping structures like sections, figures, tables, and footnotes in a
									<code>seq</code> element is so that reading systems can identify their start and end
								positions during playback. Reading systems can then offer playback options tailored to
								the layout of the content, such as jumping past a long figure, turning off rendering of
								page break announcements (see <a href="#sec-behaviors-skip-escape"></a>), or customizing
								the reading mode to suit structures such as tables.</p>
						</div>

						<aside class="example" id="example-mo-nesting" title="A media overlay document with nested seq
							elements">
							<p>This example shows a chapter with both a section header and a figure.</p>

							<p>Media overlay document:</p>

							<pre>&lt;smil
    xmlns="http://www.w3.org/ns/SMIL"
    xmlns:epub="http://www.idpf.org/2007/ops"
    version="3.0">
   &lt;body>

      &lt;!-- a chapter -->
      
      &lt;seq
          id="id1"
          epub:textref="chapter1.xhtml#sectionstart"
          epub:type="chapter">

         &lt;!-- the section title -->
         
         &lt;par id="id2">
            &lt;text
                src="chapter1.xhtml#section1_title"/>
            &lt;audio
                src="chapter1_audio.mp3"
                clipBegin="0:23:23.84"
                clipEnd="0:23:34.221"/>
         &lt;/par>

         &lt;!-- some sentences in the chapter -->
         
         &lt;par id="id3">
            &lt;text
                src="chapter1.xhtml#text1"/>
            &lt;audio
                src="chapter1_audio.mp3"
                clipBegin="0:23:34.221"
                clipEnd="0:23:59.003"/>
         &lt;/par>
         &lt;par id="id4">
            &lt;text
                src="chapter1.xhtml#text2"/>
            &lt;audio
                src="chapter1_audio.mp3"
                clipBegin="0:23:59.003"
                clipEnd="0:24:15.000"/>
         &lt;/par>

         &lt;!-- a figure -->
         
         &lt;seq
             id="id7"
             epub:textref="chapter1.xhtml#figure">
            &lt;par id="id8">
               &lt;text
                   src="chapter1.xhtml#photo"/>
               &lt;audio
                   src="chapter1_audio.mp3"
                   clipBegin="0:24:18.123"
                   clipEnd="0:24:28.764"/>
            &lt;/par>
            &lt;par id="id9">
               &lt;text
                   src="chapter1.xhtml#caption"/>
               &lt;audio
                   src="chapter1_audio.mp3"
                   clipBegin="0:24:28.764"
                   clipEnd="0:24:50.010"/>
            &lt;/par>
         &lt;/seq>

         &lt;!-- more sentences in the chapter (outside the figure) -->
         
         &lt;par id="id12">
            &lt;text
                src="chapter1.xhtml#text3"/>
            &lt;audio
                src="chapter1_audio.mp3"
                clipBegin="0:25:45.515"
                clipEnd="0:26:30.203"/>
         &lt;/par>
         &lt;par id="id13">
            &lt;text
                src="chapter1.xhtml#text4"/>
            &lt;audio
                src="chapter1_audio.mp3"
                clipBegin="0:26:30.203"
                clipEnd="0:27:15.000"/>
         &lt;/par>
      &lt;/seq>
   &lt;/body>
&lt;/smil></pre>

							<p>XHTML content document:</p>

							<pre>&lt;html …>
   &lt;head>
      &lt;title>
         Media Overlays Example of
         EPUB content document
      &lt;/title>
   &lt;/head>
   &lt;body id="sec1">
      &lt;section
          id="sectionstart"
          epub:type="chapter">
         
         &lt;h1 id="section1_title">
            The Section Title
         &lt;/h1>
         
         &lt;p id="text1">
            The first phrase of the main text body.
         &lt;/p>
         
         &lt;p id="text2">
            The second phrase of the main text body.
         &lt;/p>
         
         &lt;figure id="figure">
            &lt;img id="photo"
                src="photo.png" 
                alt="a photograph for which there is a caption" />
            
            &lt;figcaption id="caption">
               The photo caption
            &lt;/figcaption>
         &lt;/figure>
         
         &lt;p id="text3">
            The third phrase of the main text body.
         &lt;/p>
         
         &lt;p id="text4">
            The fourth phrase of the main text body.
         &lt;/p>
      &lt;/section>
   &lt;/body>
&lt;/html></pre>
						</aside>
					</section>

					<section id="sec-media-overlays-fragids">
						<h5>Referencing document fragments</h5>

						<p>Both the <code>epub:textref</code> attribute and the [^text^] element's <code>src</code>
							attribute may contain a [=URL-fragment string=] that references a specific part (e.g., an
							element via its ID) of the associated [=EPUB content document=].</p>

						<p>For [=XHTML content document | XHTML=] and [=SVG content documents=], the URL-fragment string
							SHOULD be a reference to a specific element via its ID, or an <a
								href="https://www.w3.org/TR/SVG/linking.html#SVGFragmentIdentifiers">SVG Fragment
								Identifier</a> [[svg]], respectively.</p>

						<p>EPUB creators MAY use other fragment identifier schemes, but [=reading systems=] may not
							support such identifiers.</p>
					</section>

					<section id="sec-media-overlays-granularity" class="informative">
						<h5>Overlay granularity</h5>

						<p>The granularity level of the media overlay depends on how [=EPUB creators=] mark up the
							[=EPUB content document=] and the type of fragment identifier they use in the [^text^]
							elements' <code>src</code> attributes and the [^seq^] elements' <code>epub:textref</code>
							attrbutes. For example, when referencing [[html]] elements, if the finest level of markup is
							at the paragraph level, then that is the finest possible level for media overlay
							synchronization. Likewise, if sub-paragraph markup is available, such as [[html]] [^span^]
							element representing phrases or sentences, then finer granularity is possible in the media
							overlay. Finer granularity gives users more precise results for synchronized playback when
							navigating by word or phrase and when searching the text but increases the file size of the
							[=media overlay documents=]. Fragment identifier schemes that do not rely on the presence of
							elements could provide even finer granularity, where supported.</p>
					</section>

					<section id="sec-tts">
						<h5>Text-to-speech rendering</h5>

						<p>This specification allows the use of text-to-speech (TTS) &#8212; the rendering of the
							textual content of an [=EPUB publication=] as artificial human speech using a synthesized
							voice &#8212; in addition to pre-recorded audio clips.</p>

						<p>When a media overlay [^par^] element omits its [^audio^] element, its [^text^] element may be
							rendered in reading systems via TTS. If the text fragment is not appropriate for TTS
							rendering (e.g., is not a text element and/or has no text fallback), this may produce
							unexpected results.</p>

						<div class="note">
							<p>See <a data-cite="epub-tts-10#">EPUB 3 Text-to-Speech Support</a> [[epub-tts-10]] for
								more information about using TTS technologies in EPUB publications.</p>
						</div>
					</section>
				</section>

				<section id="sec-docs-structural-semantic">
					<h4>Structural semantics in overlays</h4>

					<p>To express <a href="#app-structural-semantics">structural semantics</a> in [=media overlay
						documents=], [=EPUB creators=] MAY specify the [^/epub:type^] attribute on [^par^], [^seq^], and
						[^body^] elements.</p>

					<p>The <code>epub:type</code> attribute facilitates [=reading system=] behavior appropriate for the
						semantic type(s) indicated. Examples of these behaviors are <a href="#sec-behaviors-skip-escape"
							>skippability and escapability</a> and <a data-cite="epub-rs-33#note-table-reading-mode"
							>table reading mode</a> [[?epub-rs-33]].</p>

					<p>[=Media overlay documents=] MAY use the applicable <a href="#sec-vocab-assoc">vocabulary
							association mechanisms</a> for the <code>epub:type</code> attribute to define additional
						semantics.</p>

					<aside class="example" title="Semantic markup for a media overlay document containing a figure">
						<pre>&lt;smil
    xmlns="http://www.w3.org/ns/SMIL" 
    xmlns:epub="http://www.idpf.org/2007/ops"
    version="3.0">
   &lt;body>
      &lt;seq
          id="id1"
          epub:textref="chapter1.xhtml#figure"
          epub:type="figure">
         &lt;par id="id2">
            &lt;text
                src="chapter1.xhtml#figuretitle"/>
            &lt;audio
                src="chapter1_audio.mp3"
                clipBegin="0:24:15.000"
                clipEnd="0:24:18.123"/>
         &lt;/par>
         &lt;par id="id3">
            &lt;text
                src="chapter1.xhtml#figurecaption"/>
            &lt;audio
                src="chapter1_audio.mp3"
                clipBegin="0:24:18.123"
                clipEnd="0:24:38.530"/>
         &lt;/par>
         &lt;par id="id4">
            &lt;text
                src="chapter1.xhtml#figuretext1"/>
            &lt;audio
                src="chapter1_audio.mp3"
                clipBegin="0:24:38.530"
                clipEnd="0:25:00.515"/>
         &lt;/par>
      &lt;/seq>
   &lt;/body>
&lt;/smil></pre>
					</aside>
				</section>

				<section id="sec-docs-assoc-style">
					<h4>Associating style information</h4>

					<p>[=EPUB creators=] MAY express visual rendering information for the currently playing [=EPUB
						content document=] element in a CSS Style Sheet using author-defined classes.</p>

					<p>When used, EPUB creators MUST declare the class names in the [=package document=] using the <a
							href="#active-class"><code>active-class</code></a> and <a href="#playback-active-class"
								><code>playback-active-class</code></a> properties.</p>

					<p>EPUB creators MUST define exactly one CSS class name in each property they define. Each property
						MUST define a <a href="https://www.w3.org/TR/CSS2/syndata.html#characters">valid CSS class
							name</a> not including any <a href="https://www.w3.org/TR/CSS2/selector.html">selectors</a>
						[[css2]]. This specification <strong>does not</strong> reserve names for use with these
						properties.</p>

					<p>EPUB creators MAY define any CSS properties for the specified CSS classes but must ensure that
						each EPUB content document with an associated [=media overlay document=] includes a CSS
						stylesheet (either embedded or linked) containing the class definitions. In the absence of such
						definitions [=reading systems=] might provide their own styling, or no styling at all.</p>

					<p>EPUB creators MUST NOT use the <code>active-class</code> and <code>playback-active-class</code>
						properties in conjunction with a <a href="#attrdef-refines"><code>refines</code> attribute</a>
						as they always apply to the entire [=EPUB publication=].</p>

					<aside class="example" title="Associating style information with the
						currently playing EPUB content document">

						<p>The author-defined CSS class names are declared using the metadata properties <a
								href="#active-class"><code>active-class</code></a> and <a href="#playback-active-class"
									><code>playback-active-class</code></a> in the package document:</p>

						<pre>&lt;package …>
   &lt;metadata …>
      …
      &lt;meta
          property="media:active-class">
         my-active-item
      &lt;/meta>
      &lt;meta
          property="media:playback-active-class">
         my-document-playing
      &lt;/meta>
      …
   &lt;/metadata>
   …
&lt;/package></pre>

						<p>The CSS Style Sheet containing the author-defined class names:</p>

						<pre>/* emphasize the active element */
.my-active-item {
    background-color: yellow;
    color: black !important;
}

/* fade out the inactive text */
html.my-document-playing * {
    color: gray;
}
</pre>

						<p>The relevant EPUB content document excerpt:</p>

						<pre>&lt;html>
   …
   &lt;body>
      …
      &lt;span id="txt1">
         This is the first phrase.
      &lt;/span>
      &lt;span id="txt2">
         This is the second phrase.
      &lt;/span>
      &lt;span id="txt3">
         This is the third phrase.
      &lt;/span>
      …
   &lt;/body>
&lt;/html></pre>

						<p>In this example, the reading system would apply the author-defined
								<code>my-active-item</code> class to each text element in the EPUB content document as
							it became active during playback. Conversely, reading systems would remove the class name
							when the element is no longer active. The user would see each EPUB content document element
							styled with a yellow background for the duration of that element's playback.</p>

						<p>The reading system would also apply the author-defined <code>my-document-playing</code> class
							to the document element of the EPUB content document when media overlays playback begins.
							The reading system would remove the class name when playback stops. In the case of an
							[=XHTML content document=], the reading system would apply the class name to the [^html^]
							element [[?html]]. In the case of an [=SVG content document=], the reading system would
							apply the class name to the [^svg^] element [[svg]]. The user would see all the inactive
							text elements turn gray during media overlays playback. When playback stopped, the elements'
							colors would return to their defaults.</p>
					</aside>
				</section>

				<section id="sec-docs-package">
					<h4>Media overlays packaging</h4>

					<section id="sec-package-including">
						<h5>Including media overlays</h5>

						<p>If an [=EPUB content document=] is wholly or partially referenced by a [=media overlay
							document=], then its [=EPUB manifest | manifest=] [^item^] element MUST specify a
								<code>media-overlay</code> attribute. The attribute MUST reference the <a
								data-cite="xml#id">ID</a> [[xml]] of the manifest <code>item</code> for the
							corresponding media overlay document.</p>

						<p>[=EPUB creators=] MUST only specify the <code>media-overlay</code> attribute on manifest
								<code>item</code> elements that reference EPUB content documents.</p>

						<p>Manifest items for media overlay documents MUST have the media type
								<code>application/smil+xml</code>.</p>

						<aside class="example" title="Entries for an EPUB content document and its associated
							media overlay document in the package document manifest">
							<pre>&lt;package …>
   …
   &lt;manifest>
      &lt;item
          id="ch1" 
          href="chapter1.xhtml" 
          media-type="application/xhtml+xml" 
          media-overlay="ch1_audio"/>
   
      &lt;item
          id="ch1_audio" 
          href="chapter1_audio.smil" 
          media-type="application/smil+xml"/>
      …
   &lt;/manifest>
&lt;/package></pre>
						</aside>
					</section>

					<section id="sec-mo-package-metadata">
						<h5>Overlays package metadata</h5>

						<p id="total-duration">[=EPUB creators=] MUST specify the duration of the entire [=EPUB
							publication=] in the [=package document=] using a [^meta^] element with the <a
								href="#duration"><code>duration</code> property</a>.</p>

						<p>In addition, EPUB creators MUST provide the duration of each [=media overlay document=]. EPUB
							creators MUST use the <a href="#attrdef-refines"><code>refines</code> attribute</a> to
							associate each duration declaration to the corresponding [=EPUB manifest | manifest=]
							[^item^].</p>

						<p>The sum of the durations for each media overlay document SHOULD equal the <a
								href="#total-duration">total duration</a> plus or minus one second.</p>

						<div class="note">
							<p>Although the sum of indivudal durations may not exactly match the total due to rounding
								the times to nearest fraction of a second, a difference of greater than one second
								indicates a mismatch arising from other issues.</p>
						</div>

						<p>[=EPUB creators=] MAY also specify <a href="#narrator"><code>narrator</code></a> information
							in the package document, as well as <a href="#sec-docs-assoc-style">author-defined CSS class
								names</a> to apply to the currently playing [=EPUB content document=] element.</p>

						<div class="note">
							<p>The <code>media:</code> prefix is <a href="#sec-metadata-reserved-prefixes">reserved</a>
								for inclusion of these properties in package metadata.</p>
						</div>

						<aside class="example" title="Media overlays metadata in the package document">
							<pre>&lt;package …>
   &lt;metadata …>
      …
      &lt;meta
          property="media:duration"
          refines="#ch1_audio">
         0:32:29
      &lt;/meta>
      
      &lt;meta
          property="media:duration"
          refines="#ch2_audio">
         0:34:02
      &lt;/meta>
      
      &lt;meta
          property="media:duration"
          refines="#ch3_audio">
         0:29:49
      &lt;/meta>
      
      &lt;meta
          property="media:duration">
         1:36:20
      &lt;/meta>
      
      &lt;meta
          property="media:narrator">
         Joe Speaker
      &lt;/meta>
      
      &lt;meta
          property="media:active-class">
         my-active-item
      &lt;/meta>
      
      &lt;meta
          property="media:playback-active-class">
         my-document-playing
      &lt;/meta>
      …
   &lt;/metadata>
&lt;/package></pre>
						</aside>
					</section>
				</section>
			</section>

			<section id="sec-behaviors-skip-escape">
				<h3>Skippability and escapability</h3>

				<section id="sec-skippability">
					<h4>Skippability</h4>

					<p>While reading, users may want to turn on or off certain features of the content, such as
						footnotes, page numbers, or other types of secondary content. This feature is called
						skippability. [=Reading systems=] use the semantic information provided by media overlay
						elements' <a href="#sec-docs-structural-semantic"><code>epub:type</code></a> attribute to
						determine when to offer users the option of skippable features.</p>

					<p>[=EPUB creators=] MAY use the following semantics to enable skippability:</p>

					<ul>
						<li>
							<p><a data-cite="epub-ssv-11#footnote"><code>footnote</code></a> [[epub-ssv-11]]</p>
						</li>
						<li>
							<p><a data-cite="epub-ssv-11#endnote"><code>endnote</code></a> [[epub-ssv-11]]</p>
						</li>
						<li>
							<p><a data-cite="epub-ssv-11#pagebreak"><code>pagebreak</code></a> [[epub-ssv-11]]</p>
						</li>
					</ul>

					<p>This list is non-exhaustive, however. It represents terms from the Structural Semantics
						Vocabulary [[?epub-ssv-11]] for which reading systems are most likely to offer the option of
						skippability.</p>

					<aside class="example" title="Media overlay document with a page break">
						<p>In this example, a reading system could offer the user the option of turning on and off the
							page break/page number announcements, which are often cumbersome to listen to.</p>

						<p>Media overlay document:</p>

						<pre>&lt;smil
    xmlns="http://www.w3.org/ns/SMIL" 
    xmlns:epub="http://www.idpf.org/2007/ops"
    version="3.0">
   &lt;body>
      &lt;!-- a paragraph -->
      &lt;par id="id1">
         &lt;text
             src="chapter1.xhtml#para1"/>
         &lt;audio
             src="chapter1_audio.mp3"
             clipBegin="0:23:22.000"
             clipEnd="0:24:15.000"/>
      &lt;/par>

      &lt;!-- a page number -->
      &lt;par
          id="id2"
          epub:type="pagebreak">
         &lt;text
             src="chapter1.xhtml#pgbreak1"/>
         &lt;audio
             src="chapter1_audio.mp3"
             clipBegin="0:24:15.000"
             clipEnd="0:24:18.123"/>
      &lt;/par>

      &lt;!-- another paragraph -->
      &lt;par id="id3">
         &lt;text
             src="chapter1.xhtml#para2"/>
         &lt;audio
             src="chapter1_audio.mp3"
             clipBegin="0:24:18.123"
             clipEnd="0:25:28.530"/>
      &lt;/par>
   &lt;/body>
&lt;/smil>
</pre>

						<p>EPUB content document:</p>

						<pre>&lt;html … >
   …
   &lt;body>
      &lt;p id="para1">
         This is the paragraph before the page break …
      &lt;/p>
      
      &lt;span
          id="pgbreak1"
          role="doc-pagebreak"
          aria-label="14"/>
      
      &lt;p id="para2">
         This is the paragraph after the page break …
      &lt;/p>
   &lt;/body>
&lt;/html></pre>
					</aside>
				</section>

				<section id="sec-escapability">
					<h4>Escapability</h4>

					<p>Escapable items are nested structures, such as tables and lists, that users might wish to skip
						over, continuing to read from the point immediately after the nested structure. The escapability
						feature differs from the skippability feature in that it does not enable or disable entire types
						of items, but provides an exit from them (e.g., a user can listen to some of the content before
						choosing to escape).</p>

					<p>[=EPUB creators=] MAY use the following semantics to enable escapability:</p>

					<ul>
						<li>
							<p><a data-cite="epub-ssv-11#table"><code>table</code></a> [[epub-ssv-11]]</p>
						</li>
						<li>
							<p><a data-cite="epub-ssv-11#list"><code>list</code></a> [[epub-ssv-11]]</p>
						</li>
						<li>
							<p><a data-cite="epub-ssv-11#figure"><code>figure</code></a> [[epub-ssv-11]]</p>
						</li>
						<li>
							<p><a data-cite="epub-ssv-11#aside"><code>aside</code></a> [[epub-ssv-11]]</p>
						</li>
					</ul>

					<p>This list is non-exhaustive list, however. It represents terms from the Structural Semantics
						Vocabulary [[?epub-ssv-11]] for which [=reading systems=] are most likely to offer the option of
						escapability.</p>

					<div class="note">
						<p>Sometimes escapable structures may contain escapable structures. For example, tables are
							composed of many rows and cells that users may want to separately escape from. Reading
							system support for escaping from such structures is complex and not well supported at this
							time. EPUB creators should avoid identifying nested escapable structures until better
							support is available.</p>
					</div>

					<aside class="example" title="Escapable structures">
						<p>In this example, the [=media overlay document=] for an [=EPUB content document=] contains a
							paragraph, a table, and another paragraph. A reading system that supported escapability
							would give the user the option to interrupt playback of the table to continue playing the
							next paragraph.</p>

						<pre>&lt;smil
    xmlns="http://www.w3.org/ns/SMIL" 
    xmlns:epub="http://www.idpf.org/2007/ops"
    version="3.0">
   &lt;body>
      &lt;!-- a paragraph, part of the regular document text -->
      &lt;par id="id1">
         &lt;text
             src="c01.xhtml#para1"/>
         &lt;audio
             src="chapter1_audio.mp3"
             clipBegin="0:23:22.000"
             clipEnd="0:24:15.000"/>
      &lt;/par>

      &lt;!-- a table with two nested rows -->
      &lt;seq
          id="id2"
          epub:textref="c01.xhtml#t1"
          epub:type="table">
         
         &lt;seq
             id="id3"
             epub:textref="c01.xhtml#tr1"
             epub:type="table-row">
            
            &lt;par
                id="id4"
                epub:type="table-cell">
               &lt;text
                   src="c01.xhtml#td1"/>
               &lt;audio
                   src="chapter1_audio.mp3"
                   clipBegin="0:24:15.000"
                   clipEnd="0:24:18.123"/>
            &lt;/par>
            
            &lt;par
                id="id5"
                epub:type="table-cell">
               &lt;text
                   src="c01.xhtml#td2"/>
               &lt;audio
                   src="chapter1_audio.mp3"
                   clipBegin="0:24:18.123"
                   clipEnd="0:25:28.530"/>
            &lt;/par>
            
            &lt;par
                id="id6"
                epub:type="table-cell">
               &lt;text
                   src="c01.xhtml#td3"/>
               &lt;audio
                   src="chapter1_audio.mp3"
                   clipBegin="0:25:28.530"
                   clipEnd="0:25:45.515"/>
            &lt;/par>
         &lt;/seq>
         
         &lt;seq
             id="id7"
             epub:textref="c01.xhtml#tr2"
             epub:type="table-row">
            
            &lt;par
                id="id8"
                epub:type="table-cell">
               &lt;text
                   src="c01.xhtml#td4"/>
               &lt;audio
                   src="chapter1_audio.mp3"
                   clipBegin="0:25:45.515"
                   clipEnd="0:26:45.700"/>
            &lt;/par>
            
            &lt;par
                id="id9"
                epub:type="table-cell">
               &lt;text
                   src="chapter1.xhtml#td5"/>
               &lt;audio
                   src="chapter1_audio.mp3"
                   clipBegin="0:26:45.700"
                   clipEnd="0:28:02.033"/>
            &lt;/par>
            
            &lt;par
                id="id10"
                epub:type="table-cell">
               &lt;text
                   src="chapter1.xhtml#td6"/>
               &lt;audio
                   src="chapter1_audio.mp3"
                   clipBegin="0:28:02.033"
                   clipEnd="0:28:52.207"/>
            &lt;/par>
         &lt;/seq>
      &lt;/seq>

      &lt;!-- another paragraph -->
      &lt;par id="id11">
         &lt;text
             src="c01.xhtml#para2"/>
         &lt;audio
             src="chapter1_audio.mp3"
             clipBegin="0:28:52.207"
             clipEnd="0:30:01.000"/>
      &lt;/par>
   &lt;/body>
&lt;/smil></pre>
					</aside>
				</section>
			</section>

			<section id="sec-mo-nav-doc" class="informative">
				<h3>Navigation document overlays</h3>

				<p>As the [=EPUB navigation document=] is an [=XHTML content document=], [=EPUB creators=] may associate
					a [=media overlay document=] with it. Unlike traditional XHTML content documents, however, [=reading
					systems=] must present the EPUB navigation document to users even when it is not included in the
					[=EPUB spine | spine=] (see <a data-cite="epub-rs-33#sec-nav">Navigation document processing</a>
					[[epub-rs-33]]). As a result, the method in which an associated media overlay behaves can change
					depending on the context:</p>

				<ul>
					<li>
						<p>When included in the spine, playback of the EPUB navigation document's media overlay document
							obeys the same conformance requirements as with any other XHTML content document.</p>
					</li>
					<li>
						<p>When exposed in a presentation context that allows users to access and activate the links,
							reading systems may implement additional presentation behaviors to expose audio feedback
							when user access navigation links.</p>
					</li>
				</ul>
				<div class="note">
					<p>Specific implementation details are beyond the scope of this specification. The <a
							href="https://daisy.org/info-help/document-archive/archived-publications/media-overlays-playback-requirements/"
							>DAISY Media Overlays Playback Requirements</a> document describes best practices for [=EPUB
						creators=] and provides recommendations for reading system developers.</p>
				</div>
			</section>
		</section>
		<section id="sec-accessibility" class="informative">
			<h2>Accessibility</h2>

			<p>EPUB 3 builds upon the Open Web Platform expressly so that it can leverage the structure, semantics and,
				by extension, accessibility built into its underlying technologies.</p>

			<p>The requirements and practices for creating accessible web content have already been documented in the
				W3C's <a href="https://www.w3.org/TR/WCAG2/">Web Content Accessibility Guidelines (WCAG)</a> [[wcag2]].
				These guidelines also form the basis for defining accessibility in [=EPUB publications=].</p>

			<p>As the current WCAG guidelines (version 2) are heavily focused on web pages, a separate specification, <a
					data-cite="epub-a11y-11#">EPUB Accessibility</a> [[epub-a11y-11]], defines how to apply the standard
				to EPUB publications. It also adds EPUB-specific requirements and recommendations for metadata,
				pagination, and media overlays.</p>

			<p>This specification recommends that EPUB publications <a href="#confreq-a11y">conform to the accessibility
					requirements</a> defined in [[epub-a11y-11]]. A benefit of following this recommendation is that it
				helps to ensure that EPUB publications meet the accessibility requirements legislated in jurisdictions
				around the world.</p>

			<p>[=EPUB creators=], however, should look beyond legal imperatives and treat accessibility as a requirement
				for all their content. The more accessible that EPUB publications are, the greater the potential
				audience for them.</p>

			<div class="note">
				<p>This specification does not integrate the accessibility requirements to allow them to adapt and
					evolve independent of the EPUB specification &#8212; accessibility practices often need more
					frequent updating. The accessibility specification is also intended for use with past, present, and
					future versions of EPUB. The approach of a separate specification ensures that the evolution of EPUB
					does not lock accessibility in time (i.e., it allows producers of older versions of EPUB to
					reference the latest accessibility requirements).</p>
			</div>
		</section>
		<section id="sec-security-privacy">
			<h2>Security and privacy</h2>

			<section id="security-privacy-overview" class="informative">
				<h3>Overview</h3>

				<p>The particularity of an [=EPUB publication=] is its structure. The EPUB format provides a means of
					representing, packaging, and encoding structured and semantically enhanced web content — including
					HTML, CSS, SVG, JavaScript, and other resources — for distribution in a single-file container.</p>

				<p>This means that EPUB 3's security and privacy issues are primarily linked to the features of those
					formats, and closely mirror the threats presented by web content.</p>

				<p>Although content risks are often equated with deliberately malicious authoring intent, [=EPUB
					creators=] need to be aware that many practices followed with the best of intentions may expose
					users to privacy and security issues. The rest of this section explores the risk model of EPUB 3
					with the aim of helping EPUB creators recognize and mitigate these risks.</p>

				<div class="note">
					<p>For the risks associated with [=reading systems=], refer to the <a
							data-cite="epub-rs-33#sec-security-privacy">security and privacy section</a> of
						[[epub-rs-33]].</p>
				</div>
			</section>

			<section id="epub-threat-model" class="informative">
				<h3>Threat model</h3>

				<p>[=EPUB publications=] pose a variety of privacy and security threats to unsuspecting users. Many of
					these threats intersect with web content, but EPUB also introduces its own unique methods of attack
					that can be used to trick users into accessing malicious content or into providing sensitive
					information. Some of the more important attack vectors that [=EPUB creators=] and users need to be
					aware of include:</p>

				<dl>
					<dt>Embedding of remote resources</dt>
					<dd>
						<p>EPUB 3 allows some [=publication resources=] to be <a href="#sec-resource-locations">remotely
								hosted</a>, specifically resources whose sizes can negatively affect the downloading and
							opening of the EPUB publication (e.g., audio, video, and fonts). Although helpful for users
							when used as intended, these exemptions can also be used to inject malicious content into a
							publication.</p>
						<p>This threat is not limited to accessing content created by a bad actor. If EPUB creators
							embed content from untrustworthy sources (e.g., third party audio and video), there is
							always the possibility that users may receive compromised resources.</p>
						<p>Checking for malware and exploits at distribution time is not always reliable, either, as the
							malicious content can be swapped in any time after publication, unlike resources that come
							embedded in the [=EPUB container=].</p>
						<p>The <a href="#sec-container-iri">origin</a> of an EPUB is both unknown to the EPUB creator
							and specific to each reading system implementation. Consequently, if the EPUB creator hosts
							[=remote resources=] on a web server they control, the server effectively cannot use
							security features that require specifying allowable origins, such as headers for <a
								href="https://fetch.spec.whatwg.org/#cors-protocol">CORS</a>, <a
								href="https://www.w3.org/TR/CSP2/#content-security-policy-header-field"
									><code>Content-Security-Policy</code></a>, or <a
								href="https://www.rfc-editor.org/rfc/rfc7034"><code>X-Frame-Options</code></a>.</p>
					</dd>

					<dt>Linking to external resources</dt>
					<dd>
						<p>Whether intentional or not, links to external web sites and resources expose users to
							potential exploits that can compromise their reading system or operating system. Although
							external links will typically open in a web browser, and be subject to the browser security
							model, this does not protect users from all exploits.</p>
						<p>Even if the intentions of the EPUB creator are not malicious, adding tracking information to
							external links is problematic for user privacy as it can allow a user's activity to be
							tracked without their consent.</p>
						<p>Broken-link hijacking &#8212; when a domain expires and is bought by another party to exploit
							the links to it &#8212; can also lead to users being taken to resources the EPUB creator did
							not intend.</p>
					</dd>

					<dt>Including malicious content</dt>
					<dd>
						<p>Resources embedded in the EPUB container are not immune to malicious actors, especially when
							EPUB publications are obtained from untrusted sources. Resources may contain exploits or
							forms that may submit sensitive information to unintended parties. Such actors may also try
							to gain access to [=remote resources=] using file indirection techniques, such as symbolic
							links or file aliases. </p>
						<p>The use of third-party content, such as games and quizzes, may also lead to security and
							privacy issues if the EPUB creator is not able to fully vet the content.</p>
					</dd>

					<dt>Allowing scripts network access</dt>
					<dd>
						<p>When scripts can access a device's network, it provides a variety channels to exploit the
							user:</p>
						<ul>
							<li>collecting information about the user and their activities, whether malicious or
								not;</li>
							<li>attempting to access the file system and local storage to harvest information;</li>
							<li>phishing attempts (e.g., making an [=EPUB content document=] appear like a trusted web
								site to get the user to submit login information); and</li>
							<li>injecting malicious content from external sites into the EPUB publication.</li>
						</ul>
						<p>Network access may allow third-party content to exploit the user even if it was not the EPUB
							creator's intent.</p>
					</dd>

					<dt>Securing content with digital rights management</dt>
					<dd>
						<p>The encryption and decryption of EPUB publications using digital rights management schemes
							may allow personally identifiable information about the user, what vendors they use, and
							their reading choices to be relayed to third parties.</p>
					</dd>
				</dl>

				<p>The effectiveness of these attacks also often depends on tricking users into believing that the
					publication they are interacting with is from a trustworthy source. These deceptions can take the
					following forms:</p>

				<dl>
					<dt>Falsified publication information</dt>
					<dd>
						<p>The EPUB publication may include false information about itself to trick users into believing
							that it comes from a legitimate source. A malicious EPUB creator might, for example, fake
							the title, authors, identifiers, and publisher for the work.</p>
						<p>Although this misinformation itself does not present an immediate harm, it could lead users
							to trust malicious forms, links, and other content within the EPUB publication believing it
							comes from a reliable source.</p>
					</dd>

					<dt>Spoofed platforms</dt>
					<dd>
						<p>Malicious EPUB creators may also design their content to imitate or replicate a platform's
							experience to trick users into trusting their content.</p>
					</dd>
				</dl>

				<section id="privacy-security-epub-features">
					<h4>EPUB-specific features</h4>

					<p>EPUB 3 tries to avoid extending the underlying technologies it builds on, but it has introduced
						some new features. The restricted scope of these features limits the threats they might pose,
						however:</p>

					<ul>
						<li>
							<p><a href="#sec-xhtml-content-switch">Content switching</a> and <a
									href="#sec-xhtml-epub-trigger">multimedia control elements</a> only allow hiding of
								content and script-less control of playback in HTML. Moreover, these features,
								introduced in the first release of EPUB 3.0, are <a href="#deprecated">deprecated</a>
								and no longer recommended for use.</p>
						</li>
						<li>
							<p>The <a href="#sec-epub-type-attribute">expression of structural semantics</a> in HTML and
								SVG only allows the annotation of elements.</p>
						</li>
					</ul>

					<p>The one potential exception is the <a data-cite="epub-rs-33#app-epubReadingSystem"
								><code>epubReadingSystem</code> object</a> [[epub-rs-33]] that allows [=EPUB creators=]
						to query information about the current [=reading system=]. EPUB creators need to be mindful that
						they only use the information exposed by this object to improve the rendering of their content
						(i.e., avoid using the information to profile the user and their environment).</p>
				</section>
			</section>

			<section id="security-privacy-recommendations">
				<h3>Recommendations</h3>

				<p>Although [=EPUB creators=] cannot prevent every method of exploiting users, they are ultimately
					responsible for the secure construction of their content. That means that they need to take
					precautions to limit the exposure of their [=EPUB publications=] to the types of <a
						href="#epub-threat-model">malicious exploits</a> described in the previous section.</p>

				<p>Some practical steps include:</p>

				<ul>
					<li>Ensuring the use of stable links to [=remote resources=].</li>
					<li>Avoiding third-party resources, especially those hosted on servers outside the control of the
						EPUB creator.</li>
					<li>Avoiding links to untrustworthy web sites (e.g., that browsers do not recognize as safe).</li>
					<li>Using secure connections to external sites and resources (i.e., using the HTTPS protocol).</li>
					<li>Not using scripts to send or receive data over the network without the consent of the user.</li>
					<li>Obtaining user consent for the use of Web APIs with privacy implications, such as <a
							href="https://www.w3.org/TR/geolocation/">Geolocation</a> [[geolocation]] and <a
							href="https://www.w3.org/TR/push-api/">Push Notifications</a> [[push-api]].</li>
					<li>Avoiding embedding content not provided by reputable organizations or individuals.</li>
					<li>Avoiding deprecated features of EPUB due to the potential for undiscovered bugs in
						implementations.</li>
				</ul>

				<p>EPUB creators also need to consider the privacy rights of users and avoid situations where they are
					intentionally collecting data. Ideally, EPUB creators SHOULD NOT track their users, but this is not
					realistic for all types of publishing.</p>

				<p>When EPUB creators have to track users, they SHOULD obtain the approval of the user to collect
					information prior to opening the EPUB publication (e.g., in educational course work). If this is not
					possible, they SHOULD obtain permission when users access the EPUB publication for the first time.
					EPUB creators SHOULD also allow users to opt out of tracking, and provide users the ability to
					manage and delete any data that is collected about them.</p>

				<p>EPUB creators also need to consider the inadvertent collection of information about users. Linking to
					content on a publisher's web site, or remotely hosting resources on their servers, can lead to
					profiling users, especially if unique tracking identifiers are added to the URLs.</p>

				<p>When collecting and storing user information within an EPUB publication (e.g., through the use of <a
						data-cite="html#dom-document-cookie">cookies</a> and <a data-cite="html#webstorage">web
						storage</a> [[?html]]), EPUB creators need to consider to potential for data theft by other EPUB
					publications on a [=reading system=]. Although [[epub-rs-33]] introduces a <a
						data-cite="epub-rs-33#sec-container-iri">unique origin requirement</a> for EPUB publications,
					which limits the potential for attacks, there is still a risk that reading systems will allow EPUB
					publications access to shared persistent storage (e.g., older reading systems that have not been
					updated and non-conforming newer reading systems). Consequently, EPUB creators SHOULD NOT store
					sensitive user data in persistent storage. If EPUB creators must store sensitive data, they SHOULD
					encrypt the data to prevent trivial access to it in the case of an exploit.</p>

				<p>When publishers and vendors must use digital rights management schemes, they should prefer schemes
					that do not utilize or transmit information about the user or their content to external parties to
					perform encryption or decryption.</p>

				<p>To maximally reduce security and privacy risks, EPUB creators SHOULD produce their EPUB publications
					with the goal of long-term preservation. EPUB publications created this way are normally
					self-contained, not dependent on network access, and not encrypted with digital rights management,
					removing many of the possible attack vectors. [[?iso22424]] is an example of such a preservation
					format for EPUB publications. While it is understood that not all EPUB creators can achieve these
					levels of self-containment, following as many of these practices as possible will still benefit
					overall user privacy and security.</p>
			</section>
		</section>
		<section id="app-unsupported" class="appendix">
			<h2>Unsupported features</h2>

			<p>This specification contains certain features that are not yet fully supported in [=reading systems=],
				that the Working Group no longer recommends for use, or that are only retained for interoperability with
				EPUB 2 reading systems. This section defines the meanings of the designations attached to these features
				and their support expectations.</p>

			<section id="under-implemented">
				<h3>Under-implemented features</h3>

				<p>A <strong>under-implemented</strong> feature is a feature introduced prior to EPUB 3.3 for which the
					Working Group has not been able to establish enough <a
						href="https://www.w3.org/Consortium/Process/#adequate-implementation">implementation
						experience</a>.</p>

				<p>These features are considered important to retain despite this limitation because they are known to
					be implemented by [=EPUB creators=] (i.e., their deprecation would invalidate existing content)
					and/or they are integral to the content model on which EPUB is built.</p>

				<p>If this specification designates a feature as under-implemented, EPUB creators MAY use the features
					as described.</p>

				<div class="note">
					<p>[=EPUB conformance checkers=] should alert EPUB creators to the presence of under-implemented
						features when encountered in EPUB publications but must not treat their inclusion as a violation
						of the standard (i.e., not emit errors or warnings).</p>
				</div>

				<div class="caution">
					<p>Whether under-implemented labels are removed or replaced by deprecation in a future version of
						the standard cannot be determined at this time. EPUB creators should strongly consider the
						interoperability problems that may arise both now and in the future when using these
						features.</p>
				</div>

				<div class="note">
					<p>The marking of features as under-implemented is a one-time event to account for the different
						process under which EPUB was developed prior to being brought into W3C. This label will not be
						used for new features developed under W3C processes.</p>
				</div>
			</section>

			<section id="deprecated">
				<h3>Deprecated features</h3>

				<p>A <strong>deprecated</strong> feature is one the Working Group no longer recommends for use in this
					version of the specification. Deprecated features typically have limited or no support in [=reading
					systems=] and/or usage in [=EPUB publications=].</p>

				<p>If this specification designates a feature as deprecated, [=EPUB creators=] SHOULD NOT use the
					feature in their EPUB publications.</p>

				<div class="note">
					<p>[=EPUB conformance checkers=] should alert EPUB creators to the presence of deprecated features
						when encountered in EPUB publications.</p>
				</div>
			</section>
		</section>
		<section id="app-identifiers-allowed" class="appendix">
			<h2>Allowed external identifiers</h2>

			<p>The following table lists the <a aria-label="public identifiers" data-cite="xml#dt-pubid">public </a> and
					<a data-cite="xml#dt-sysid">system identifiers</a> [[xml]] allowed in <a data-cite="xml#dt-doctype"
					>document type declarations</a>. [[xml]]</p>

			<p>[=EPUB creators=] MAY use these external identifiers only in [=publication resources=] with the listed
				media types [[rfc2046]] specified in their [=EPUB manifest | manifest=] declarations. (Refer to <a
					href="#sec-xml-constraints"></a> for more information.)</p>

			<table class="zebra">
				<thead>
					<tr>
						<th>Media Type(s)</th>
						<th>Public Identifier</th>
						<th>System Identifier</th>
					</tr>
				</thead>
				<tbody>
					<tr>
						<td>
							<ul class="flat">
								<li>
									<code>application/mathml+xml</code>
								</li>
								<li>
									<code>application/mathml-presentation+xml</code>
								</li>
								<li>
									<code>application/mathml-content+xml</code>
								</li>
							</ul>
						</td>
						<td>
							<code>-//W3C//DTD MathML 3.0//EN</code>
						</td>
						<td>
							<code>http://www.w3.org/Math/DTD/mathml3/mathml3.dtd</code>
						</td>
					</tr>
					<tr>
						<td>
							<code>application/x-dtbncx+xml</code>
						</td>
						<td>
							<code>-//NISO//DTD ncx 2005-1//EN</code>
						</td>
						<td>
							<code>http://www.daisy.org/z3986/2005/ncx-2005-1.dtd</code>
						</td>
					</tr>
					<tr>
						<td>
							<code>image/svg+xml</code>
						</td>
						<td>
							<code>-//W3C//DTD SVG 1.1//EN</code>
						</td>
						<td>
							<code>http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd</code>
						</td>
					</tr>
				</tbody>
			</table>
		</section>
		<section id="app-structural-semantics" class="appendix">
			<h2>Expressing structural semantics</h2>

			<section id="sec-structural-semantics-intro" class="informative">
				<h3>Introduction</h3>

				<p>Structural semantics add additional meaning about the specific structural purpose an element plays.
					The [^/epub:type^] attribute is used to express domain-specific semantics in [=EPUB content
					documents=] and [=media overlay documents=], with the structural information it carries
					complementing the underlying vocabulary.</p>

				<p>The applied semantics refine the meaning of their containing elements without changing their nature
					for assistive technologies, as happens when using the similar [^/role^] attribute [[html]]. The
					attribute does not enhance the accessibility of the content, in other words; it only provides hints
					about the purpose.</p>

				<p>Semantic metadata enriches content for use in publishing workflows and for author-defined purposes.
					It also allows [=reading systems=] to learn more about the structure and content of a document
					(e.g., to enable <a href="#sec-behaviors-skip-escape">skippability and escapability</a> in media
					overlays).</p>

				<p>This specification defines a method for adding structural semantics using <em>the attribute
					axis</em>: instead of adding new elements, [=EPUB creators=] can append the <code>epub:type</code>
					attribute to existing elements to add the desired semantics.</p>
			</section>

			<section id="sec-epub-type-attribute">
				<h3>The <code>epub:type</code> attribute</h3>

				<dl class="elemdef" id="attrdef-epub-type">
					<dt>Attribute Name:</dt>
					<dd>
						<p>
							<dfn class="export" data-lt-no-plural="" data-dfn-type="element-attr"
								><code>epub:type</code></dfn>
						</p>
					</dd>

					<dt>Namespace:</dt>
					<dd>
						<p>
							<code>http://www.idpf.org/2007/ops</code>
						</p>
					</dd>

					<dt>Usage:</dt>
					<dd>
						<p>Refer to the requirements for <a href="#sec-xhtml-structural-semantics">XHTML</a>, <a
								href="#confreq-svg-structural-semantics">SVG</a>, and <a href="#sec-overlays-def">media
								overlays</a>.</p>
					</dd>

					<dt>Value:</dt>
					<dd>
						<p>A white space-separated list of <a href="#sec-property-datatype">property</a> values, with
							restrictions as defined in <a href="#sec-vocab-assoc"></a>.</p>
						<p>White space is the set of characters as defined in [[xml]].</p>
					</dd>
				</dl>

				<div class="caution">
					<p>Although the <code>epub:type</code> attribute is similar in nature to the [^/role^]
						attribute [[html]], the attributes serve different purposes. The values of the
							<code>epub:type</code> attribute do not enhance access through assistive technologies like
						screen readers as they do not map to the accessibility <abbr
							title="Application Programming Interfaces">APIs</abbr> used by these technologies. This
						means that adding <code>epub:type</code> values to semantically neutral elements like [[html]]
						[^div^] and [^span^] does not make them any more accessible to assistive technologies. Only ARIA
						roles influence how assistive technologies understand such elements.</p>

					<p>The <code>epub:type</code> attribute is consequently only intended for publishing semantics and
						[=reading system=] enhancements. Reading systems may use <code>epub:type</code> values to
						provide accessibility enhancements like built-in read aloud or media overlays functionality
						where interaction with assistive technologies is not essential.</p>

					<p>Refer to <a href="https://www.w3.org/TR/dpub-aria/">Digital Publishing WAI-ARIA
						Module</a> [[?dpub-aria]] for more information about accessible publishing roles.</p>
				</div>

				<p>The <code>epub:type</code> attribute inflects semantics on the element on which it appears. Its value
					is one or more white space-separated terms stemming from external vocabularies associated with the
					document instance.</p>

				<p>The <a href="#sec-default-vocab">default vocabulary</a> for the <code>epub:type</code> attribute is
					the EPUB 3 Structural Semantics Vocabulary [[?epub-ssv-11]]. EPUB creators MAY include unprefixed
					terms that are not part of this vocabulary, but the preferred method for adding custom semantics is
					to use <a href="#sec-prefix-attr">prefixes</a> for them. Refer to <a href="#sec-vocab-assoc"></a>
					for more information.</p>

				<aside class="example" id="ex.epubtype.note" title="Identifying a preamble">
					<pre>&lt;html
    …
    xmlns:epub="http://www.idpf.org/2007/ops">
   …
   &lt;body>
      …
      &lt;section epub:type="preamble">
         …    
      &lt;/section>
      …
   &lt;/body>
&lt;/html></pre>
				</aside>

				<aside class="example" id="ex.epubtype.gloss" title="Identifying a glossary">
					<pre>&lt;html
    …
    xmlns:epub="http://www.idpf.org/2007/ops">
   …
   &lt;body>
      …
      &lt;dl epub:type="glossary">
         …    
      &lt;/dl>        
      …
   &lt;/body>
&lt;/html></pre>
				</aside>

				<aside class="example" id="ex.epubtype.pg" title="Adding page break semantics">
					<pre>&lt;html
    …
    xmlns:epub="http://www.idpf.org/2007/ops">
   …
   &lt;body>
      …
      &lt;p>
         … 
         &lt;span
            epub:type="pagebreak"
            id="p234"
            role="doc-pagebreak"
            aria-label="234"/>
         …
      &lt;/p>    
      …
   &lt;/body>
&lt;/html></pre>
				</aside>
			</section>
		</section>
		<section id="app-vocabs" class="appendix">
			<h2>Vocabularies</h2>

			<p>This appendix defines a general set of mechanisms by which attributes in this specification can reference
				terms from vocabularies. It also defines EPUB-specific vocabularies for use with the attributes.</p>

			<section id="sec-vocab-assoc">
				<h3>Vocabulary association mechanisms</h3>

				<section id="sec-vocab-assoc-intro" class="informative">
					<h4>Introduction</h4>

					<p>EPUB defines a formal method of referencing terms and properties defined in metadata and semantic
						vocabularies using the <a href="#sec-property-datatype"><var>property</var> data type</a>. The
							<code>epub:type</code> attribute uses this data type in [=EPUB content documents=] and
						[=media overlay documents=] to add <a href="#app-structural-semantics">structural semantics</a>,
						for example, while the <code>property</code> and <code>rel</code> attributes use the data type
						to define properties and relationships in the [=package document=].</p>

					<p>A <var>property</var> value is like a CURIE [[rdfa-core]] &#8212; it represents a URL [[url]] in
						compact form. The expression consists of a prefix and a reference, where the prefix — whether
						literal or implied — is a shorthand mapping of a URL that typically resolves to a term
						vocabulary. When a [=reading system=] converts the prefix to its URL representation and combines
						with the reference, the resulting URL normally resolves to a fragment within that vocabulary
						that contains human- and/or machine-readable information about the term.</p>

					<p>To reduce the complexity for authoring, each attribute that takes a <var>property</var> data type
						also defines a <a href="#sec-default-vocab">default vocabulary</a>. Terms and properties
						referenced from the default vocabularies do not include a prefix as the mapping reading systems
						use to map to a URL is predefined.</p>

					<p>The power of the <var>property</var> data type lies in its easy extensibility. To incorporate new
						terms and properties, [=EPUB creators=] only need to declare a <a href="#sec-prefix-attr"
							>prefix</a>. In another authoring convenience, this specification also <a
							href="#sec-metadata-reserved-prefixes">reserves prefixes</a> for many commonly used
						publishing vocabularies (i.e., their declaration is optional).</p>

					<p>The following sections provide additional details on the <var>property</var> data type and
						vocabulary association mechanism.</p>
				</section>

				<section id="sec-property-datatype">
					<h4>The <var>property</var> data type</h4>

					<p>The <var>property</var> data type is a compact means of expressing a URL [[url]] and consists of
						an OPTIONAL prefix separated from a reference by a colon.</p>

					<table class="productionset">
						<caption>(EBNF productions <a href="https://www.iso.org/standard/26153.html">ISO/IEC
							14977</a>)<br /> All terminal symbols are in the Unicode Block 'Basic Latin' (U+0000 to
							U+007F).</caption>
						<tr>
							<td id="property.ebnf.property">
								<a href="#property.ebnf.property">property</a>
							</td>
							<td>
								<code>=</code>
							</td>
							<td>[ <a href="#property.ebnf.prefix">prefix</a> , ":" ] , <a
									href="#property.ebnf.reference">reference</a>; </td>
							<td> </td>
						</tr>
						<tr>
							<td id="property.ebnf.prefix">
								<a href="#property.ebnf.prefix">prefix</a>
							</td>
							<td>
								<code>=</code>
							</td>
							<td>? xsd:NCName ? ;</td>
							<td> </td>
						</tr>
						<tr>
							<td id="property.ebnf.reference">
								<a href="#property.ebnf.reference">reference</a>
							</td>
							<td>
								<code>=</code>
							</td>
							<td>? [=path-relative-scheme-less-URL string=] [[url]] ? ;</td>
							<td>/* as defined in [[url]] */<br /></td>
						</tr>
					</table>

					<p>This specification derives the <var>property</var> data type from the CURIE data type defined in
						[[rdfa-core]]. A <var>property</var> represents a subset of CURIEs.</p>

					<p>There are two key differences from CURIEs, however:</p>

					<ul>
						<li>
							<p>an empty <var>reference</var> does not represent a valid <var>property</var> value even
								though it is valid to the definition above (i.e., a <var>property</var> value that only
								consists of a prefix and colon is invalid).</p>
						</li>
						<li>
							<p>an empty string does not represent a valid <var>property</var> even though it is valid to
								the definition above.</p>
						</li>
					</ul>

					<aside class="example" title="Expanding a metadata property value">
						<p>In this example, the <var>property</var> value is composed of the prefix <code>dcterms</code>
							and the reference <code>modified</code>.</p>

						<pre>&lt;meta property="dcterms:modified">2011-01-01T12:00:00Z&lt;/meta></pre>

						<p>After <a data-cite="epub-rs-33#sec-property-values">processing</a> [[epub-rs-33]], this
							property would expand to the following URL:</p>

						<pre class="nohighlight">http://purl.org/dc/terms/modified</pre>

						<p>as the <code>dcterms:</code> prefix is a <a href="#sec-metadata-reserved-prefixes">reserved
								prefix</a> that maps to the URL "<code>http://purl.org/dc/terms/</code>".</p>
					</aside>

					<p>When an [=EPUB creator=] omits a prefix from a <var>property</var> value, the expressed reference
						represents a term from the <a href="#sec-default-vocab">default vocabulary</a> for that
						attribute.</p>

					<aside class="example" title="Expanding a manifest property value">
						<p>In this example, the <a href="#mathml"><code>mathml</code> property</a> is specified on a
							manifest [^item^] element:</p>

						<pre>&lt;item … properties="mathml"/></pre>

						<p>This property expands to:</p>

						<pre>http://idpf.org/epub/vocab/package/item/#mathml</pre>

						<p>when the prefix URL for the vocabulary is concatenated with the reference.</p>
					</aside>
				</section>

				<section id="sec-default-vocab">
					<h5>Default vocabularies</h5>

					<p>A default vocabulary is one that [=EPUB creators=] do not have to declare a <a
							href="#sec-prefix-attr">prefix</a> for in order to use its terms and properties where a <a
							href="#sec-property-datatype"><var>property</var> value</a> is expected. EPUB creators MUST
						NOT add a prefix to terms and properties from a default vocabulary.</p>

					<p>EPUB creators MUST NOT assign a prefix to the URLs associated with these vocabularies using the
							<a href="#sec-prefix-attr"><code>prefix</code></a> attribute.</p>

					<div class="note">
						<p>Refer to the definition of each attribute that takes a <a href="#sec-property-datatype"
									><var>property</var> data type</a> for more information about its default
							vocabulary.</p>
					</div>
				</section>

				<section id="sec-prefix-attr">
					<h4>The <code>prefix</code> attribute</h4>

					<p>The <code>prefix</code> attribute defines prefix mappings for use in <a
							href="#sec-property-datatype"><var>property</var> values</a>.</p>

					<p>The value of the <code>prefix</code> attribute is a white space-separated list of one or more
						prefix-to-URL mappings of the form:</p>

					<table class="productionset">
						<caption>(EBNF productions <a href="https://www.iso.org/standard/26153.html">ISO/IEC
							14977</a>)<br /> All terminal symbols are in the Unicode Block 'Basic Latin' (U+0000 to
							U+007F).</caption>
						<tr>
							<td id="prefix.ebnf.def">
								<a href="#prefix.ebnf.def">prefixes</a>
							</td>
							<td>
								<code>=</code>
							</td>
							<td><a href="#prefix.ebnf.mapping">mapping</a> , { <a href="#prefix.ebnf.whitespace"
									>whitespace</a>, { <a href="#prefix.ebnf.space">whitespace</a> } , <a
									href="#prefix.ebnf.mapping">mapping</a> } ; </td>
							<td> </td>
						</tr>
						<tr>
							<td id="prefix.ebnf.mapping">
								<a href="#prefix.ebnf.mapping">mapping</a>
							</td>
							<td>
								<code>=</code>
							</td>
							<td><a href="#prefix.ebnf.prefix">prefix</a> , ":" , <a href="#prefix.ebnf.space">space</a>
								, { <a href="#prefix.ebnf.space">space</a> } , ? xsd:anyURI ? ; </td>
							<td> </td>
						</tr>
						<tr>
							<td id="prefix.ebnf.prefix">
								<a href="#prefix.ebnf.prefix">prefix</a>
							</td>
							<td>
								<code>=</code>
							</td>
							<td>? xsd:NCName ? ;</td>
							<td> </td>
						</tr>
						<tr>
							<td id="prefix.ebnf.space">
								<a href="#prefix.ebnf.space">space</a>
							</td>
							<td>
								<code>=</code>
							</td>
							<td>#x20 ;</td>
							<td> </td>
						</tr>
						<tr>
							<td id="prefix.ebnf.whitespace">
								<a href="#prefix.ebnf.whitespace">whitespace</a>
							</td>
							<td>
								<code>=</code>
							</td>
							<td>(#x20 | #x9 | #xD | #xA) ;</td>
							<td> </td>
						</tr>
					</table>

					<p>With the exception of <a href="#sec-reserved-prefixes">reserved prefixes</a>, [=EPUB creators=]
						MUST declare all prefixes used in a document. [=EPUB creators=] MUST only specify the
							<code>prefix</code> attribute on the <a data-cite="xml#dt-root">root element</a> [[xml]] of
						the respective format.</p>

					<p>The attribute is not namespaced when used in the [=package document=].</p>

					<aside class="example" title="Declaring prefixes in the package document">
						<p>In this example, the EPUB creator declares prefixes for the Friend of a Friend
								(<code>foaf</code>) and DBPedia (<code>dbp</code>) vocabularies.</p>

						<pre>&lt;package
    … 
    prefix="foaf: http://xmlns.com/foaf/spec/
            dbp: http://dbpedia.org/ontology/">
   …
&lt;/package></pre>
					</aside>

					<p>EPUB creators MUST declare the attribute in the namespace
							<code>http://www.idpf.org/2007/ops</code> in [=EPUB content documents=] and [=media overlay
						documents=].</p>

					<aside class="example" title="Declaring prefixes in an XHTML content document">
						<p>In this example, the EPUB creator declares a prefix for the Z39.98 Structural Semantics
							Vocabulary.</p>

						<pre>&lt;html …
      xmlns:epub="http://www.idpf.org/2007/ops"
      epub:prefix="z3998: https://www.daisy.org/z3998/2012/vocab/structure/">
   …
&lt;/html></pre>
					</aside>

					<div class="note">
						<p>Although the <code>prefix</code> attribute is modeled on the identically named
								<code>prefix</code> attribute in [[rdfa-core]], EPUB creators cannot use the attributes
							interchangeably. The <code>prefix</code> attribute without a namespace in EPUB content
							documents is the RDFa attribute.</p>

						<p>It is common for both attributes to appear in EPUB content documents that also specify RDFa
							expressions.</p>

						<pre>&lt;html … prefix="…"
        xmlns:epub="http://www.idpf.org/2007/ops"
        epub:prefix="…">   …
&lt;/html></pre>
					</div>

					<p>Note that for <a href="#sec-xhtml-svg">embedded SVG</a>, prefixes MUST be declared on the
						[[html]] root [^html^] element.</p>

					<p>To avoid conflicts, EPUB creators MUST NOT use the <code>prefix</code> attribute to declare a
						prefix that maps to a <a href="#sec-default-vocab">default vocabulary</a>.</p>

					<p>EPUB creators MUST NOT declare the prefix '_' as this specification reserves this prefix for
						future compatibility with RDFa [[rdfa-core]] processing.</p>

					<p>For future compatibility with alternative serializations of the package document, EPUB creators
						MUST NOT declare a prefix for the Dublin Core <em>/elements/1.1/</em> namespace [[dcterms]].
						[=EPUB creators=] MUST use only the [[dcterms]] elements <a href="#sec-pkg-metadata">allowed in
							the package document metadata</a>.</p>
				</section>

				<section id="sec-reserved-prefixes">
					<h4>Reserved prefixes</h4>

					<div class="caution">
						<p>Although reserved prefixes are an authoring convenience, [=EPUB creators=] should avoid
							relying on them as they may cause interoperability issues. [=EPUB conformance checkers=]
							will often reject new prefixes until their developers update the tools to the latest version
							of the specification, for example. EPUB creators should declare all prefixes they use to
							avoid such issues.</p>
					</div>

					<p>[=EPUB creators=] MAY use reserved prefixes in attributes that expect a <a
							href="#sec-property-datatype"><var>property</var> value</a> without declaring them in a <a
							href="#sec-prefix-attr"><code>prefix</code> attribute</a>.</p>


					<p>EPUB creators SHOULD NOT override reserved prefixes in the <a href="#sec-prefix-attr"
								><code>prefix</code> attribute</a>.</p>

					<p>The reserved prefixes an EPUB creators can use depends on the context:</p>

					<dl class="conformance-list">
						<dt>Package document</dt>
						<dd id="sec-metadata-reserved-prefixes">
							<p>EPUB creators MAY use the following prefixes in [=package document=] attributes without
								having to declare them.</p>
							<table id="tbl-pkg-reserved-prefixes" class="prefix">
								<thead>
									<tr>
										<th>Prefix</th>
										<th>URL</th>
									</tr>
								</thead>
								<tbody>
									<tr>
										<td>a11y</td>
										<td>http://www.idpf.org/epub/vocab/package/a11y/#</td>
									</tr>
									<tr>
										<td>dcterms</td>
										<td>http://purl.org/dc/terms/</td>
									</tr>
									<tr>
										<td>marc</td>
										<td>http://id.loc.gov/vocabulary/</td>
									</tr>
									<tr>
										<td>media</td>
										<td>http://www.idpf.org/epub/vocab/overlays/#</td>
									</tr>
									<tr>
										<td>onix</td>
										<td>http://www.editeur.org/ONIX/book/codelists/current.html#</td>
									</tr>
									<tr>
										<td>rendition</td>
										<td>http://www.idpf.org/vocab/rendition/#</td>
									</tr>
									<tr>
										<td>schema</td>
										<td>http://schema.org/</td>
									</tr>
									<tr>
										<td>xsd</td>
										<td>http://www.w3.org/2001/XMLSchema#</td>
									</tr>
								</tbody>
							</table>
						</dd>

						<dt id="sec-content-reserved-prefixes">Structural Semantics</dt>
						<dd>
							<p>EPUB creators MAY use the following reserved prefixes in the <a
									href="#app-structural-semantics"><code>epub:type</code> attribute</a> without having
								to declare them.</p>
							<table id="tbl-reserved-prefixes" class="prefix">
								<thead>
									<tr>
										<th>Prefix</th>
										<th>URL</th>
									</tr>
								</thead>
								<tbody>
									<tr>
										<td>msv</td>
										<td>http://www.idpf.org/epub/vocab/structure/magazine/#</td>
									</tr>
									<tr>
										<td>prism</td>
										<td>http://www.prismstandard.org/specifications/3.0/PRISM_CV_Spec_3.0.htm#</td>
									</tr>
								</tbody>
							</table>
						</dd>
					</dl>
				</section>
			</section>

			<section id="sec-property-field-definitions">
				<h3>Property field definitions</h3>

				<p>The fields in the vocabulary definition tables have the following implicit requirements:</p>

				<dl>
					<dt>Allowed Values</dt>
					<dd>
						<p>Specifies the REQUIRED type of value using [[!xmlschema-2]] datatypes.</p>
					</dd>

					<dt>Applies To</dt>
					<dd>
						<p>Specifies which publication resource type(s) [=EPUB creators=] MAY specify the property
							on.</p>
						<p>This field appears for properties used in the <a href="#attrdef-properties"
									><code>properties</code> attribute</a>.</p>
					</dd>

					<dt>Cardinality</dt>
					<dd>
						<p>Specifies the number of times EPUB creators MAY specify the property, whether globally or
							attached to another element or property.</p>
						<p>Properties with a minimum cardinality of one MUST be specified.</p>
					</dd>

					<dt>Description</dt>
					<dd>
						<p>Describes the purpose of the property and specifies any additional usage requirements that
							EPUB creators must follow.</p>
					</dd>

					<dt>Example</dt>
					<dd>
						<p>Provides non-normative usage examples.</p>
					</dd>

					<dt>Extends</dt>
					<dd>
						<p>Identifies what EPUB creators MAY associate the property with.</p>
						<p>This field appears for properties that define <a href="#meta-expr-types">primary expressions
								and subexpressions</a> and <a href="#attrdef-link-rel">relationships</a>.</p>
					</dd>

					<dt>Name</dt>
					<dd>
						<p>Specifies the name of the property as it MUST appear in the metadata.</p>
					</dd>
				</dl>
			</section>

			<div data-include="vocab/meta-property.html" data-oninclude="fixIncludes" data-include-replace="true"></div>

			<div data-include="vocab/link.html" data-oninclude="fixIncludes" data-include-replace="true"></div>

			<div data-include="vocab/rendering.html" data-oninclude="fixIncludes" data-include-replace="true"></div>

			<div data-include="vocab/item-properties.html" data-oninclude="fixIncludes" data-include-replace="true"></div>

			<div data-include="vocab/itemref-properties.html" data-oninclude="fixIncludes" data-include-replace="true"></div>

			<div data-include="vocab/overlays.html" data-oninclude="fixIncludes" data-include-replace="true"></div>
		</section>
		<section id="css-prefixes" class="appendix">
			<h2>Prefixed CSS properties</h2>

			<p>This appendix describes the prefixed CSS properties supported by EPUB. </p>

			<p class="note">The prefix definitions are no longer being synchronized with their CSS counterparts. In some
				cases, the unprefixed versions of these properties now support additional values. [=Reading systems=]
				may not support the new syntax with the prefixed properties, so [=EPUB creators=] are advised to use the
				unprefixed versions for newer features.</p>

			<section id="sec-css-prefixed-writing-modes">
				<h5>CSS writing modes</h5>

				<p>This section describes the <code>-epub-</code> prefixed properties for [[css-writing-modes-3]].</p>

				<section id="sec-css-prefixed-writing-modes-text-orientation" data-tests="#css-epub-text-orientation">
					<h6>The <code>-epub-text-orientation</code> property</h6>

					<p>This property is a prefixed version of the <a
							data-cite="css-writing-modes-3#propdef-text-orientation"><code>text-orientation</code>
							property</a> [[css-writing-modes-3]].</p>

					<table class="tabledef">
						<tbody>
							<tr>
								<th>Name: </th>
								<td><code>-epub-text-orientation</code></td>
							</tr>
							<tr class="value">
								<th>Value:</th>
								<td> mixed | upright | sideways | sideways-right </td>
							</tr>
						</tbody>
					</table>

					<p>For compatibility with existing content, the <code>-epub-text-orientation</code> property also
						supports the deprecated <code>vertical-right</code>, <code>rotate-right</code>, and
							<code>rotate-normal</code> keywords. The following table specifies the effect these have
						when specified.</p>

					<table class="data">
						<thead>
							<tr>
								<th>Deprecated value</th>
								<th>Value to be used</th>
							</tr>
						</thead>
						<tbody>
							<tr>
								<td><code>vertical-right</code></td>
								<td><code>mixed</code></td>
							</tr>
							<tr>
								<td><code>rotate-right</code></td>
								<td><code>sideways</code></td>
							</tr>
							<tr>
								<td><code>rotate-normal</code></td>
								<td><code>sideways</code></td>
							</tr>
						</tbody>
					</table>
				</section>

				<section id="sec-css-prefixed-writing-modes-writing-mode" data-tests="#css-epub-writing-mode">
					<h6>The <code>-epub-writing-mode</code> property</h6>

					<p>This property is a prefixed version of the <a
							data-cite="css-writing-modes-3#propdef-writing-mode"><code>writing-mode</code> property</a>
						[[css-writing-modes-3]], with the same syntax and behavior.</p>

					<table class="tabledef">
						<tbody>
							<tr>
								<th>Name: </th>
								<td><code>-epub-writing-mode</code></td>
							</tr>
							<tr class="value">
								<th>Value:</th>
								<td> horizontal-tb | vertical-rl | vertical-lr </td>
							</tr>
						</tbody>
					</table>
				</section>

				<section id="sec-css-prefixed-writing-modes-text-combine" data-tests="#css-epub-text-combine-horizontal">
					<h6>The <code>-epub-text-combine-horizontal</code> and <code>-epub-text-combine</code>
						properties</h6>

					<p>These properties are prefixed versions of the <a
							data-cite="css-writing-modes-3#text-combine-upright"><code>text-combine-upright</code>
							property</a> [[css-writing-modes-3]], although <code>-epub-text-combine</code> is
						deprecated.</p>

					<table class="tabledef">
						<tbody>
							<tr>
								<th>Name: </th>
								<td><code>-epub-text-combine-horizontal</code></td>
							</tr>
							<tr class="value">
								<th>Value:</th>
								<td> none | all </td>
							</tr>
						</tbody>
					</table>

					<table class="tabledef">
						<tbody>
							<tr>
								<th>Name: </th>
								<td><code>-epub-text-combine</code> (deprecated)</td>
							</tr>
							<tr class="value">
								<th>Value:</th>
								<td> none | horizontal | horizontal &lt;number> </td>
							</tr>
						</tbody>
					</table>

					<p>For compatibility with existing content, the <code>-epub-text-combine-horizontal</code> and
							<code>-epub-text-combine</code> properties also support a number of deprecated keywords. The
						following table specifies the effect these have when specified.</p>

					<table class="data">
						<thead>
							<tr>
								<th>Prefixed version</th>
								<th>CSS equivalent</th>
							</tr>
						</thead>
						<tbody>
							<tr>
								<td><code>-epub-text-combine-horizontal: none</code></td>
								<td><code>text-combine-upright: none</code></td>
							</tr>
							<tr>
								<td><code>-epub-text-combine-horizontal: all</code></td>
								<td><code>text-combine-upright: all</code></td>
							</tr>
							<tr>
								<td><code>-epub-text-combine: none</code></td>
								<td><code>text-combine-upright: none</code></td>
							</tr>
							<tr>
								<td><code>-epub-text-combine: horizontal</code></td>
								<td><code>text-combine-upright: all</code></td>
							</tr>
							<tr>
								<td><code>-epub-text-combine: horizontal &lt;number></code></td>
								<td><em>no equivalent</em></td>
							</tr>
						</tbody>
					</table>
				</section>
			</section>

			<section id="sec-css-prefixed-text">
				<h5>CSS text level 3</h5>

				<p>This section describes the <code>-epub-</code> prefixed properties (and one prefixed value) for
					[[css-text-3]].</p>

				<section id="sec-css-prefixed-text-epub-hyphens" data-tests="#css-epub-hyphens">
					<h6>The <code>-epub-hyphens</code> property</h6>

					<p>This property is a prefixed version of the <a data-cite="css-text-3#hyphens-property"
								><code>hyphens</code> property</a> [[css-text-3]].</p>

					<table class="tabledef">
						<tbody>
							<tr>
								<th>Name: </th>
								<td><code>-epub-hyphens</code></td>
							</tr>
							<tr class="value">
								<th>Value:</th>
								<td> none | manual | auto | all </td>
							</tr>
						</tbody>
					</table>

					<p>For compatibility with existing content, the <code>-epub-hyphens</code> property also supports
						the deprecated <code>all</code> keyword. The value is no longer supported in CSS and there is no
						equivalent to use in its place.</p>
				</section>

				<section id="sec-css-prefixed-text-epub-line-break" data-tests="#css-epub-line-break">
					<h6>The <code>-epub-line-break</code> property</h6>

					<p>This property is a prefixed version of the <a data-cite="css-text-3#line-break-property"
								><code>line-break</code> property</a> [[css-text-3]].</p>

					<table class="tabledef">
						<tbody>
							<tr>
								<th>Name: </th>
								<td><code>-epub-line-break</code></td>
							</tr>
							<tr class="value">
								<th>Value:</th>
								<td> auto | loose | normal | strict </td>
							</tr>
						</tbody>
					</table>
				</section>

				<section id="sec-css-prefixed-text-epub-text-align-last" data-tests="#css-epub-text-align-last">
					<h6>The <code>-epub-text-align-last</code> property</h6>

					<p>This property is a prefixed version of the <a data-cite="css-text-3#text-align-last-property"
								><code>text-align-last</code> property</a> [[css-text-3]].</p>

					<table class="tabledef">
						<tbody>
							<tr>
								<th>Name: </th>
								<td><code>-epub-text-align-last</code></td>
							</tr>
							<tr class="value">
								<th>Value:</th>
								<td> auto | start | end | left | right | center | justify </td>
							</tr>
						</tbody>
					</table>
				</section>

				<section id="sec-css-prefixed-text-epub-word-break" data-tests="#css-epub-word-break">
					<h6>The <code>-epub-word-break</code> property</h6>

					<p>This property is a prefixed version of the <a data-cite="css-text-3#word-break-property"
								><code>word-break</code> property</a> [[css-text-3]].</p>

					<table class="tabledef">
						<tbody>
							<tr>
								<th>Name: </th>
								<td><code>-epub-word-break</code></td>
							</tr>
							<tr class="value">
								<th>Value:</th>
								<td> normal | keep-all | break-all </td>
							</tr>
						</tbody>
					</table>
				</section>

				<section id="sec-css-prefixed-text-text-transform" data-tests="#css-epub-text-transform">
					<h6>The <code>text-transform</code> property</h6>

					<p>This property is a prefixed value for the <a data-cite="css-text-3#text-transform-property"
								><code>text-transform</code> property</a> [[css-text-3]].</p>

					<table class="tabledef">
						<tbody>
							<tr>
								<th>Name: </th>
								<td><code>text-transform</code></td>
							</tr>
							<tr class="value">
								<th>Value:</th>
								<td> -epub-fullwidth </td>
							</tr>
						</tbody>
					</table>

					<p>For compatibility with existing content, the <code>text-transform</code> property also supports
						the deprecated <code>-epub-fullwidth</code> keyword. When specified, this has the same effect as
							<code>text-transform: full-width</code>.</p>
				</section>
			</section>

			<section id="sec-css-prefixed-text-decoration">
				<h5>CSS text decoration level 3</h5>

				<p>This section describes the <code>-epub-</code> prefixed properties for [[css-text-decor-3]].</p>

				<section id="sec-css-prefixed-text-epub-text-emphasis-color" data-tests="#css-epub-text-emphasis">
					<h6>The <code>-epub-text-emphasis-color</code> Property</h6>

					<p>This property is a prefixed version of the <a
							data-cite="css-text-decor-3#text-emphasis-color-property"><code>text-emphasis-color</code>
							property</a> [[css-text-decor-3]].</p>

					<table class="tabledef">
						<tbody>
							<tr>
								<th>Name: </th>
								<td><code>-epub-text-emphasis-color</code></td>
							</tr>
							<tr class="value">
								<th>Value:</th>
								<td> &lt;color> </td>
							</tr>
						</tbody>
					</table>
				</section>

				<section id="sec-css-prefixed-text-epub-text-emphasis-position" data-tests="#css-epub-text-emphasis">
					<h6>The <code>-epub-text-emphasis-position</code> property</h6>

					<p>This property is a prefixed version of the <a
							data-cite="css-text-decor-3#text-emphasis-position-property"
								><code>text-emphasis-position</code> property</a> [[css-text-decor-3]].</p>

					<table class="tabledef">
						<tbody>
							<tr>
								<th>Name: </th>
								<td><code>-epub-text-emphasis-position</code></td>
							</tr>
							<tr class="value">
								<th>Value:</th>
								<td> [ over | under ] &amp;&amp; [ right | left ] </td>
							</tr>
						</tbody>
					</table>
				</section>

				<section id="sec-css-prefixed-text-epub-text-emphasis-style" data-tests="#css-epub-text-emphasis">
					<h6>The <code>-epub-text-emphasis-style</code> property</h6>

					<p>This property is a prefixed version of the <a
							data-cite="css-text-decor-3#text-emphasis-style-property"><code>text-emphasis-style</code>
							property</a> [[css-text-decor-3]].</p>

					<table class="tabledef">
						<tbody>
							<tr>
								<th>Name: </th>
								<td><code>-epub-text-emphasis-style</code></td>
							</tr>
							<tr class="value">
								<th>Value:</th>
								<td> none | [ [ filled | open ] || [ dot | circle | double-circle | triangle | sesame ]
									] | &lt;string> </td>
							</tr>
						</tbody>
					</table>
				</section>

				<section id="sec-css-prefixed-text-epub-text-underline-position"
					data-tests="#css-epub-text-underline-position">
					<h6>The <code>-epub-text-underline-position</code> property</h6>

					<p>This property is a prefixed version of the <a
							data-cite="css-text-decor-3#text-underline-position-property"
								><code>text-underline-position</code> property</a> [[css-text-decor-3]].</p>

					<table class="tabledef">
						<tbody>
							<tr>
								<th>Name: </th>
								<td><code>-epub-text-underline-position</code></td>
							</tr>
							<tr class="value">
								<th>Value:</th>
								<td> auto | [ under || [ left | right ] ] | alphabetic </td>
							</tr>
						</tbody>
					</table>

					<p>For compatibility with existing content, the value <code>-epub-text-underline-position</code>
						property also supports the deprecated <code>alphabetic</code> keyword. When specified, this has
						the same effect as <code>text-underline-position: auto</code>.</p>
				</section>
			</section>
		</section>
		<section id="app-viewport-meta" class="appendix">
			<h2>The <code>viewport meta</code> tag</h2>

			<section id="app-viewport-meta-intro" class="informative">
				<h3>Introduction</h3>

				<p>As the <a
						href="https://developer.apple.com/library/archive/documentation/AppleApplications/Reference/SafariHTMLRef/Articles/MetaTags.html#//apple_ref/doc/uid/TP40008193-SW6"
						>Safari HTML definition</a> of the <code>viewport meta</code> tag, that was used in earlier
					versions of EPUB 3, is not an officially recognized standard, this specification defines a basic
					syntax in order to allow [=EPUB creators=] to express <a href="#sec-fxl-icb-html">width and height
						dimensions</a> for use rendering [=fixed-layout documents=].</p>

				<p>The syntax of this grammar is also influenced by the parsing algorithm for the <code>viewport
						meta</code> tag, as defined in [[css-viewport-1]].</p>

				<p>The syntax is intentionally left as generic as possible as it is not in this specification's scope to
					define all the possible properties and values. It only defines the basic requirements for defining a
					property and value pair as well as the possible separators between expressions.</p>
			</section>

			<section id="app-viewport-meta-syntax">
				<h3>Syntax</h3>

				<p>For [=fixed-layout documents=], a <code>viewport</code> [^meta^] tag [[html]] MUST have
						<code>name</code> and <code>content</code> attributes that conform to the following
					definition:</p>

				<dl>
					<dt id="viewport-name-attr">name</dt>
					<dd>The value of the [^meta/name^] attribute [[html]] after <a data-cite="xml#AVNormalize"
							>whitespace normalization</a> [[xml]] MUST be <code>viewport</code>.</dd>

					<dt id="viewport-content-attr">content</dt>
					<dd>
						<p>The value of the [^meta/content^] attribute [[html]] after <a data-cite="xml#AVNormalize"
								>whitespace normalization</a> [[xml]] MUST be of the following form:</p>
						<table class="productionset">
							<caption>(EBNF productions <a href="https://www.iso.org/standard/26153.html">ISO/IEC
									14977</a>)<br /> All terminal symbols are in the Unicode Block 'Basic Latin' (U+0000
								to U+007F).</caption>

							<tr>
								<td id="viewport.ebnf.def">
									<a href="#viewport.ebnf.def">viewport</a>
								</td>
								<td>=</td>
								<td><a href="#viewport.ebnf.property">property</a>, { <a href="#viewport.ebnf.sep"
										>sep</a>, <a href="#viewport.ebnf.property">property</a> } ;</td>
							</tr>
							<tr>
								<td id="viewport.ebnf.property">
									<a href="#viewport.ebnf.property">property</a>
								</td>
								<td>=</td>
								<td><a href="#viewport.ebnf.name">name</a>, [ <a href="#viewport.ebnf.assign"
									>assign</a>, <a href="#viewport.ebnf.value">value</a> ] ;</td>
							</tr>
							<tr>
								<td id="viewport.ebnf.name">
									<a href="#viewport.ebnf.name">name</a>
								</td>
								<td>=</td>
								<td>? character data ? ;</td>
							</tr>
							<tr>
								<td id="viewport.ebnf.value">
									<a href="#viewport.ebnf.value">value</a>
								</td>
								<td>=</td>
								<td>? character data ? ;</td>
							</tr>
							<tr>
								<td id="viewport.ebnf.sep">
									<a href="#viewport.ebnf.sep">sep</a>
								</td>
								<td>=</td>
								<td>
									<a href="#viewport.ebnf.sep-char">sep-char</a>, { <a href="#viewport.ebnf.sep-char"
										>sep-char</a> } ;</td>
							</tr>
							<tr>
								<td id="viewport.ebnf.sep-char">
									<a href="#viewport.ebnf.sep-char">sep-char</a>
								</td>
								<td>=</td>
								<td>( ";" | "," | <a href="#viewport.ebnf.space">space</a> ) ;</td>
							</tr>
							<tr>
								<td id="viewport.ebnf.assign">
									<a href="#viewport.ebnf.assign">assign</a>
								</td>
								<td>=</td>
								<td>[ <a href="#viewport.ebnf.space">space</a> ], "=", [ <a href="#viewport.ebnf.space"
										>space</a> ] ;</td>
							</tr>
							<tr>
								<td id="viewport.ebnf.space">
									<a href="#viewport.ebnf.space">space</a>
								</td>
								<td>=</td>
								<td>#x20 ;</td>
							</tr>
						</table>
					</dd>
				</dl>

				<p>The only restriction on property <a href="#viewport.ebnf.name">names</a> and <a
						href="#viewport.ebnf.value">values</a> is that they MUST NOT contain <a
						href="#viewport.ebnf.sep-char">separator characters</a> or the <a href="#viewport.ebnf.assign"
						>assignment character</a>.</p>

				<p>The authoring requirements in this section apply <em>after</em>
					<a data-cite="xml#AVNormalize">whitespace normalization</a> [[xml]] (i.e., after a reading system
					strips leading and trailing whitespace and compacts all instances of multiple whitespace within the
					attribute to single spaces). EPUB creators MAY include any valid [=ascii whitespace=] [[infra]] in
					the authored tag so long as the result is valid to this definition.</p>

				<p>There are no restrictions on any other attributes allowed on the [^meta^] element by the [[html]]
					grammar.</p>

				<div class="note">
					<p>For more information about specifying the required <code>height</code> and <code>width</code>
						properties, and their required values, refer to <a href="#sec-fxl-content-dimensions"></a>.</p>

					<p>Although the <code>viewport meta</code> tag allows EPUB creators to use properties other than
							<code>height</code> and <code>width</code>, and to not include values for these properties,
						such use is strongly discouraged. Setting other properties may have unintended consequences on
						the rendering of fixed-layout documents.</p>
				</div>
			</section>
		</section>
		<section id="app-schemas" class="appendix informative">
			<h2>Schemas</h2>

			<section id="app-package-schema">
				<h3>Package document schema</h3>

				<p>A schema for [=package documents=] is available at <a
						href="https://github.com/w3c/epubcheck/tree/master/src/main/resources/com/adobe/epubcheck/schema/30/package-30.nvdl"
						>https://github.com/w3c/epubcheck/tree/master/src/main/resources/com/adobe/epubcheck/schema/30/package-30.nvdl</a>.</p>

				<p>Validation using this schema requires a processor that supports [[nvdl]], [[relaxng-schema]],
					[[isoschematron]] and [[xmlschema-2]].</p>

				<div class="note">
					<p>The NVDL schema layer can be substituted by a multi-pass validation using the embedded RELAX NG
						and ISO Schematron schemas alone.</p>
				</div>

				<div class="note">
					<p>These schemas may be updated and corrected outside of formal revisions of this specification. As
						a result, they are subject to change at any time. </p>
				</div>
			</section>

			<section id="app-ocf-schema">
				<h3>OCF schemas</h3>

				<section id="app-schema-container">
					<h4>Schema for <code>container.xml</code></h4>

					<p>A schema for <a href="#sec-container-metainf-container.xml"><code>container.xml</code> files</a>
						is available at <a
							href="https://github.com/w3c/epubcheck/tree/master/src/main/resources/com/adobe/epubcheck/schema/30/ocf-container-30.nvdl">
							<code>https://github.com/w3c/epubcheck/tree/master/src/main/resources/com/adobe/epubcheck/schema/30/ocf-container-30.nvdl</code></a>.</p>

					<p>Validation using this schema requires a processor that supports [[relaxng-schema]] and
						[[xmlschema-2]].</p>
				</section>

				<section id="app-schema-encryption">
					<h4>Schema for <code>encryption.xml</code></h4>

					<p>The schema for <a href="#sec-container-metainf-encryption.xml"><code>encryption.xml</code>
							files</a> is included in [[xmlsec-rngschema-20130411]].</p>
				</section>

				<section id="app-schema-signatures">
					<h4>Schema for <code>signatures.xml</code></h4>

					<p>The schema for <a href="#sec-container-metainf-signatures.xml"><code>signatures.xml</code>
							files</a> is included in [[xmlsec-rngschema-20130411]].</p>
				</section>
			</section>

			<section id="app-schema-overlays">
				<h3>Media overlays schema</h3>

				<p>A schema for [=media overlay documents=] is available at <a
						href="https://github.com/w3c/epubcheck/tree/master/src/main/resources/com/adobe/epubcheck/schema/30/media-overlay-30.nvdl"
						>https://github.com/w3c/epubcheck/tree/main/src/master/resources/com/adobe/epubcheck/schema/30/media-overlay-30.nvdl</a>.</p>

				<p>Validation using this schema requires a processor that supports [[nvdl]], [[relaxng-schema]],
					[[isoschematron]] and [[xmlschema-2]].</p>

				<div class="note">
					<p>The NVDL schema layer can be substituted by a multi-pass validation using the embedded RELAX NG
						and ISO Schematron schemas alone.</p>
				</div>
			</section>
		</section>
		<section id="app-examples" class="appendix informative">
			<h2>Detailed examples</h2>

			<section id="publication-resources-example">
				<h3>Resources</h3>

				<p>Consider the following extracts of a [=package document=] and an [=XHTML content document=]:</p>

				<pre>&lt;package …>
    &lt;metadata …>
        …
        &lt;link rel="record" 
            href="meta/data.xml" 
            media-type="application/marc"/>
        &lt;link rel="record" 
            href="https://www.example.org/meta/data2.xml" 
            media-type="application/marc"/>
        …
    &lt;/metadata>
    &lt;manifest>
        …
        &lt;item id="page"
            href="page.xhtml"
            media-type="application/xhtml+xml"/>
        &lt;item id="nav"
            href="nav.xhtml"
            media-type="application/xhtml+xml"
            properties="nav"/>
        &lt;item id="style"        
            href="style.css"
            media-type="text/css"/>
        &lt;item id="font_otf"
            href="fonts/font-file.otf"
            media-type="font/otf"/>
        &lt;item id="font_otf_remote"
            href="https://www.example.org/fonts/font-file2.otf"
            media-type="font/otf"/>
        &lt;item id="font_cff"
            href="fonts/font-file.cff"
            media-type="font/sfnt"/>
        &lt;item id="pls"
            href="speech/cmn.pls"
            media-type="application/pls+xml"/>
        &lt;item id="image_1"
            href="media/image_1.png"
            media-type="image/png"/>
        &lt;item id="image_2"
            href="media/image_2.png"
            media-type="image/png"
            fallback="image_desc"/>
        &lt;item id="image_desc"
            href="image_desc.xhtml"
            media-type="application/xhtml+xml"/>
        &lt;item id="image_3_heic"
            href="media/image_3.heic"
            media-type="image/heic"/>
        &lt;item id="image_3_png"
            href="media/image_3.png"
            media-type="image/png"/>
        &lt;item id="widget"
            href="widget.xhtml"
            media-type="application/xhtml+xml"/>
        …
    &lt;/manifest>
    &lt;spine>
        …
        &lt;itemref idref="page_001"/>
        &lt;itemref idref="image_2"/>
        …
    &lt;/spine>
&lt;/package>
	
&lt;html …>
    &lt;head …>
        …
        &lt;link rel="stylesheet" type="text/css" href="style.css"/>
        &lt;link rel="pronunciation" type="application/pls+xml" href="speech/cmn.pls"/>
        …
    &lt;/head>
    &lt;body>
        &lt;img src="media/image1_png"/>
        …
        &lt;a href="media/image_2.png">…&lt;/a>
        …
        &lt;picture>
            &lt;source srcset="media/image_3.heic" type="image/heic"/>
            &lt;img src="media/image_3.png"/>
        &lt;/picture>
        …        
        &lt;iframe src="widget.xhtml">&lt;/iframe>
        …
        &lt;a href="https://www.example.org/some_content">…&lt;/a>
    &lt;/body>
&lt;/html>					
				</pre>

				<p>The various resources in the [=EPUB publication=] can be categorized as follows. (Refer to <a
						href="#sec-publication-resources"></a> for more information about these categories.)</p>

				<dl>
					<dt><code>meta/data.xml</code></dt>
					<dd>
						<p>The resource is a metadata record, stored in the [=EPUB container=]. It is linked via a
							[^link^] element in the package document metadata. It is therefore a [=linked resource=] on
							the [=manifest plane=] (i.e., is not listed in the [=EPUB manifest | manifest=]). It is not
							part on any other planes. </p>
					</dd>

					<dt><code>https://www.example.org/meta/data2.xml</code></dt>
					<dd>
						<p>The resource is a metadata record, stored remotely. It is linked via a [^link^] element in
							the package document metadata. It is therefore a linked resource on the manifest plane,
							(i.e., it is not listed in the manifest). It is not part on any other planes.</p>
					</dd>

					<dt><code>page.xhtml</code></dt>
					<dd>
						<p>The resource is an XHTML document. It is listed in the [[EPUB spine | spine=]. It is a
							[=publication resource=] on the manifest plane, a [=container resource=], an [=EPUB content
							document=] on the [=spine plane=], and is not present on the [=content plane=]. No fallback
							is necessary.</p>
					</dd>

					<dt><code>nav.xhtml</code></dt>
					<dd>
						<p>The resource is the [=EPUB navigation document=]. It is not listed in the spine. It is a
							publication resource on the manifest plane, a container resource, and is not present on
							either the spine plane or the content plane. No fallback is necessary.</p>
					</dd>

					<dt><code>style.css</code></dt>
					<dd>
						<p>The resource is a CSS file. It is not listed in the spine but is referenced from an [[html]]
								<a data-cite="html#the-link-element"><code>link</code></a> element. It is a publication
							resource on the manifest plane, a container resource, is not present on the spine plane, and
							is a [=core media type resource=] on the content plane. No fallback is necessary.</p>
					</dd>

					<dt><code>font/font-file.otf</code></dt>
					<dd>
						<p>The resource is a TrueType font file. It is not listed in the spine but is referenced from a
							CSS file. It is a publication resource on the manifest plane, is a container resource, is
							not present on the spine plane, and is a core media type resource on the content plane. No
							fallback is necessary.</p>
					</dd>

					<dt><code>https://www.example.org/fonts/font-file2.otf</code></dt>
					<dd>
						<p>The resource is a TrueType font file. It is not listed in the spine but is referenced from a
							CSS file. It is a publication resource on the manifest plane, is a [=remote resource=], is
							not present on the spine plane, and is a core media type resource on the content plane. No
							fallback is necessary.</p>
					</dd>

					<dt><code>font/font-file.cff</code></dt>
					<dd>
						<p>The resource is a font file in Compact Font Format. It is not listed in the spine but is
							referenced from a CSS file. Its media type is not listed as a <a
								href="#sec-core-media-types">core media type</a>. It is a publication resource on the
							manifest plane, a container resource, is not present on the spine plane, and is an [=exempt
							resource=] on the content plane. No fallback is necessary.</p>
					</dd>

					<dt><code>speech/cmn.pls</code></dt>
					<dd>
						<p>The resource is a Pronunciation Lexicon file. It is not listed in the spine but is referenced
							from an [[html]] <a data-cite="html#the-link-element"><code>link</code></a> element. It is a
							publication resource on the manifest plane, a container resource, not present on the spine
							plane, and is an exempt resource on the content plane. No fallback is necessary.</p>
					</dd>

					<dt><code>image/image_1.png</code></dt>
					<dd>
						<p>The resource is a PNG image file. It is not listed in the spine but is referenced from an
							[[html]] [^img^] element. It is a publication resource on the manifest plane, a container
							resource, is not present on the spine plane, and is a core media type resource on the
							content plane. No fallback is necessary.</p>
					</dd>

					<dt><code>image/image_2.png</code></dt>
					<dd>
						<p>The resource is a PNG image file. It is referenced via an [[html]] [^a^] element. Because it
							is referenced from a hyperlink, it <em>must</em> be listed in the spine. It is a publication
							resource on the manifest plane, a container resource, a [=foreign content document=] on the
							spine plane, and a core media type resource on the content plane. As a foreign content
							document, a fallback is required, which is provided via a <a href="#sec-manifest-fallbacks"
								>manifest fallback</a>.</p>
					</dd>

					<dt><code>image_desc.xhtml</code></dt>
					<dd>
						<p>The resource is an XHTML document. It is the "target" of a manifest fallback so is not
							explicitly listed in the spine (but it "replaces" the existing spine item when needed). It
							is a publication resource on the manifest plane, a container resource, an EPUB content
							document on spine plane, and, because it is not "used" when rendering another EPUB content
							document, it is not present on the content plane. No fallback is necessary.</p>
					</dd>

					<dt><code>image/image_3.heic</code></dt>
					<dd>
						<p>The resource is a High Efficiency (HEIC) image file. It is not listed in the spine but is
							referenced from an [[html]] [^source^] element. Its media type is not listed as a <a
								href="#sec-core-media-types">core media type</a>. It is a publication resource on the
							manifest plane, a container resource, is not present on the spine plane, and is a foreign
							resource on the content plane. As a foreign resource, a fallback is required, which is
							provided via the sibling [[html]] [^img^] element in an [[html]] [^picture^] element.</p>
					</dd>

					<dt><code>image/image_3.png</code></dt>
					<dd>
						<p>The resource is a PNG image file. It is not listed in the spine but is referenced from an
							[[html]] [^img^] element that is used as an intrinsic fallback of the [[html]] [^picture^]
							element. It is a publication resource on the manifest plane, a container resource, is not
							present on the spine plane, and is a core media type resource on the content plane. No
							fallback is necessary.</p>
					</dd>

					<dt><code>widget.xhtml</code></dt>
					<dd>
						<p>The resource is an XHTML document. It is not listed in the spine but is referenced from an
							[[html]] [^iframe^] element. It is a publication resource on the manifest plane, a container
							resource, is not present on spine plane, and, because it is "used" when rendering another
							EPUB content document, a core media type resource on the content plane. No fallback is
							necessary.</p>
					</dd>

					<dt><code>https://www.example.org/some_content</code></dt>
					<dd>
						<p>The resource is referenced via an [[html]] [^a^] element and is not stored in the EPUB
							container. Reading systems will normally open this link via a separate browser instance. It
							is not on any planes defined by this specification.</p>
					</dd>
				</dl>

				<p>Additional examples on the usage of different types of resources can be found in <a
						href="#sec-item-elem-examples"></a>.</p>
			</section>

			<section id="scripted-contexts-example">
				<h3>Scripting contexts</h3>

				<p>Consider the following example [=package document=]:</p>

				<pre>&lt;package …>
    …
    &lt;manifest>
        …
        &lt;item id="chap01" 
            href="scripted01.xhtml" 
            media-type="application/xhtml+xml"
            properties="scripted"/>
        &lt;item id="inset01" 
            href="scripted02.xhtml" 
            media-type="application/xhtml+xml"
            properties="scripted"/>
        &lt;item id="slideshowjs" 
            href="slideshow.js" 
            media-type="text/javascript"/>
    &lt;/manifest>
    
    &lt;spine …>
        &lt;itemref idref="chap01"/>
        …
    &lt;/spine>
    …
&lt;/package></pre>

				<p>and the following file <code>scripted01.xhtml</code>:</p>

				<pre>&lt;html …>
    &lt;head>
        …
        &lt;script type="text/javascript">
            alert("Reading system name: " + navigator.epubReadingSystem.name);
        &lt;/script>
    &lt;/head>
    &lt;body>
        …
        &lt;iframe src="scripted02.xhtml" … />
        …
    &lt;/body>
&lt;/html></pre>

				<p>and the following file <code>scripted02.xhtml</code>:</p>

				<pre>&lt;html …>
    &lt;head>
        …
        &lt;script type="text/javascript" href="slideshow.js">&lt;/script>
    &lt;/head>
    &lt;body>
        …
    &lt;/body>
&lt;/html></pre>

				<p>From these examples, it is true that:</p>

				<ul>
					<li>
						<p>the code in the <code>script</code> element in the <code>head</code> in
								<code>scripted01.xhtml</code> is a <a href="#sec-scripted-spine">spine-level script</a>
							because the document is referenced from the spine; and</p>
					</li>
					<li>
						<p>the code in the <code>script</code> element in <code>scripted02.xhtml</code> is a <a
								href="#sec-scripted-container-constrained">container-constrained script</a> because the
							XHTML document it occurs in is included in <code>scripted01.xhtml</code> via the
								<code>iframe</code> element.</p>
					</li>
				</ul>
			</section>

			<section id="ocf-example">
				<h3>Packaged EPUB</h3>

				<p>This example demonstrates the use of the OCF format to contain a signed and encrypted [=EPUB
					publication=] within an [=OCF ZIP container=].</p>

				<p>Ordered list of files in the OCF ZIP container:</p>

				<pre>mimetype
META-INF/container.xml
META-INF/signatures.xml
META-INF/encryption.xml
EPUB/As_You_Like_It.opf
EPUB/book.html
EPUB/nav.html
EPUB/images/cover.png</pre>

				<p>The contents of the <code>mimetype</code> file</p>

				<pre>application/epub+zip</pre>

				<p>The contents of the <code>META-INF/container.xml</code> file</p>

				<pre>&lt;?xml version="1.0"?>
&lt;container
    version="1.0"
    xmlns="urn:oasis:names:tc:opendocument:xmlns:container">
   &lt;rootfiles>
      &lt;rootfile
          full-path="EPUB/As_You_Like_It.opf"
          media-type="application/oebps-package+xml"/>
   &lt;/rootfiles>
&lt;/container></pre>

				<p>The contents of the <code>META-INF/signatures.xml</code> file</p>

				<pre>&lt;signatures
    xmlns="urn:oasis:names:tc:opendocument:xmlns:container">
   &lt;Signature
       Id="AsYouLikeItSignature"
       xmlns="http://www.w3.org/2000/09/xmldsig#">
        
      &lt;!--
           SignedInfo is the information that is actually signed.
           In this case, the SHA-1 algorithm is used to sign the 
           canonical form of the XML documents enumerated in the
           Object element below.
      -->
      
      &lt;SignedInfo>
         &lt;CanonicalizationMethod
             Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315"/>
         &lt;SignatureMethod
             Algorithm="http://www.w3.org/2000/09/xmldsig#dsa-sha1"/>
         &lt;Reference
             URI="#AsYouLikeIt">
            &lt;DigestMethod
                Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"/>
            &lt;DigestValue>
               …
            &lt;/DigestValue>
         &lt;/Reference>
      &lt;/SignedInfo>
      
      &lt;!--
           The signed value of the digest above, using the DSA 
           algorithm
      -->
      &lt;SignatureValue>
         …
      &lt;/SignatureValue>
      
      &lt;!--
           The key used to validate the signature
      -->
      &lt;KeyInfo>
         &lt;KeyValue>
            &lt;DSAKeyValue>
               &lt;P>…&lt;/P>
               &lt;Q>…&lt;/Q>
               &lt;G>…&lt;/G>
               &lt;Y>…&lt;/Y>
            &lt;/DSAKeyValue>
         &lt;/KeyValue>
      &lt;/KeyInfo>
      
      &lt;!--
           The list of resources to sign (note that the canonical
           form of XML documents is signed, while the binary form
           of all other resources is used)
      -->
      &lt;Object>
         &lt;Manifest
             Id="AsYouLikeIt">
            &lt;Reference
                URI="EPUB/As_You_Like_It.opf">
               &lt;Transforms>
                  &lt;Transform
                      Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315"/>
               &lt;/Transforms>
               &lt;DigestMethod
                   Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"/>
               &lt;DigestValue>
               &lt;/DigestValue>
            &lt;/Reference>
            
            &lt;Reference URI="EPUB/book.html">
               &lt;Transforms>
                  &lt;Transform
                      Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315"/>
               &lt;/Transforms>
               &lt;DigestMethod
                   Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"/>
               &lt;DigestValue>
               &lt;/DigestValue>
            &lt;/Reference>
            
            &lt;Reference
                URI="EPUB/images/cover.png">
               &lt;DigestMethod
                   Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"/>
               &lt;DigestValue>
               &lt;/DigestValue>
            &lt;/Reference>
         &lt;/Manifest>
      &lt;/Object>
   &lt;/Signature>
&lt;/signatures></pre>

				<p>The contents of the <code>META-INF/encryption.xml</code> file</p>

				<pre>&lt;?xml version="1.0"?>
&lt;encryption
    xmlns="urn:oasis:names:tc:opendocument:xmlns:container"
    xmlns:enc="http://www.w3.org/2001/04/xmlenc#"
    xmlns:ds="http://www.w3.org/2000/09/xmldsig#">

   &lt;!--
        The RSA-encrypted AES-128 symmetric key used to encrypt
        data enumerated in EncryptedData blocks below
   -->
   &lt;enc:EncryptedKey
       Id="EK">
      &lt;enc:EncryptionMethod
          Algorithm="http://www.w3.org/2001/04/xmlenc#rsa-1_5"/>
      &lt;ds:KeyInfo>
         &lt;ds:KeyName>
            John Smith
         &lt;/ds:KeyName>
      &lt;/ds:KeyInfo>
      &lt;enc:CipherData>
         &lt;enc:CipherValue>
            xyzabc…
         &lt;/enc:CipherValue>
      &lt;/enc:CipherData>
   &lt;/enc:EncryptedKey>

   &lt;!--
        Each EncryptedData block identifies a single resource
        that has been encrypted using the AES-128 algorithm.
        The data remains stored, in its encrypted form, in the
        original file within the container.
   -->
   &lt;enc:EncryptedData Id="ED1">
      &lt;enc:EncryptionMethod
          Algorithm="http://www.w3.org/2001/04/xmlenc#kw-aes128"/>
      &lt;ds:KeyInfo>
         &lt;ds:RetrievalMethod
             URI="#EK"
             Type="http://www.w3.org/2001/04/xmlenc#EncryptedKey"/>
      &lt;/ds:KeyInfo>
      &lt;enc:CipherData>
         &lt;enc:CipherReference
             URI="EPUB/book.html"/>
      &lt;/enc:CipherData>
   &lt;/enc:EncryptedData>

   &lt;enc:EncryptedData Id="ED2">
      &lt;enc:EncryptionMethod
          Algorithm="http://www.w3.org/2001/04/xmlenc#kw-aes128"/>
      &lt;ds:KeyInfo>
         &lt;ds:RetrievalMethod
             URI="#EK" Type="http://www.w3.org/2001/04/xmlenc#EncryptedKey"/>
      &lt;/ds:KeyInfo>
      &lt;enc:CipherData>
         &lt;enc:CipherReference
             URI="EPUB/images/cover.png"/>
      &lt;/enc:CipherData>
   &lt;/enc:EncryptedData>
&lt;/encryption></pre>

				<p>The contents of the <code>EPUB/As_You_Like_It.opf</code> file</p>

				<pre>&lt;?xml version="1.0"?>
&lt;package
    version="3.0"
    xml:lang="en"
    xmlns="http://www.idpf.org/2007/opf"
    unique-identifier="pub-id">
    
   &lt;metadata
       xmlns:dc="http://purl.org/dc/elements/1.1/">
      
      &lt;dc:identifier
          id="pub-id">
         urn:uuid:B9B412F2-CAAD-4A44-B91F-A375068478A0
      &lt;/dc:identifier>
      
      &lt;dc:language>
         en
      &lt;/dc:language>
      
      &lt;dc:title>
         As You Like It
      &lt;/dc:title>
       
      &lt;dc:creator
          id="creator">
         William Shakespeare
      &lt;/dc:creator>
      
      &lt;meta
          property="dcterms:modified">
         2000-03-24T00:00:00Z
      &lt;/meta>
      
      &lt;dc:publisher>
         Project Gutenberg
      &lt;/dc:publisher>
      
      &lt;dc:date>
         2000-03-24
      &lt;/dc:date>
      
      &lt;meta
          property="dcterms:dateCopyrighted">
         9999-01-01
      &lt;/meta>
      
      &lt;dc:identifier
          id="isbn13">
         urn:isbn:9780741014559
      &lt;/dc:identifier>
      
      &lt;dc:identifier
          id="isbn10">
         0-7410-1455-6
      &lt;/dc:identifier>
      
      &lt;link
          rel="xml-signature"
          href="../META-INF/signatures.xml#AsYouLikeItSignature"/>
   &lt;/metadata>
    
   &lt;manifest>
      &lt;item id="r4915" 
          href="book.html" 
          media-type="application/xhtml+xml"/>
      &lt;item id="r7184" 
          href="images/cover.png" 
          media-type="image/png"/>
      &lt;item id="nav" 
          href="nav.html" 
          media-type="application/xhtml+xml" 
          properties="nav"/>
   &lt;/manifest>
   
   &lt;spine>
      &lt;itemref
          idref="r4915"/>
   &lt;/spine>
&lt;/package></pre>
			</section>

			<section id="clock-examples">
				<h3>Clock values</h3>

				<p>The following are examples of allowed clock values:</p>

				<ul>
					<li>
						<p><code>5:34:31.396</code> = 5 hours, 34 minutes, 31 seconds, and 396 milliseconds</p>
					</li>
					<li>
						<p><code>124:59:36</code> = 124 hours, 59 minutes, and 36 seconds</p>
					</li>
					<li>
						<p><code>0:05:01.2</code> = 5 minutes, 1 second, and 200 milliseconds</p>
					</li>
					<li>
						<p><code>0:00:04</code> = 4 seconds</p>
					</li>
					<li>
						<p><code>09:58</code> = 9 minutes and 58 seconds</p>
					</li>
					<li>
						<p><code>00:56.78</code> = 56 seconds and 780 milliseconds</p>
					</li>
					<li>
						<p><code>76.2s</code> = 76.2 seconds = 76 seconds and 200 milliseconds</p>
					</li>
					<li>
						<p><code>7.75h</code> = 7.75 hours = 7 hours and 45 minutes</p>
					</li>
					<li>
						<p><code>13min</code> = 13 minutes</p>
					</li>
					<li>
						<p><code>2345ms</code> = 2345 milliseconds</p>
					</li>
					<li>
						<p><code>12.345</code> = 12 seconds and 345 milliseconds</p>
					</li>
				</ul>
			</section>
		</section>
		<section id="app-media-types" class="appendix">
			<h2>Media type registrations</h2>

			<section id="app-media-type-app-oebps-package">
				<h3>The <code>application/oebps-package+xml</code> media type</h3>

				<p>This appendix registers the media type <code>application/oebps-package+xml</code> for the EPUB
					package document. This registration supersedes RFC4839 (see <a
						href="https://www.rfc-editor.org/rfc/rfc4839">https://www.rfc-editor.org/rfc/rfc4839</a>).</p>

				<p>The package document is an XML file that describes an EPUB publication. It identifies the resources
					in the EPUB publication and provides metadata information. The package document and its related
					specifications are maintained and defined by the <a href="https://www.w3.org">World Wide Web
						Consortium</a> (W3C).</p>

				<dl class="variablelist">
					<dt>MIME media type name:</dt>
					<dd>
						<p>
							<code>application</code>
						</p>
					</dd>

					<dt>MIME subtype name:</dt>
					<dd>
						<p>
							<code>oebps-package+xml</code>
						</p>
					</dd>

					<dt>Required parameters:</dt>
					<dd>
						<p>None.</p>
					</dd>

					<dt>Optional parameters:</dt>
					<dd>
						<p>None.</p>
					</dd>

					<dt>Encoding considerations:</dt>
					<dd>
						<p>8bit if UTF-8; binary if UTF-16.</p>
						<p> Package documents are in XML, represented either in UTF-8 or UTF-16. When the package
							document is written in UTF-8, the file is 8bit compatible. When it is written in UTF-16, the
							binary content-transfer-encoding must be used. For further details, see [[rfc7303]]. </p>
					</dd>

					<dt>Security considerations:</dt>
					<dd>
						<p>Package documents contain well-formed XML conforming to the XML 1.0 specification.</p>
						<p>Clearly, it is possible to author malicious files which, for example, contain malformed data.
							Most XML parsers protect themselves from such attacks by rigorously enforcing
							conformance.</p>
						<p>All processors that read package documents should rigorously check the size and validity of
							data retrieved.</p>
						<p>There is no current provision in the EPUB 3 specification for encryption, signing, or
							authentication within the package document format.</p>
					</dd>

					<dt>Interoperability considerations:</dt>
					<dd>
						<p>None.</p>
					</dd>

					<dt>Published specification:</dt>
					<dd>
						<p>This media type registration is for the EPUB package document, as described by the EPUB 3
							specification located at <a href="https://www.w3.org/TR/epub-33/"
								>https://www.w3.org/TR/epub-33/</a>.</p>
						<p>The EPUB 3 specification supersedes the Open Packaging Format 2.0.1 specification, which is
							located at <a href="https://idpf.org/epub/20/spec/OPF_2.0.1_draft.htm"
								>https://idpf.org/epub/20/spec/OPF_2.0.1_draft.htm</a> and which also uses the <code
								class="media-type">application/oepbs-package+xml</code> media type.</p>
					</dd>

					<dt>Applications which use this media type:</dt>
					<dd>
						<p>This media type is in wide use for the distribution of ebooks in the EPUB format.</p>
					</dd>

					<dt>Additional information:</dt>
					<dd>
						<dl class="variablelist">
							<dt>Magic number(s):</dt>
							<dd>
								<p>none</p>
							</dd>

							<dt>File extension(s):</dt>
							<dd>
								<p>
									<code>.opf</code>
								</p>
							</dd>

							<dt>Macintosh File Type Code(s):</dt>
							<dd>
								<p>TEXT</p>
							</dd>

							<dt>Fragment identifiers:</dt>
							<dd>
								<p> EPUB Canonical Fragment Identifiers are custom fragment identifiers defined for [=
									EPUB Publications =]. They may be used to refer to an arbitrary content within any
									[=publication resource=] defined for the publication. These identifiers are defined
									at <a href="https://idpf.org/epub/linking/cfi/"
										>https://idpf.org/epub/linking/cfi/</a>. </p>
							</dd>
						</dl>
					</dd>

					<dt>Person &amp; email address to contact for further information:</dt>
					<dd>
						<p>EPUB 3 Working Group (public-epub-wg@w3.org)</p>
					</dd>

					<dt>Intended usage:</dt>
					<dd>
						<p>COMMON</p>
					</dd>

					<dt>Author/Change controller:</dt>
					<dd>
						<p>World Wide Web Consortium (W3C)</p>
					</dd>
				</dl>
			</section>

			<section id="app-media-type">
				<h3>The <code>application/epub+zip</code> media type</h3>

				<p>This appendix registers the media type <code>application/epub+zip</code> for the EPUB Open Container
					Format (OCF).</p>

				<p>An OCF ZIP container, or EPUB container, file is a container technology based on the zip archive
					format (see <a href="https://pkware.cachefly.net/webdocs/casestudies/APPNOTE.TXT"
						>https://pkware.cachefly.net/webdocs/casestudies/APPNOTE.TXT</a>). It is used to encapsulate the
					EPUB publication. OCF and its related standards are maintained and defined by the <a
						href="https://www.w3.org">World Wide Web Consortium</a> (W3C).</p>

				<dl class="variablelist">
					<dt>MIME media type name:</dt>
					<dd>
						<p>
							<code>application</code>
						</p>
					</dd>

					<dt>MIME subtype name:</dt>
					<dd>
						<p>
							<code>epub+zip</code>
						</p>
					</dd>

					<dt>Required parameters:</dt>
					<dd>
						<p>None.</p>
					</dd>

					<dt>Optional parameters:</dt>
					<dd>
						<p>None.</p>
					</dd>

					<dt>Encoding considerations:</dt>
					<dd>
						<p>OCF ZIP container files are binary files encoded in the <a class="media-type"
								href="https://www.iana.org/assignments/media-types/application/zip">
								<code>application/zip</code></a> media type.</p>
					</dd>

					<dt>Security considerations:</dt>
					<dd>
						<p>All processors that read OCF ZIP container files should rigorously check the size and
							validity of data retrieved.</p>
						<p>In addition, because of the various content types that can be embedded in OCF ZIP container
							files, <code>application/epub+zip</code> may describe content that poses security
							implications beyond those noted here. However, only in cases where the processor recognizes
							and processes the additional content, or where further processing of that content is
							dispatched to other processors, would security issues potentially arise. In such cases,
							matters of security would fall outside the domain of this registration document.</p>
						<p>Security considerations that apply to <code>application/zip</code> also apply to OCF ZIP
							container files.</p>
					</dd>

					<dt>Interoperability considerations:</dt>
					<dd>
						<p>None.</p>
					</dd>

					<dt>Published specification:</dt>
					<dd>
						<p>This media type registration is for the EPUB Open Container Format (OCF), as described by the
							EPUB 3 specification located at <a href="https://www.w3.org/TR/epub-33/"
									><code>https://www.w3.org/TR/epub-33/</code></a>.</p>
						<p>The EPUB 3 specification supersedes both <a
								href="https://datatracker.ietf.org/doc/html/rfc4839">RFC 4839</a> and the Open Container
							Format 2.0.1 specification, which is located at <a
								href="https://idpf.org/epub/20/spec/OCF_2.0.1_draft.doc"
									><code>https://idpf.org/epub/20/spec/OCF_2.0.1_draft.doc</code></a>, and which also
							uses the <code>application/epub+zip</code> media type.</p>
					</dd>

					<dt>Applications that use this media type:</dt>
					<dd>
						<p>This media type is in wide use for the distribution of ebooks in the EPUB format.</p>
					</dd>

					<dt>Additional information:</dt>
					<dd>
						<dl class="variablelist">
							<dt>Magic number(s):</dt>
							<dd>
								<p>0: <code>PK 0x03 0x04</code>, 30: <code>mimetype</code>, 38:
										<code>application/epub+zip</code></p>
							</dd>

							<dt>File extension(s):</dt>
							<dd>
								<p>OCF ZIP container files are most often identified with the extension
										<code>.epub</code>.</p>
							</dd>

							<dt>Macintosh file type code(s):</dt>
							<dd>
								<p>ZIP</p>
							</dd>

							<dt>Fragment identifiers:</dt>
							<dd>
								<p> EPUB Canonical Fragment Identifiers are custom fragment identifiers defined for [=
									EPUB Publications =]. They may be used to refer to an arbitrary content within any
									[=publication resource=] defined for the publication. These identifiers are defined
									at <a href="https://idpf.org/epub/linking/cfi/"
										>https://idpf.org/epub/linking/cfi/</a>. </p>
							</dd>
						</dl>
					</dd>

					<dt>Person &amp; email address to contact for further information:</dt>
					<dd>
						<p>EPUB 3 Working Group (public-epub-wg@w3.org)</p>
					</dd>

					<dt>Intended usage:</dt>
					<dd>
						<p>COMMON</p>
					</dd>

					<dt>Author/change controller:</dt>
					<dd>
						<p>World Wide Web Consortium (W3C)</p>
					</dd>
				</dl>
			</section>
		</section>
		<section id="index"></section>
		<section id="change-log" class="appendix informative">
			<h2>Change log</h2>

			<p>Note that this change log only identifies substantive changes since <a
					href="https://www.w3.org/publishing/epub/epub-spec.html">EPUB 3.2</a> &#8212; those that affect the
				conformance of [=EPUB publications=] or are similarly noteworthy.</p>

			<p>For a list of all issues addressed during the revision, refer to the <a
					href="https://github.com/w3c/epub-specs/issues?q=is%3Aissue+is%3Aclosed+label%3AEPUB33+-label%3ASpec-RS+"
					>Working Group's issue tracker</a>.</p>

			<section id="change-latest">
				<h3>Substantive changes since <a href="https://www.w3.org/TR/2022/CR-epub-33-20220512/">Candidate
						Recommendation</a></h3>

				<ul>
					<li>17-Nov-2022: Updated file paths and names to identify that they are scalar value strings in the
						OCF abstract container, not just case sensitive. See <a
							href="https://github.com/w3c/epub-specs/issues/2461">issue 2461</a>.</li>
					<li>11-Nov-2022: Added caution about reading systems not retaining HTML element-based rendering
						instructions in navigation document elements. See <a
							href="https://github.com/w3c/epub-specs/issues/2477">issue 2477</a>.</li>
					<li>02-Nov-2022: Removed the restriction on deprecated characters in the Tags and Variation
						Selectors Supplement and replaced with a general note to avoid the use of characters already
						deprecated by the Unicode standard, as the list changes over time. See <a
							href="https://github.com/w3c/epub-specs/issues/2469">issue 2469</a>.</li>
					<li>20-Oct-2022: Removed requirement to encode file names in abstract container in UTF-8 as it is
						not possible in the abstract and is already covered by a ZIP container requirement. See <a
							href="https://github.com/w3c/epub-specs/issues/2461">issue 2461</a>.</li>
					<li>17-Oct-2022: Added recommendation against using spaces in file paths and names. See <a
							href="https://github.com/w3c/epub-specs/issues/2458">issue 2458</a>.</li>
					<li>15-Oct-2022: Allow properties without values in <code>viewport meta</code> tag definition. See
							<a href="https://github.com/w3c/epub-specs/pull/2457">pull request 2457</a>.</li>
					<li>11-Oct-2022: Added additional requirement that <code>viewport meta</code> height and width not
						be declared multiple times. See <a href="https://github.com/w3c/epub-specs/issues/2442">issue
							2442</a>.</li>
					<li>21-Sept-2022: Made the requirement to declare property prefixes explicit. See <a
							href="https://github.com/w3c/epub-specs/issues/2438">issue 2438</a>.</li>
					<li>19-Sept-2022: Removed minor contradictions in the <code>epub:type</code> attribute usage
						definitions. See <a href="https://github.com/w3c/epub-specs/issues/2434">issue 2434</a>.</li>
					<li>14-Sept-2022: Combined the legacy feature section into the package document definition. See <a
							href="https://github.com/w3c/epub-specs/issues/2423">issue 2423</a>.</li>
					<li>14-Sept-2022: Clarified that the <code>href</code> attribute in the package document must not be
						used to reference other package document elements (i.e., to indirectly reference a resource via
						its manifest or spine entry). See <a href="https://github.com/w3c/epub-specs/issues/2420">issue
							2420</a>.</li>
					<li>14-Sept-2022: Re-establish that empty reference and property values are not valid to ensure that
						metadata properties do not consist only of prefixes. See <a
							href="https://github.com/w3c/epub-specs/issues/2417">issue 2417</a>.</li>
					<li>14-Sept-2022: Added a new section for expressing all the primary navigation document content
						requirements. See <a href="https://github.com/w3c/epub-specs/issues/2421">issue 2421</a>.</li>
					<li>7-Sept-2022: Added clarifying requirement that the manifest only list publication resources. See
							<a href="https://github.com/w3c/epub-specs/issues/2413">issue 2413</a>.</li>
					<li>28-Aug-2022: Added a note to Media Overlays <code>text</code> element definition regarding using
						embedded timed media. See <a href="https://github.com/w3c/epub-specs/issues/2397">issue
						2397</a>.</li>
					<li>02-Aug-2022: Updated the media type registrations, following the <a
							href="https://lists.w3.org/Archives/Public/public-epub-wg/2022Aug/0000.html">official IANA
							review comments</a> on updating the previous registrations. See <a
							href="https://github.com/w3c/epub-specs/issues/1398">issue 1398</a>. </li>
					<li>28-July-2022: The restrictions on the elements where <code>epub:type</code> may be used has been
						made explicit. See <a href="https://github.com/w3c/epub-specs/issues/2377">issue 2377</a>.</li>
					<li>18-July-2022: The viewport <code>meta</code> element for specifying the initial containing
						boundary in fixed-layout documents is now formally defined. See <a
							href="https://github.com/w3c/epub-specs/issues/2292">issue 2292</a>. </li>
					<li>14-July-2022: Clarified that the markup in the SVG <code>title</code> element is restricted to
						HTML elements. See <a href="https://github.com/w3c/epub-specs/issues/2355">issue 2355</a>.</li>
					<li>10-June-2022: Clarified that data blocks are exempt from fallback requirements. See <a
							href="https://github.com/w3c/epub-specs/issues/2331">issue 2331</a>.</li>
					<li>07-June-2022: The usage of File URLs has been disallowed. See <a
							href="https://github.com/w3c/epub-specs/issues/2324">issue 2324</a>.</li>
					<li>07-June-2022: Media type registration sections are now normative. See <a
							href="https://github.com/w3c/epub-specs/issues/2313">issue 2313</a>.</li>
					<li>07-June-2022: Updated privacy and security recommendations to use normative language. See <a
							href="https://github.com/w3c/epub-specs/pull/2297">pull request 2297</a>.</li>
					<li>27-May-2022: Added recommendation to only reference remote resources via https. See <a
							href="https://github.com/w3c/epub-specs/issues/2263">issue 2263</a>.</li>
					<li>20-May-2022: Add recommendation not to store sensitive user data in persistent storage, and to
						encrypt it if there is no other choice. See <a
							href="https://github.com/w3c/epub-specs/issues/2264">issue 2264</a>.</li>
					<li>17-May-2022: Added an index of terms. See <a
							href="https://github.com/w3c/epub-specs/issues/2260">issue 2260</a>.</li>
				</ul>
			</section>

			<section id="changes-older">
				<h3>Substantive changes since <a href="https://www.w3.org/publishing/epub32/">EPUB 3.2</a></h3>

				<ul>
					<li>12-Apr-2022: Added note about complexities of escaping from nested escapable structures and
						updated the list of semantics to use for escaping to match the guidance. See <a
							href="https://github.com/w3c/epub-specs/issues/2221">issue 2221</a>.</li>
					<li>6-Apr-2022: Removed the restrictions on the value of the <code>authority</code> property and
						added a note referencing the old IDPF registry. See <a
							href="https://github.com/w3c/epub-specs/issues/2120">issue 2200</a>.</li>
					<li>31-Mar-2022: Removed the restriction on deprecated MathML features and added a general caution
						that any technology may make changes that can cause an EPUB publication to become invalid. See
							<a href="https://github.com/w3c/epub-specs/issues/2118">issue 2118</a>.</li>
					<li>31-Mar-2022: Reformulated custom attributes as a content authoring feature and added a new
						section on custom rendering properties. See <a
							href="https://github.com/w3c/epub-specs/issues/2134">issue 2134</a>.</li>
					<li>25-Mar-2022: Fixed conflicting statements about the requirement for semantics in media overlay
						documents and clarified requirements for skippability and escapability. See <a
							href="https://github.com/w3c/epub-specs/issues/2066">issue 2066</a>.</li>
					<li>22-Mar-2022: Removed the recommendation that reading systems recognize the built-in
						`collection-type` values and replaced with a note about enabling improved handling of related
						content. See <a href="https://github.com/w3c/epub-specs/issues/2071">issue 2071</a>.</li>
					<li>21-Mar-2022: Add a tolerance of one second for the sum of the individual media overlay docuemnts
						matching the total duration. See <a href="https://github.com/w3c/epub-specs/issues/2093">issue
							2093</a>.</li>
					<li>17-Mar-2022: Deprecate the creation of new collection types. See <a
							href="https://github.com/w3c/epub-specs/pull/2060">issue 2060</a>.</li>
					<li>17-Mar-2022: Removed dated requirements on the use of <code>epub:type</code> that suggest
						equivalence with ARIA roles. See <a href="https://github.com/w3c/epub-specs/pull/2070">issue
							2070</a>.</li>
					<li>16-Mar-2022: Add new section on conformance checking and definition for EPUB conformance
						checker. See <a href="https://github.com/w3c/epub-specs/pull/2025">pull request 2025</a>.</li>
					<li>14-Mar-2022: Renamed the term "valid-relative-container-URL-with-fragment" to
						"valid-relative-ocf-URL-with-fragment string". See <a
							href="https://github.com/w3c/epub-specs/issues/2076">issue 2076</a>.</li>
					<li>09-Mar-2022: Restore requirement that valid-relative-container-URL-with-fragment strings resolve
						to resources in the OCF abstract container. See <a
							href="https://github.com/w3c/epub-specs/issues/2024">issue 2024</a>.</li>
					<li>09-Mar-2022: Added NCX doctype to allowed external identifiers. See <a
							href="https://github.com/w3c/epub-specs/issues/2045">issue 2045</a>.</li>
					<li>08-Mar-2022: Require use of the fixed layout property values defined in this specification. See
							<a href="https://github.com/w3c/epub-specs/issues/2039">issue 2039</a>.</li>
					<li>08-Mar-2022: Clarified that the refines attribute must not be used with global fixed layout
						property declarations. See <a href="https://github.com/w3c/epub-specs/issues/2036">issue
							2036</a>.</li>
					<li>07-Mar-2022: Consolidated the usage requirements for manifest properties into a new Resource
						Properties section. See <a href="https://github.com/w3c/epub-specs/issues/2030">issue
						2030</a>.</li>
					<li>05-Mar-2022: Forbid circular references and self-references in refinement chains. See <a
							href="https://github.com/w3c/epub-specs/issues/2031">issue 2031</a>.</li>
					<li>19-Feb-2022: Clarified the [^audio^] element's definition by making it optional and adapted the
						specification's text elsewhere to address the situation when the element is indeed not present.
						See <a href="https://github.com/w3c/epub-specs/issues/1986">issue 1986</a>.</li>
					<li>04-Feb-2022: Expanded the section on security and privacy to include new sections on the threat
						model for EPUB publications and additional recommendations for ensuring security and privacy.
						See <a href="https://github.com/w3c/epub-specs/issues/1871">issue 1871</a>, <a
							href="https://github.com/w3c/epub-specs/issues/1872">issue 1872</a>, <a
							href="https://github.com/w3c/epub-specs/issues/1875">issue 1875</a> and <a
							href="https://github.com/w3c/epub-specs/issues/1876">issue 1876</a>.</li>
					<li>21-Jan-2022: term "risky", used for the class of unsupported features, has been renamed to
						"under-implemented". See the <a
							href="https://www.w3.org/publishing/groups/epub-wg/Meetings/Minutes/2022-01-20-epub#resolution1"
							>WG resolution</a>.</li>
					<li>08-Dec-2021: The <code>page-spread-center</code> property is now an alias for
							<code>spread-none</code>. See <a href="https://github.com/w3c/epub-specs/issues/1929">issue
							1929</a>.</li>
					<li>03-Dec-2021: Added a new risky class for unsupported features. See <a
							href="https://github.com/w3c/epub-specs/issues/1944">issue 1944</a>.</li>
					<li>03-Dec-2021: Remove the element-based restrictions on remote resources. See <a
							href="https://github.com/w3c/epub-specs/issues/1913">issue 1913</a>.</li>
					<li>01-Dec-2021: Deprecated the use of <code>page-spread-center</code>. It is now an alias for
							<code>spread-none</code>. See <a href="https://github.com/w3c/epub-specs/issues/1929">issue
							1929</a>.</li>
					<li>26-Nov-2021: A requirement and an algorithm to detect out-of-container URLs has been added to
						the specification. See <a href="https://github.com/w3c/epub-specs/issues/1912">issue
						1912</a>.</li>
					<li>18-Nov-2021: Change to only disallow deprecated characters in the Tags and Variation Selectors
						Supplement. See <a href="https://github.com/w3c/epub-specs/issues/1885">issue 1885</a>.</li>
					<li>12-Nov-2021: Change the recommendation to use SHA-1 to encrypt the obfuscation key to a
						requirement. See <a href="https://github.com/w3c/epub-specs/issues/1873">issue 1873</a>.</li>
					<li>12-Nov-2021: Restrict the obfuscation algorithm to fonts and add caution to use better
						protection methods whenever possible. See <a
							href="https://github.com/w3c/epub-specs/issues/1873">issue 1873</a>.</li>
					<li>12-Nov-2021: Removed the statement about rights.xml being reserved for future standardization of
						DRM information. See <a href="https://github.com/w3c/epub-specs/issues/181">issue 1874</a>.</li>
					<li>10-Nov-2021: Proper definition of the content URL and handling of relative URLs. See <a
							href="https://github.com/w3c/epub-specs/issues/1374">issue 1374</a> and <a
							href="https://github.com/w3c/epub-specs/issues/1888">issue 1888</a></li>
					<li>29-Oct-2021: Recommended that EPUB creators not use path-absolute-URL strings for referencing
						resources due to the lack of a consistent root. See <a
							href="https://github.com/w3c/epub-specs/issues/1681">issue 1681</a>.</li>
					<li>18-Oct-2021: Clarified the contexts from which remote resources may be referenced. See <a
							href="https://github.com/w3c/epub-specs/issues/1857">issue 1857</a>.</li>
					<li>12-Oct-2021: The Structure Semantics Vocabulary has been moved into a separate Working Group
						Note. See <a href="https://github.com/w3c/epub-specs/issues/1763">issue 1763</a>.</li>
					<li>27-Aug-2021: Add clarifications for including landmarks, such as limiting the number,
						recommending known semantics, and ensuring the labels are human readable. Also added
						recommendation to not include nested lists to match the page list. See <a
							href="https://github.com/w3c/epub-specs/issues/1761">issue 1761</a>.</li>
					<li>22-July-2021: Clarified TTS handling of images in media overlays. See <a
							href="https://github.com/w3c/epub-specs/issues/1745">issue 1745</a>.</li>
					<li>09-July-2021: Restored the custom attributes section due to known usage but without reference to
						the attribute registry. See <a href="https://github.com/w3c/epub-specs/issues/1602">issue
							1602</a>.</li>
					<li>09-July-2021: Added the "Relationship to URL" section to explain the use of URL standard
						terminology in this document relative to resource formats that do not reference it. See <a
							href="https://github.com/w3c/epub-specs/issues/1726">issue 1726</a>.</li>
					<li>05-July-2021: Removed the section on private use area characters from the XHTML restrictions.
						The issues are more complex than what is covered and not in scope of EPUB to define. See <a
							href="https://github.com/w3c/epub-specs/issues/1732">issue 1732</a>.</li>
					<li>28-June-2021: Added a note discouraging EPUB creators from referencing resources outside the
						directory containing the package document to avoid interoperability issues. See <a
							href="https://github.com/w3c/epub-specs/issues/1687">issue 1687</a></li>
					<li>23-June-2021: Added the <code>base</code> element to the list of discouraged XHTML constructs.
						See <a href="https://github.com/w3c/epub-specs/issues/1699">issue 1699</a>.</li>
					<li>18-June-2021: Moved requirements for authoring SSML, PLS lexicons and CSS 3 Speech to the <a
							href="https://www.w3.org/TR/epub-tts-10/">EPUB 3 Text-to-Speech Enhancements</a> note. The
						ability to use these technologies in EPUB 3 publications remains unchanged. See <a
							href="https://github.com/w3c/epub-specs/issues/1690">issue 1690</a>.</li>
					<li>16-June-2021: Absolute URLs with <code>file</code> scheme should not be used on manifest items.
						See <a href="https://github.com/w3c/epub-specs/issues/1688">issue 1688</a>.</li>
					<li>31-May-2021: Require Unicode normalization and full case folding (in this order) for file name
						uniqueness comparisons. See <a href="https://github.com/w3c/epub-specs/issues/1631">issue
							1631</a> and <a href="https://github.com/w3c/epub-specs/pull/1648">pull request
						1648</a>.</li>
					<li>31-May-2021: Confirmed that SVG content documents do not have to be valid to the SVG
						specification, only meet the well-formedness and ID requirements currently referenced and the
						restrictions imposed by this specification. See <a
							href="https://github.com/w3c/epub-specs/issues/1323">issue 1323</a>.</li>
					<li>12-May-2021: Clarified that manifest items must not contain fragment identifiers. See <a
							href="https://github.com/w3c/epub-specs/issues/1303">issue 1303</a>.</li>
					<li>12-May-2021: Changed all references to URIs/IRIs to URLs and references to RFCs 3986 and 3987 to
						the URL standard. See <a href="https://github.com/w3c/epub-specs/issues/808">issue 808</a>.</li>
					<li>08-May-2021: Added clarifying text that <code>link</code> element can be used to link individual
						metadata properties in an alternative format. See <a
							href="https://github.com/w3c/epub-specs/issues/1666">issue 1666</a>.</li>
					<li>06-May-2021: Noted that the working group will no longer maintain the publication type and
						collection role registries and removed dependence on the latter for validating collection types
						(use of NMToken values remains restricted to extension specifications). The registry of
						authority codes is now integrated into the property definition. See <a
							href="https://github.com/w3c/epub-specs/pull/1664">pull request 1664</a>.</li>
					<li>06-May-2021: Added <code>application/ecmascript</code> as a core media type for scripts. See <a
							href="https://github.com/w3c/epub-specs/issues/1353">issue 1353</a>.</li>
					<li>06-May-2021: Added new section on fragment identifiers to media overlays and now recommend HTML
						target element references and SVG fragment identifiers instead of requiring conformance to the
						incompatible XPointer Shorthand syntax. See <a
							href="https://github.com/w3c/epub-specs/issues/1586">issue 1586</a>.</li>
					<li>28-Apr-2021: Drop requirement for resources referenced from HTML <code>link</code> elements to
						have core media type fallbacks. See <a href="https://github.com/w3c/epub-specs/issues/1312"
							>issue 1312</a>.</li>
					<li>22-Apr-2021: The usage of UTF-16 for CSS and XML has been changed, UTF-8 is the recommended
						encoding. See <a href="https://github.com/w3c/epub-specs/issues/1628">issue 1628</a>.</li>
					<li>19-Apr-2021: The use of custom attributes in EPUB content documents is no longer supported. See
							<a href="https://github.com/w3c/epub-specs/issues/1602">issue 1602</a>.</li>
					<li>13-Apr-2021: Require path names in OCF to also be UTF-8 encoded. See <a
							href="https://github.com/w3c/epub-specs/issues/1630">issue 1630</a>.</li>
					<li>12-Apr-2021: Added a reference to the SVG <code>direction</code> attribute in <a
							href="#sec-css-req"></a>. See <a href="https://github.com/w3c/epub-specs/issues/1613">issue
							1614</a>.</li>
					<li>09-Apr-2021: Added a new section dedicated to accessibility in EPUB publications.</li>
					<li>04-May-2021: Removed requirements around SVG <code>requiredExtensions</code> attribute. See <a
							href="https://github.com/w3c/epub-specs/issues/1087">issue 1087</a>.</li>
					<li>26-Mar-2021: Removed requirement for page list ordering to reflect the order of page breaks in
						the content. See <a href="https://github.com/w3c/epub-specs/issues/1500">issue 1500</a>.</li>
					<li>26-Mar-2021: Allowed <code>dc:creator</code> and <code>dc:contributor</code> elements to have
						multiple roles and allowed roles for <code>publisher</code>. See <a
							href="https://github.com/w3c/epub-specs/issues/1129">issue 1129</a> and <a
							href="https://github.com/w3c/epub-specs/issues/1583">issue 1583</a></li>
					<li>23-Mar-2021: Clarified the requirements for the use of data URLs in EPUB publications. See <a
							href="https://github.com/w3c/epub-specs/issues/1564">issue 1564</a>.</li>
					<li>17-Mar-2021: Include non characters at the end of the supplementary planes in list of characters
						not allowed in file names. See <a href="https://github.com/w3c/epub-specs/issues/1538">issue
							1538</a>.</li>
					<li>15-Mar-2021: Removed the normative dependencies on XML schemas and added element and attribute
						definitions for the <code>container.xml</code>, <code>encryption.xml</code> and
							<code>signatures.xml</code> files. All schemas are considered non-normative. See <a
							href="https://github.com/w3c/epub-specs/issues/1566">issue 1566</a>.</li>
					<li>10-Mar-2021: Require that resources referenced from an EPUB publication not be located in the
							<code>META-INF</code> directory. See <a href="https://github.com/w3c/epub-specs/issues/1205"
							>issue 1205</a>.</li>
					<li>08-Mar-2021: The fix for <a href="https://github.com/w3c/epub-specs/issues/1322">issue 1322</a>
						on 20-Jan-2021 incorrectly mentioned EPUB content documents having durations. Corrected to media
						overlay documents.</li>
					<li>08-Mar-2021: Added recommendation that <code>refines</code> attribute use fragment identifiers
						to reference publication resources. See <a href="https://github.com/w3c/epub-specs/issues/1361"
							>issue 1361</a>.</li>
					<li>08-Mar-2021: Change requirement that media overlay document <code>par</code> and
							<code>seq</code> ordering match the default reading order to guidance. See <a
							href="https://github.com/w3c/epub-specs/issues/1458">issue 1458</a></li>
					<li>05-Mar-2021: Clarified that whitespace within metadata element values is collapsed per the
						[[infra]] specification definition. See <a href="https://github.com/w3c/epub-specs/issues/1528"
							>issue 1528</a>.</li>
					<li>26-Feb-2021: Created a new section for describing general metadata value requirements,
						specifically whitespace handling. See <a href="https://github.com/w3c/epub-specs/issues/1528"
							>issue 1528</a>.</li>
					<li>17-Feb-2020: File extension recommendations have been removed (affects the package document,
						XHTML content documents, media overlay documents). See <a
							href="https://github.com/w3c/epub-specs/issues/1294">issue 1294</a>.</li>
					<li>15-Feb-2021: Clarified that <code>nav</code> elements without an <code>epub:type</code>
						attribute are not subject to the EPUB navigation document's content model restrictions. See <a
							href="https://github.com/w3c/epub-specs/issues/976">issue 976</a>.</li>
					<li>10-Feb-2021: A first draft of the <a href="#sec-security-privacy">security and privacy
							section</a> has been added.</li>
					<li>04-Feb-2021: Clarify that the value of <code>dc:language</code> elements must be well-formed
						language tags. See <a href="https://github.com/w3c/epub-specs/issues/1325">issue 1325</a>.</li>
					<li>02-Feb-2021: Added <code>auto</code> value for <code>dir</code> attribute and clarified the
						precedence of the attribute. See <a href="https://github.com/w3c/epub-specs/issues/1491">issue
							1491</a> and <a href="https://github.com/w3c/epub-specs/issues/1494">issue 1494</a>.</li>
					<li>02-Feb-2021: Added the <code>hreflang</code> attribute to <code>link</code> elements to identify
						the language of linked resources. See <a href="https://github.com/w3c/epub-specs/issues/1488"
							>issue 1488</a>.</li>
					<li>20-Jan-2021: Clarified that user-defined media overlay style classes must be declared in the
						package document metadata. See <a href="https://github.com/w3c/epub-specs/issues/1319">issue
							1319</a>.</li>
					<li>20-Jan-2021: Add recommendation that the sum of the media overlay durations for each EPUB
						content document match the total duration specified for the EPUB publication. See <a
							href="https://github.com/w3c/epub-specs/issues/1322">issue 1322</a>.</li>
					<li>20-Jan-2021: Clarified that the <code>epub:type</code> attribute does not improve the
						accessibility of publications. Added pointers to the <code>role</code> attribute and the
						DPUB-ARIA vocabulary for accessibility.</li>
					<li>13-Jan-2021: The requirement for progressive enhancement with spine-level scripting has been
						changed to a recommendation that top-level content documents remain consumable when scripting is
						not available. See <a href="https://github.com/w3c/epub-specs/issues/1444">issue 1444</a>.</li>
					<li>24-Dec-2020: The specification no longer refers to a release identifier, but the requirement to
						include a last modification date remains for backwards compatibility. See <a
							href="https://github.com/w3c/epub-specs/issues/1440">issue 1440</a>.</li>
					<li>16-Dec-2020: Terminology and requirements related to "renditions" of an EPUB publication have
						been simplified to improve the readability of the specifications (i.e., to align with the
						generally understood concept that an EPUB publication has only a single rendering described by a
						single package document). These changes do not affect the ability to include multiple
						renditions, which are now more fully covered in [[epub-multi-rend-11]]. See <a
							href="https://github.com/w3c/epub-specs/issues/1436">issue 1436</a>.</li>
					<li>14-Nov-2020: The term "semantic inflection" is no longer used to describe the process of adding
						structural semantics to elements. The term is not widely understood outside of EPUB and is
						unnecessarily complex. The specification now simply refers to "expressing" or "adding"
						structural semantics.</li>
					<li>09-Nov-2020: The requirement that the ordering of the <code>toc nav</code> match the ordering of
						EPUB content documents in the spine, and the elements within each file, has been reduced to a
						recommendation. See <a href="https://github.com/w3c/epub-specs/issues/1283">issue 1283</a>.</li>
					<li>06-Nov-2020: Clarified that HTML <code>script</code> elements that contain <a
							href="#sec-scripted-context">data blocks are not instances of scripting</a>. See <a
							href="https://github.com/w3c/epub-specs/issues/1352">issue 1352</a>.</li>
					<li>06-Nov-2020: Added WebP to the <a href="#cmt-grp-image">image core media types</a>. See <a
							href="https://github.com/w3c/epub-specs/issues/1344">issue 1344</a>.</li>
					<li>06-Nov-2020: A <a href="#app-identifiers-allowed">restricted set of external identifiers</a> are
						now allowed in publication resources. <a href="#sec-xml-constraints">References to external
							entities</a> from the internal DTD subset remain restricted, however. See <a
							href="https://github.com/w3c/epub-specs/issues/1338">issue 1338</a>.</li>
					<li>12-Oct-2020: Added OPUS to the <a href="#cmt-grp-audio">audio core media types</a> with a
						warning that it is still subject to review depending on support in Mac/iOS. See <a
							href="https://github.com/w3c/epub-specs/issues/645">issue 645</a>.</li>
					<li>30-Sept-2020: The structure of the EPUB core specifications has been simplified to ease
						understanding and access to information. This specification now consolidates the authoring
						requirements from the EPUB 3.2 specification together with the Packages, Content Documents, OCF
						and Media Overlays specifications. A separate document, EPUB Reading Systems 3.3, consolidates
						the reading system requirements from those documents.</li>
				</ul>
			</section>
		</section>
		<div data-include="../common/acknowledgements-dedication.html" data-oninclude="fixIncludes"
			data-include-replace="true"></div>
	</body>
</html>
