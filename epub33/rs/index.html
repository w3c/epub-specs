<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US">
	<head>
		<meta charset="utf-8" />
		<title>EPUB 3.3 Reading Systems</title>
		<script src="https://www.w3.org/Tools/respec/respec-w3c" class="remove"></script>
		<script src="../common/js/biblio.js" class="remove"></script>
		<script src="../common/js/dfn-crossref.js" class="remove"></script>
		<script src="../common/js/confreq-permalinks.js" class="remove"></script>
		<link href="../common/css/common.css" rel="stylesheet" type="text/css" />
		<script class="remove">
			//<![CDATA[
			var respecConfig = {
				group: "epub",
				wgPublicList: "public-epub-wg",
				specStatus: "ED",
				shortName: "epub-rs-33",
				edDraftURI: "https://w3c.github.io/publ-epub-revision/epub33/rs/",
				copyrightStart: "1999",
				editors:[ {
					name: "Garth Conboy",
					company: "Google",
					companyURL: "https://www.google.com"
				}, {
					name: "Dave Cramer",
					company: "Hachette Livre",
					companyURL: "https://www.hachettebookgroup.com",
				}, {
					name: "Marisa DeMeglio",
					company: "DAISY Consortium",
					companyURL: "https://www.daisy.org"
				}, {
					name: "Matt Garrish",
					company: "DAISY Consortium",
					companyURL: "https://www.daisy.org"
				}, {
					name: "Daniel Weck",
					company: "DAISY Consortium",
					companyURL: "https://www.daisy.org"
				}],
				includePermalinks: true,
				permalinkEdge: true,
				permalinkHide: false,
				diffTool: "http://www.aptest.com/standards/htmldiff/htmldiff.pl",
				github: {
					repoURL: "https://github.com/w3c/publ-epub-revision",
					branch: "master"
				},
				localBiblio: biblio,
				preProcess:[fixDefinitionCrossrefs],
				postProcess:[addConformanceLinks]
			};//]]></script>
	</head>
	<body>
		<section id="abstract">
			<p>EPUB® 3 defines a distribution and interchange format for digital publications and documents. The EPUB
				format provides a means of representing, packaging and encoding structured and semantically enhanced Web
				content — including HTML, CSS, SVG and other resources — for distribution in a single-file
				container.</p>
			<p>This spefication defines the conformance requirements for EPUB® 3 Reading Systems — the user agents that
				render EPUB Publications.</p>
		</section>
		<section id="sotd"></section>
		<section id="sec-introduction">
			<h2>Introduction</h2>

			<section id="sec-intro-overview">
				<h3>Overview</h3>

				<p>The EPUB 3 standard is separated into two distinct concerns: the authoring of <a>EPUB
						Publications</a> is defined in the <a href="epub-core.html">core specification</a> [[EPUB-33]],
					while this specification details the rendering requirements for them in <a>EPUB Reading
					Systems</a>.</p>

				<p>An EPUB Reading System can take many forms. It might have a visual display area for rendering the
					content to users, for example, or it might only provide audio playback of the content. As a result,
					there is no single set of rules that all Reading Systems have to follow. Rather, the rendering
					requirements are broken down based on the Reading System's capabilities and the features its
					supports.</p>

				<p>Moreover, a great deal of flexibility is provided to developers to create unique user interfaces,
					such as their bookshelves. As a result, metadata processing requirements are often quite minimal,
					for example.</p>

				<p>So although this specification identifies the formal requirements for Reading Systems, it is not
					possible to read this document in isolation. Developers will also need to familiarize themselves
					with the full content structure of an EPUB Publication in order to understand the complete range of
					information that is available.</p>
			</section>

			<section id="conformance"></section>

			<section id="sec-intro-relations" class="informative">
				<h3>Relationship to Other Specifications</h3>

				<section id="rel">
					<h4>Relationship to HTML</h4>

					<p>This specification does not reference a specific version of W3C [[HTML]], but instead uses an
						undated reference that will always point to the latest recommendation. This approach ensures
						that EPUB will always keep pace with changes to the HTML standard. Reading System developers
						will need to keep track of changes to HTML, and ensure that their systems are kept up to
						date.</p>

					<p>This specification does not require <a>EPUB Reading Systems</a> to support scripting, HTML forms
						or the HTML DOM. Reading Systems conformant with this specification are only expected to be able
						to process a conforming <a>EPUB Content Document</a>. As <a href="#sec-scripted-content-rs-reqs"
							>support for scripting and HTML forms</a> is not compulsory, a conformant Reading System
						might not be a fully-conformant HTML user agent.</p>
				</section>


				<section id="sec-overview-relations-svg">
					<h4>Relationship to SVG</h4>

					<p>This specification does not reference a specific version of [[SVG]], but instead uses an undated
						reference. Whenever there is any ambiguity in this reference, the latest recommended
						specification is the authoritative reference.</p>

					<p>This approach ensures that EPUB will always keep pace with changes to the SVG standard. Reading
						System developers will need to keep track of changes to the SVG standard, and ensure that their
						systems are kept up to date.</p>
				</section>
			</section>
		</section>
		<section id="sec-rs-conf-general">
			<h2>Conformance Requirements</h2>

			<p>An <a>EPUB Reading System</a> is conformant with this specification if it meets the following
				requirements:</p>

			<dl class="conformance-list">
				<dt id="sec-epub-rs-conf-epub3">EPUB 3 Processing</dt>
				<dd>
					<ul class="conformance-list">
						<li>
							<p id="confreq-rs-epub3-ocf">It MUST process the <a>EPUB Container</a> as defined in <a
									href="#ocf"></a>.</p>
						</li>
						<li>
							<p id="confreq-rs-epub3-package">It MUST process <a>EPUB Packages</a> as defined in <a
									href="#packages"></a>.</p>
						</li>
						<li>
							<p id="confreq-rs-foreign">It MAY support an arbitrary set of <a>Foreign Resource</a> types,
								and MUST process fallbacks for unsupported Foreign Resources as defined in <a
									href="epub-core.html#sec-foreign-restrictions">Foreign Resources</a> [[!EPUB-33]] if
								not.</p>
						</li>
						<li>
							<p id="confreq-rs-remote">It SHOULD support <a>remote resources</a>, as defined in <a
									href="epub-core.html#sec-resource-locations">Resource Locations</a>
								[[!EPUB-33]].</p>
						</li>
						<li>
							<p id="confreq-rs-epub3-xhtml">It MUST process <a>XHTML Content Document</a> as defined in
									<a href="#sec-xhtml-conf-rs"></a>.</p>
						</li>
						<li>
							<p id="confreq-rs-epub3-svg">It MUST process <a>SVG Content Documents</a> as defined in <a
									href="#sec-svg"></a>.</p>
						</li>
						<li>
							<p id="confreq-rs-epub3-css">If it has a <a>Viewport</a>, it MUST support visual rendering
								of <a>XHTML Content Documents</a> as defined in <a href="#sec-css-rs-conf"></a>.</p>
						</li>
						<li>
							<p id="confreq-rs-epub3-images">If it has a Viewport, it MUST support the <a
									href="epub-core.html#cmt-grp-image">image Core Media Type Resources</a>
								[[!EPUB-33]].</p>
						</li>
						<li>
							<p id="confreq-rs-epub3-mp3-aac">If it has the capability to render pre-recorded audio, it
								MUST support the <a href="epub-core.html#cmt-grp-audio">audio Core Media Type
									Resources</a> [[!EPUB-33]] and SHOULD support Media Overlays [[!EPUB-33]].</p>
						</li>
						<li>
							<p id="confreq-rs-epub3-tts">If it supports <a>Text-to-Speech</a> (TTS) rendering, it SHOULD
								support <a href="#sec-pls-conf-rs">Pronunciation Lexicons</a>, [[!CSS3Speech]] and <a
									href="epub-core.html#sec-xhtml-ssml-attrib">SSML attributes</a> [[!EPUB-33]] in
									<a>XHTML Content Documents</a>.</p>
						</li>
					</ul>
					<p class="note" id="note-video-codecs">It is recommended that Reading Systems support at least one
						of the H.264 [[H264]] and VP8 [[RFC6386]] video codecs, but this is not a conformance
						requirement – a Reading System might support other video codecs, or none at all. Authors and
						Reading System developers need to take into consideration factors such as breadth of adoption,
						video playback quality, and technology usage royalty requirements when making a choice to
						include or implement video in either format, or both.</p>
				</dd>
				<dt id="sec-epub-rs-conf-a11y">Accessibility</dt>
				<dd>
					<ul class="conformance-list">
						<li>
							<p id="confreq-rs-a11y">It SHOULD meet the accessibility requirements for Reading Systems in
								[[!EPUBAccessibility-10]].</p>
						</li>
					</ul>
				</dd>
				<dt id="sec-epub-rs-conf-backward">Backward Compatibility</dt>
				<dd>
					<ul class="conformance-list">
						<li>
							<p id="confreq-rs-backward-epub">It MUST attempt to process any given rendition of an EPUB
								Publication whose Package Document <code>version</code> attribute is less than
									"<code>3.0</code>".</p>
						</li>
						<li>
							<p id="confreq-rs-backward-conf">EPUB Publications with older version numbers will not
								always render exactly as intended unless processed according to their respective
								specifications. Reading Systems SHOULD support such EPUB Publications as defined by
								those specifications.</p>
						</li>
					</ul>
				</dd>
				<dt id="sec-epub-rs-conf-forward">Forward Compatibility</dt>
				<dd>
					<ul class="conformance-list">
						<li>
							<p id="confreq-rs-forward-epubn">It SHOULD attempt to process any given Rendition of an EPUB
								Publication whose Package Document <code>version</code> attribute is greater than
									"<code>3.0</code>".</p>
						</li>
					</ul>
				</dd>
				<dt id="sec-epub-rs-conf-xml">XML Processing</dt>
				<dd>
					<ul class="conformance-list">
						<li>
							<p id="confreq-rs-xml-nval">It MUST be a <a
									href="https://www.w3.org/TR/2008/REC-xml-20081126/#proc-types">conformant
									non-validating processor</a> [[!XML]].</p>
						</li>
						<li>
							<p id="confreq-rs-xml-ns"> It MUST be a <a
									href="https://www.w3.org/TR/2009/REC-XML-NAMES-20091208/#ProcessorConformance"
									>conformant processor</a> as defined in [[!XML-NAMES]].</p>
						</li>
						<li>
							<p id="confreq-rs-xml-base">It MUST be a conformant application as defined by [[!XMLBase]].
									<span class="note">Note: [[HTML]] and [[SVG]] are removing support for [[!XMLBase]].
									Authors are advised to avoid using this feature.</span></p>
						</li>
					</ul>
				</dd>
			</dl>
			<div class="note">
				<p>A conforming Reading System is not necessarily a single dedicated program or device, but might exist
					as a distributed system.</p>
			</div>
		</section>
		<section id="packages">
			<h2>Package Processing</h2>

			<section id="sec-package-rs-conformance">
				<h3>Basic Conformance</h3>

				<p>An <a>EPUB Reading System</a> is conformant with this section if meets all of the following
					criteria:</p>

				<ul class="conformance-list">
					<li>
						<p id="confreq-rendition-rs-package">It MUST honor all presentation logic expressed through the
								<a href="epub-core.html#sec-package-def">Package Document</a> [[!EPUB-33]] (e.g., the
							reading order, fallback chains, page progression direction and fixed layouts).</p>
					</li>
					<li>
						<p id="confreq-rs-package-def">It MUST process the Package Document in conformance with all
							Reading System conformance constraints expressed in <a href="#sec-package-def"></a>.</p>
					</li>
					<li>
						<p id="confreq-rs-epub3-presentational-meta">It SHOULD process rendering metadata, as expressed
							in <a href="#sec-package-metadata-rendering"></a>.</p>
					</li>
					<li>
						<p id="confreq-rs-epub3-fxl-meta">It MUST process fixed layout metadata, as expressed in <a
								href="#sec-package-metadata-fxl"></a>.</p>
					</li>
					<li>
						<p id="confreq-rs-epub3-fxl-conflicts">It MUST ignore proprietary metadata properties that
							pertain to layout expressions if they conflict behaviorally with the property semantics
							defined in <a href="#sec-package-metadata-fxl"></a>.</p>
					</li>
					<li>
						<p id="confreq-rendition-rs-manifest">It MUST NOT use any resources not listed in the Package
							Document in the processing of the Package (e.g., <a
								href="epub-core.html#sec-container-metainf"><code>META-INF</code> files</a> [[EPUB-33]]
							or resources specific to other Renditions of the EPUB Publication).</p>
					</li>
				</ul>
			</section>

			<section id="sec-package-def">
				<h3>Package Document</h3>

				<section id="metadata">
					<h4>Metadata</h4>

					<div class="note">
						<p>When an element has mandatory text content, that content is referred to as the value of the
							element in the following requirements.</p>
					</div>

					<dl class="conformance-list">
						<dt id="conf-meta-ws">White Space</dt>
						<dd>
							<p>Reading Systems MUST trim all leading and trailing <a
									href="https://www.w3.org/TR/xml/#white">white space</a> [[!XML]] from Dublin Core
								element values before processing.</p>

							<p>Unless an individual property explicitly defines a different white space normalization
								algorithm, Reading Systems MUST trim all leading and trailing <a
									href="https://www.w3.org/TR/xml/#white">white space</a> [[!XML]] from
									<code>meta</code> element values before further processing them.</p>
						</dd>

						<dt id="dc-identifier">The <code>identifier</code> element</dt>
						<dd>
							<p>To determine whether an <code>identifier</code> conforms to an established system or has
								been granted by an issuing authority, Reading Systems SHOULD check for an <a
									href="epub-core.html#identifier-type"><code>identifier-type</code> property</a>
								[[!EPUB-33]].</p>
						</dd>

						<dt id="dc-title">The <code>title</code> element</dt>
						<dd>
							<p id="title-order"><a>Reading Systems</a> MUST recognize the first <code>title</code>
								element in document order as the main title of the EPUB Publication (i.e., the primary
								one to present to users). This specification does not define how to process additional
									<code>title</code> elements.</p>
						</dd>

						<dt id="dc-creator">The <code>creator</code> element</dt>
						<dd>
							<p>When determining display priority, Reading Systems MUST use the document order of
									<code>creator</code> elements in the <code>metadata</code> section, where the first
									<code>creator</code> element encountered is the primary creator. If a Reading System
								exposes creator metadata to the user, it SHOULD include all the creators listed in the
									<code>metadata</code> section whenever possible (e.g., when not constrained by
								display considerations).</p>
						</dd>

						<dt id="meta">The <code>meta</code> element</dt>
						<dd>
							<p>If a Reading System does not recognize the <code>scheme</code> attribute value, it SHOULD
								treat the value of the element as a string.</p>

							<p>Reading Systems SHOULD ignore all <code>meta</code> elements whose <code>property</code>
								attributes define expressions they do not recognize. A Reading System MUST NOT fail when
								encountering unknown expressions.</p>
						</dd>

						<dt id="conf-metadata-link">The <code>link</code> element</dt>
						<dd>
							<p>Retrieval of Remote Resources is OPTIONAL.</p>

							<p>Reading System do not have to use or present linked resources, even if they recognize the
								relationship defined in the <code>rel</code> attribute.</p>

							<p id="sec-linked-records">In the case of a <a href="epub-core.html#record">linked metadata
									record</a> [[!EPUB-33]], Reading Systems MUST NOT skip processing the metadata
								expressed in the Package Document and only use the information expressed in the record.
								Reading Systems MAY compile metadata from multiple linked records; they do not have to
								select only one record.</p>

							<p>When it comes to resolving discrepancies and conflicts between metadata expressed in the
								Package Document and in linked metadata records, Reading Systems MUST use the document
								order of <code>link</code> elements in the Package Document to establish precedence
								(i.e., metadata in the first linked record encountered has the highest precedence and
								metadata in the Package Document the lowest, regardless of whether the <code>link</code>
								elements occur before, within or after the package metadata elements).</p>

							<p>Reading Systems MUST ignore any instructions contained in linked resources related to the
								layout and rendering of the EPUB Publication.</p>
						</dd>
					</dl>
				</section>

				<section id="manifest">
					<h3>Manifest</h3>
					<dl class="conformance-list">
						<dt>The <code>item</code> element</dt>
						<dd>
							<p>When an <code>href</code> attribute contains a relative IRI, Reading Systems MUST use the
								IRI of the Package Document as the base when resolving to an absolute IRI.</p>

							<p>Reading Systems MAY optimize the rendering depending on the properties set in the
									<code>properties</code> attribute (e.g., disable a rendering process or use a
								fallback). Reading Systems MUST ignore all descriptive metadata properties that they do
								not recognize.</p>

							<p>A Reading System that does not support the Media Type of a given Publication Resource
								MUST traverse the fallback chain until it has identified at least one supported
								Publication Resource to use in place of the unsupported resource. If the Reading System
								supports multiple Publication Resources in the fallback chain, it MAY select the
								resource to use based on specific <a href="epub-core.html#attrdef-item-properties"
									>properties</a> [[!EPUB-33]] of that resource, otherwise it SHOULD honor the
								Author's preferred fallback order. If a Reading System does not support any resource in
								the fallback chain, it MUST alert the reader that content could not be displayed.</p>
						</dd>
						<dt>Manifest Fallbacks</dt>
						<dd>
							<p>Reading System MAY choose to utilize fallbacks in order to find the optimal version of a
								Content Document to render in a given context.</p>
						</dd>
					</dl>
				</section>

				<section id="spine">
					<h3>Spine</h3>

					<dl class="conformance-list">
						<dt id="sec-spine-elem">The <code>spine</code> element</dt>
						<dd>
							<p>Reading Systems MUST provide a means of rendering the Rendition in the order defined in
								the <code>spine</code>, which includes: 1) recognizing the first primary
									<code>itemref</code> as the beginning of the default reading order; and, 2)
								rendering successive primary items in the order given in the <code>spine</code>.</p>

							<p>When the <code>default</code> value is specified, the Reading System can choose the
								rendering direction. The <code>default</code> value MUST be assumed when the attribute
								is not specified. In this case, the reading system SHOULD choose a default
									<code>page-progression-direction</code> value based on the first
									<code>language</code> element.</p>

							<p>Reading Systems MUST ignore the page progression direction defined in <a href="#layout"
										><code>pre-paginated</code></a> XHTML Content Documents. The
									<code>page-progression-direction</code> attribute defines the flow direction from
								one fixed-layout page to the next.</p>
						</dd>

						<dt id="sec-itemref-elem">The <code>itemref</code> element</dt>
						<dd>
							<p>When rendering an EPUB Publication, a Reading System MAY either suppress non-linear
								content so that it does not appear in the default reading order, or ignore the
									<code>linear</code> attribute in order to provide users access to the entire content
								of the EPUB Publication. This specification does not mandate which model Reading Systems
								have to use. A Reading System MAY also provide the option for users to toggle between
								the two models.</p>

							<p>Reading Systems MUST ignore all metadata properties expressed in the
									<code>properties</code> attribute that they do not recognize.</p>
						</dd>
					</dl>
				</section>

				<section id="sec-collections">
					<h3>Collections</h3>

					<p>In the context of this specification, support for collections in Reading Systems is OPTIONAL.
						Reading Systems MUST ignore <code>collection</code> elements that define unrecognized roles.</p>
				</section>

			</section>

			<section id="sec-pub-identifiers">
				<h3>Publication Identifiers</h3>

				<dl class="conformance-list">
					<dt id="sec-unique-id">Unique Identifiers</dt>
					<dd>
						<p>Reading Systems MUST NOT depend on the Unique Identifier being unique to one and only one
							EPUB Publication. Determining whether two EPUB Publications with the same Unique Identifier
							represent different versions of the same publication (see <a
								href="epub-core.html#sec-metadata-elem-identifiers-pid">Release Identifier</a>
							[[!EPUB-33]]), or different publications, might require inspecting other metadata, such as
							the titles or authors.</p>
					</dd>
				</dl>
			</section>

			<section id="sec-vocab-assoc">
				<h3>Vocabulary Association Mechanisms</h3>

				<dl class="conformance-list">
					<dt id="sec-metadata-reserved-prefixes">Reserved Prefixes</dt>
					<dd>
						<p>Reading Systems MUST resolve all reserved prefixes used in Package Documents using their
							predefined URIs unless a local <a href="#sec-prefix-attr">prefix</a> is declared. Reading
							Systems MUST use locally-overriden prefixes in the <code>prefix</code> attribute when
							encountered.</p>

						<p>As changes to the reserved prefixes and updates to Reading Systems are not always going
							happen in synchrony, Reading Systems MUST NOT fail when encountering unrecognized prefixes
							(i.e., not reserved and not declared using the <code>prefix</code> attribute).</p>
					</dd>

					<dt id="sec-prefix-attr">The <code>prefix</code> attribute</dt>
					<dd>
						<p>If the <code>prefix</code> attribute includes a declaration for a <a
								href="#sec-metadata-reserved-prefixes">predefined prefix</a>, Reading Systems MUST use
							the URI mapping defined in the <code>prefix</code> attribute, regardless of whether of it
							maps to the same URI as the predefined prefix.</p>
					</dd>

					<dt id="sec-property-datatype">The <code>property</code> Data Type</dt>
					<dd>
						<p>A Reading System MUST use the following rules to create an IRI [[!RFC3987]] from a
							property:</p>

						<ul>
							<li>
								<p>If the property consists only of a reference, the IRI is obtained by concatenating
									the IRI stem associated with the <a href="epub-core.html#sec-metadata-default-vocab"
										>default vocabulary</a> [[!EPUB-33]] to the reference.</p>
							</li>
							<li>
								<p>If the property consists of a prefix and reference, the IRI is obtained by
									concatenating the IRI stem associated with the prefix to the reference. If no
									matching prefix has been defined, the property is invalid and MUST be ignored.</p>
							</li>
						</ul>

						<p>The resulting IRI MUST be valid to [[!RFC3987]]. Reading Systems do not have to resolve this
							IRI, however.</p>
					</dd>
				</dl>
			</section>

			<section id="sec-package-metadata-rendering">
				<h3>Package Rendering Metadata</h3>

				<section id="sec-package-metadata-general">
					<h4>General Properties</h4>

					<section id="flow">
						<h5>The <code>rendition:flow</code> Property</h5>

						<p>If a Reading System supports the specified rendering, it SHOULD use that method to handle
							overflow content, but MAY provide the option for users to override the requested
							rendering.</p>

						<p>The default value <code>auto</code> MUST be assumed by Reading Systems as the global value if
							no <code>meta</code> element carrying this property occurs in the <a
								href="epub-core.html#elemdef-opf-metadata"><code>metadata</code> section</a>
							[[!EPUB-33]]. Reading Systems MAY support only this default value.</p>

						<p>If a Reading Systems supports the <a href="#layout"><code>rendition:layout</code></a>
							property, it MUST ignore the <code>rendition:flow</code> property when it has been set on a
							spine item that also specifies the <a href="#layout"><code>rendition:layout</code></a> value
								<code>pre-paginated</code>.</p>

						<p>The <code>rendition:flow</code> property values have the following processing
							requirements:</p>

						<dl class="variablelist">
							<dt id="paginated">paginated</dt>
							<dd>
								<p>The Reading System SHOULD dynamically paginate all overflow content.</p>
							</dd>
							<dt id="scrolled-continuous">scrolled-continuous</dt>
							<dd>
								<p>The Reading System SHOULD render all Content Documents such that overflow content is
									scrollable, and the EPUB Publication represented by the given <a>Rendition</a>
									SHOULD be presented as one continuous scroll from spine item to spine item (except
									where <a href="epub-core.html#layout-property-flow-overrides">locally overridden</a>
									[[!EPUB-33]]).</p>
							</dd>
							<dt id="scrolled-doc">scrolled-doc</dt>
							<dd>
								<p>The Reading System SHOULD render all Content Documents such that overflow content is
									scrollable, and each spine item SHOULD be presented as a separate scrollable
									document.</p>
							</dd>
							<dt id="auto">auto</dt>
							<dd>
								<p>The Reading System MAY render overflow content using its default method or a user
									preference, whichever is applicable.</p>
							</dd>
						</dl>

						<p>For the <code>rendition:flow-scrolled-continuous</code> property, the scroll direction is
							defined relative to the block flow direction of the root element of the XHTML Content
							Document referenced by the <a href="epub-core.html#elemdef-spine-itemref"
									><code>itemref</code> element</a> [[!EPUB-33]]. The scroll direction is vertical if
							the block flow direction is downward (top-to-bottom). It is horizontal if the block flow
							direction of the root element is rightward (left-to-right) or leftward (right-to-left).</p>
					</section>

					<section id="align-x-center">
						<h5>The <code>rendition:align-x-center</code> Property</h5>

						<p>When the <a href="#align-x-center"><code>rendition:align-x-center</code> property</a> is set
							on a spine item, Reading Systems SHOULD reneder the content centered horizontally within the
								<a>Viewport</a> or spread, as applicable. This property does not affect the rendering of
							the spine item, only the placement of the resulting content box.</p>

						<p>For reflowable content, Reading Systems that support this property MUST center each virtual
							page.</p>

						<p>This version of this specification does not define a default rendering behavior when this
							property is not supported or specified. Reading Systems MAY render spine items by their own
							design.</p>
					</section>
				</section>

				<section id="sec-package-metadata-fxl">
					<h4>Fixed-Layout Properties</h4>

					<section id="layout">
						<h5>The <code>rendition:layout</code> Property</h5>

						<p>The default value <code>reflowable</code> MUST be assumed by <a>EPUB Reading Systems</a> as
							the global value if no <code>meta</code> element carrying this property occurs in the <a
								href="epub-core.html#elemdef-opf-metadata"><code>metadata</code> section</a>
							[[!EPUB-33]].</p>

						<p>When the <code>rendition:layout</code> property is set to <code>pre-paginated</code>, Reading
							Systems MUST NOT include space between the adjacent content slots when rendering
								<a>Synthetic Spreads</a>.</p>

						<p>The <code>rendition:layout</code> property values have the following processing
							requirements:</p>

						<dl class="variablelist">
							<dt id="def-layout-reflowable">reflowable</dt>
							<dd>
								<p>Reading Systems MAY apply dynamic pagination when rendering.</p>
							</dd>
							<dt id="def-layout-pre-paginated">pre-paginated</dt>
							<dd>
								<p>Reading Systems MUST produce exactly one page per spine <a
										href="epub-core.html#elemdef-spine-itemref"><code>itemref</code></a>
									[[!EPUB-33]] when rendering.</p>
							</dd>
						</dl>
					</section>

					<section id="orientation">
						<h5>The <code>rendition:orientation</code> Property</h5>

						<p>The default value <code>auto</code> MUST be assumed by Reading Systems as the global value if
							no <code>meta</code> element carrying this property occurs in the <code>metadata</code>
							section.</p>

						<p>Reading Systems that support multiple orientations SHOULD convey the intended orientation to
							the user, unless the given value is <code>auto</code>. The means by which the intent is
							conveyed is implementation-specific.</p>
					</section>

					<section id="spread">
						<h5>The <code>rendition:spread</code> Property</h5>

						<p>The default value <code>auto</code> MUST be assumed by Reading Systems as the global value if
							no <code>meta</code> element carrying this property occurs in the <code>metadata</code>
							section.</p>

						<p>The <code>rendition:spread</code> property values have the following processing
							requirements:</p>

						<dl class="variablelist">
							<dt>none</dt>
							<dd>
								<p>Reading Systems MUST NOT incorporate spine items in a Synthetic Spread.</p>
							</dd>
							<dt>landscape</dt>
							<dd>
								<p>Reading Systems SHOULD render a Synthetic Spread for spine items only when the device
									is in landscape orientation.</p>
							</dd>
							<dt>portrait (deprecated)</dt>
							<dd>
								<p>Reading Systems SHOULD treat the value "<code>portrait</code>" as a synonym of
										"<code>both</code>" and create spreads regardless of orientation.</p>
							</dd>
							<dt>both</dt>
							<dd>
								<p>Reading Systems SHOULD render a Synthetic Spread regardless of device
									orientation.</p>
							</dd>
							<dt>auto</dt>
							<dd>
								<p>Reading Systems MAY use Synthetic Spreads in specific or all device orientations as
									part of a <a>Content Display Area</a> utilization optimization process.</p>
							</dd>
						</dl>
					</section>

					<section id="page-spread">
						<h5>The <code>rendition:page-spread-*</code> Properties</h5>

						<p>The <code>rendition:page-spread-left</code> property indicates that the given spine item
							SHOULD be rendered in the left-hand slot in the spread, and
								<code>rendition:page-spread-right</code> that it SHOULD be rendered in the right-hand
							slot. The <code>rendition:page-spread-center</code> property indicates that the synthetic
							spread mode SHOULD be overridden and a single viewport rendered and positioned at the center
							of the screen.</p>

						<p>The <code>rendition:page-spread-left</code>, <code>rendition:page-spread-right</code> and
								<code>rendition:page-spread-center</code> properties apply to both pre-paginated and
							reflowable content, and they only apply when the Reading System is creating Synthetic
							Spreads.</p>

						<p>The <code>rendition:page-spread-*</code> properties take precedence over whatever value of
							the <a href="https://www.w3.org/TR/CSS2/page.html#propdef-page-break-before"
									><code>page-break-before</code> property</a> [[!CSSSnapshot]] has been set for an
								<a>XHTML Content Document</a>.</p>

						<div class="note">
							<p>The presence of <code>rendition:page-spread-center</code> does not change the viewport
								dimensions. In particular, it does not indicate that a viewport with the size of the
								whole spread has to be created. This is important so that the scale factor stays
								consistent between regular and center-spread pages.</p>
						</div>

						<p>When a <a href="#def-layout-reflowable">reflowable</a> spine item follows a <a
								href="#def-layout-pre-paginated">pre-paginated</a> one, the reflowable one SHOULD start
							on the next page (as defined by the <a
								href="epub-core.html#attrdef-spine-page-progression-direction"
									><code>page-progression-direction</code></a> [[EPUB-33]]) when it lacks a
								<code>rendition:page-spread-*</code> property value. If the reflowable spine item has a
								<code>rendition:page-spread-*</code> specification, it MUST be honored (e.g., by
							inserting a blank page).</p>

						<p>Similarly, when a pre-paginated spine item follows a reflowable one, the pre-paginated one
							SHOULD start on the next page (as defined by the <code>page-progression-direction</code>)
							when it lacks a <code>rendition:page-spread-*</code> property value. If the pre-paginated
							spine item has a <code>rendition:page-spread-*</code> specification, it MUST be honored
							(e.g., by inserting a blank page).</p>

						<p>When a Reading System encounters two spine items that represent a true spread (i.e., two
							adjacent spine items with the <code>rendition:page-spread-left</code> and
								<code>rendition:page-spread-right</code> properties), it SHOULD create the spread with
							no space between the adjacent pages.</p>
					</section>
				</section>
			</section>

			<section id="sec-package-nav">
				<h3>Navigation Document</h3>

				<section id="sec-package-nav-rs-conf">
					<h4>General Conformance</h4>

					<p>A conformant <a>EPUB Reading System</a> has to meet the following criteria for processing <a>EPUB
							Navigation Documents</a>:</p>

					<ul class="conformance-list">
						<li>
							<p id="confreq-nav-access">When requested by a user, it MUST provide access to the links and
								link labels in <a href="epub-core.html#sec-package-nav-def-types">the <code>nav</code>
									elements</a> [[!EPUB-33]] of the EPUB Navigation Document in a fashion that allows
								the user to activate the links.</p>
						</li>
						<li>
							<p id="confreq-nav-activation">When a link is activated, it MUST relocate the application's
								current reading position to the destination identified by that link.</p>
						</li>
						<li>
							<p id="confreq-nav-spine">It MUST honor the above requirements irrespective of whether the
								EPUB Navigation Document is part of the <a href="#sec-spine-elem">spine</a>.</p>
						</li>
					</ul>
				</section>

				<section id="sec-package-nav-def-model">
					<h4>The <code>nav</code> Element: Restrictions</h4>

					<p id="confreq-nav-ol-style">In the context of this specification, the default display style of list
						items within <code>nav</code> elements MUST be equivalent to the <a
							href="https://www.w3.org/TR/CSS2/generate.html#propdef-list-style"><code>list-style:
								none</code> property</a> [[!CSSSnapshot]]. Reading Systems MUST NOT show list item
						numbering on these lists when presenting the Navigation Document outside of the spine,
						regardless of their support for CSS.</p>
				</section>
			</section>
		</section>
		<section id="contentdocs">
			<h2>Content Document Processing</h2>

			<section id="sec-xhtml">
				<h3>XHTML Content Documents</h3>

				<section id="sec-xhtml-conf-rs">
					<h4>General Conformance</h4>

					<p>A conformant <a>EPUB Reading System</a> has to meet the following criteria for processing
							<a>XHTML Content Documents</a>:</p>

					<ul class="conformance-list">
						<li>
							<p id="confreq-html-rs-behavior">Unless explicitly defined by this specification as
								overridden, it MUST process XHTML Content Documents using semantics defined by the
								[[!HTML]] specification and honor any applicable user agent conformance constraints
								expressed therein.</p>
						</li>
						<li>
							<p id="confreq-html-rs-behavior-add">It MUST meet all Reading System conformance criteria
								defined in <a href="#sec-xhtml-extensions"></a>.</p>
						</li>
						<li>
							<p id="confreq-html-rs-behavior-restr">It MUST recognize and adapt behaviorally to the
								constraints defined in <a href="#sec-xhtml-deviations"></a>.</p>
						</li>
						<li>
							<p id="confreq-html-rs-scrpt">It MUST meet the Reading System conformance criteria defined
								in <a href="#sec-scripted-content-rs-reqs"></a>.</p>
						</li>
						<li>
							<p id="confreq-html-rs-css">It MUST support visual rendering of XHTML Content Documents as
								defined in <a href="#sec-css-rs-conf"></a>.</p>
						</li>
						<li>
							<p id="confreq-html-rs-a11y">It SHOULD recognize embedded ARIA markup and support exposure
								of any given ARIA roles, states and properties to platform accessibility APIs
								[[!WAI-ARIA]].</p>
						</li>
					</ul>
				</section>

				<section id="sec-xhtml-extensions">
					<h4>HTML Extensions</h4>

					<section id="sec-xhtml-semantic-inflection">
						<h5>Semantic Inflection</h5>

						<p>A Reading System has to process the <code>epub:type</code> attribute as follows:</p>

						<ul class="conformance-list">
							<li>
								<p id="confreq-rs-epubtype-beh">It MAY associate behaviors with none, some or all of the
									terms defined in the <a href="epub-core.html#sec-contentdocs-default-vocab">default
										vocabulary</a> [[EPUB-33]].</p>
							</li>
							<li>
								<p id="confreq-rs-epubtype-oth">It MAY associate behaviors with terms from other
									vocabularies.</p>
							</li>
							<li>
								<p id="confreq-rs-epubtype-ign">It MUST ignore terms that it does not recognize.</p>
							</li>
							<li>
								<p id="confreq-rs-epubtype-conflict">It MUST <a href="#confreq-rs-epubtype-prec">ignore
										inflected semantics</a> that conflict with the carrying element.</p>
							</li>
							<li>
								<p id="confreq-rs-epubtype-head">It MUST ignore semantics expressed on the [[!HTML]] <a
										href="https://www.w3.org/TR/html/document-metadata.html#the-head-element"
											><code>head</code></a> element or its descendants.</p>
							</li>
						</ul>

						<p id="confreq-rs-epubtype-prec">When Reading System behavior associated with a given
								<code>epub:type</code> value conflicts with an element's native behavior, the behavior
							associated with the element MUST be given precedence.</p>
					</section>
					<section id="sec-xhtml-semantic-enrichment">
						<h5>Semantic Enrichment</h5>

						<dl class="conformance-list">
							<dt id="sec-xhtml-sementic-enrichment-rdfa">RDFa</dt>
							<dd>
								<p><a>EPUB Reading System</a> support for the <a
										href="https://www.w3.org/TR/2015/REC-rdfa-core-20150317/#s_model">attribute
										processing model</a> [[!RDFA-CORE]] is OPTIONAL.</p>
							</dd>

							<dt id="sec-xhtml-sementic-enrichment-microdata">Microdata</dt>
							<dd>
								<p><a>EPUB Reading System</a> support for the <a
										href="https://www.w3.org/TR/microdata/#encoding-microdata">attribute processing
										model</a> is OPTIONAL, as is the <a href="https://www.w3.org/TR/microdata/#json"
										>conversion to JSON</a> [[!Microdata]].</p>
							</dd>
						</dl>
					</section>

					<section id="sec-xhtml-ssml-attrib">
						<h5>SSML Attributes</h5>

						<dl class="conformance-list">
							<dt id="sec-cd-ssml-ph-attrib">The <code>ssml:ph</code> attribute</dt>
							<dd>
								<p>Reading Systems that support the SSML Attributes and <a href="epub-core.html#sec-pls"
										>PLS documents</a> [[!EPUB-33]] MUST honor the defined <a
										href="#confreq-pls-rs-casc">precedence rules</a> for these two constructs.</p>
							</dd>

							<dt id="sec-cd-ssml-alphabet-attrib">The <code>ssml:alphabet</code> attribute</dt>
							<dd>
								<p>Reading Systems that support the <a href="#sec-xhtml-ssml-attrib">SSML Attributes</a>
									feature of this specification SHOULD support the IPA alphabet [[!IPA]], as expressed
									by the value "<code>ipa</code>".</p>
							</dd>
						</dl>
					</section>

					<section id="sec-xhtml-content-switch">
						<h5>Content Switching (Deprecated)</h5>

						<p>Use of the <code>switch</code> element is <a href="epub-core.html#deprecated">deprecated</a>
							[[EPUB-33]]. Refer to its definition in [[!EPUBContentDocs-301]] for implementation
							information.</p>
					</section>

					<section id="sec-xhtml-epub-trigger">
						<h5>The <code>epub:trigger</code> Element (Deprecated)</h5>

						<p>Use of the <code>trigger</code> element is <a href="epub-core.html#deprecated">deprecated</a>
							[[EPUB-33]]. Refer to its definition in [[!EPUBContentDocs-301]] for implementation
							information.</p>
					</section>

					<section id="sec-xhtml-custom-attributes">
						<h5>Custom Attributes</h5>

						<p><a>Reading Systems</a> MAY introduce functionality not defined in this specification to
							enhance the rendering of <a>EPUB Publications</a>. To facilitate this experimentation,
							vendors MAY define custom attributes for use in <a>XHTML Content Documents</a>.</p>

						<div class="note">
							<p>To facilitate interoperability of custom attributes across Reading Systems, vendors are
								strongly encouraged to document any extensions they implement in
								[[AttributeExtensions]].</p>
						</div>
					</section>
				</section>

				<section id="sec-xhtml-deviations">
					<h4>HTML Deviations and Constraints</h4>

					<section id="sec-xhtml-mathml">
						<h3>MathML</h3>

						<p>A conformant <a>EPUB Reading System</a> has to meet the following criteria for supporting
							MathML embedded in XHTML Content Documents:</p>

						<ul class="conformance-list">
							<li>
								<p id="confreq-mathml-rs-behavior">It MUST be an input-compliant renderer for <a
										href="https://www.w3.org/TR/MathML3/chapter3.html">Presentation MathML</a>, as
									defined in the [[!MATHML3]] specification.</p>
							</li>
							<li>
								<p id="confreq-mathml-rs-anno">It MAY support rendering of <a
										href="https://www.w3.org/TR/MathML3/chapter4.html">Content MathML</a> found in
										<code>annotation-xml</code> elements.</p>
							</li>
							<li>
								<p id="confreq-mathml-rs-render">If it has a <a>Viewport</a>, it MUST support visual
									rendering of Presentation MathML.</p>
							</li>
						</ul>
						<p class="note"> EPUB Reading Systems may choose to use third-party libraries such as MathJax to
							provide MathML rendering. </p>
					</section>

					<section id="sec-xhtml-svg">
						<h5>Embedded SVG</h5>

						<p>Reading Systems MUST process SVG embedded in XHTML Content Documents as defined in <a
								href="#sec-svg"></a>.</p>

						<section id="sec-xhtml-svg-css">
							<h6>Embedded SVG and CSS</h6>

							<p id="confreq-svg-rs-css-embed-ref">For the purposes of styling SVG embedded in XHTML
								Content Documents <em>by reference</em>, Reading Systems MUST NOT apply CSS style rules
								of the containing document to the referenced SVG document.</p>

							<p id="confreq-svg-rs-css-embed-inc">For the purposes of styling SVG embedded in XHTML
								Content Documents <em>by inclusion</em>, Reading Systems MUST apply applicable CSS rules
								of the containing document to the included SVG elements.</p>

							<div class="note">
								<p>SVG included <em>by reference</em> is processed as a separate document, and can
									include its own CSS style rules just like an <a>SVG Content Document</a> would. Note
									that this is consistent with situations where an [[HTML]] <a
										href="https://www.w3.org/TR/html/semantics-embedded-content.html#elementdef-object"
											><code>object</code></a> element references an external [[HTML]]
									element.</p>
							</div>
						</section>
					</section>
					<section id="sec-xhtml-forms">
						<h5>Form Submission</h5>

						<p><a>Reading System</a> support for the submission of [[!HTML]] forms is OPTIONAL. A Reading
							System might, for example, prevent form submissions by limiting access to networking.</p>
					</section>
				</section>
			</section>

			<section id="sec-svg">
				<h3>SVG Content Documents</h3>

				<p>A conformant <a>EPUB Reading System</a> has to meet the following criteria for processing SVG Content
					Documents and <a href="#sec-xhtml-svg">SVG embedded in XHTML Content Documents</a>:</p>

				<ul class="conformance-list">
					<li>
						<p id="confreq-svg-rs-behavior">Unless explicitly defined by this specification as overridden,
							it MUST process SVG Content Documents using semantics defined by the [[!SVG]] specification
							and honor any applicable user agent conformance constraints expressed therein.</p>
					</li>
					<li>
						<p id="confreq-svg-rs-scrpt">It MUST meet the Reading System conformance criteria defined in <a
								href="#sec-scripted-content-rs-reqs"></a>.</p>
					</li>
					<li>
						<p id="confreq-svg-rs-css">If it has a <a>Viewport</a>, it MUST support the visual rendering of
							SVG using CSS as defined in <a href="https://www.w3.org/TR/SVG/styling.html">Styling</a>
							[[!SVG]], and it SHOULD support all properties defined in the <a
								href="https://www.w3.org/TR/SVG/propidx.html">Property Index</a> [[!SVG]]. In the case
							of embedded SVG, it MUST also conform to the constraints defined in <a
								href="#sec-xhtml-svg-css"></a>.</p>
					</li>
					<li>
						<p id="confreq-svg-rs-text">It SHOULD support user selection and searching of text within SVG
							elements.</p>
					</li>
					<li>
						<p id="confreq-svg-rs-reqdExt">It MUST recognize the value
								"<code>http://www.idpf.org/2007/ops</code>" of the <code>requiredExtensions</code>
							attribute as representing the occurrence of XHTML Content Document fragments (e.g., when the
							attribute is included on the <code>foreignObject</code> element or children of the
								<code>switch</code> element).</p>
					</li>
				</ul>
			</section>

			<section id="sec-css">
				<h3>CSS Style Sheets</h3>

				<section id="sec-css-rs-conf">
					<h4>General Conformance</h4>

					<p>A conformant <a>EPUB Reading System</a> has to meet the following criteria for processing CSS
						Style Sheets:</p>

					<ul class="conformance-list">
						<li>
							<p id="confreq-css-rs-support">It MUST support the official definition of CSS as described
								in the [[!CSSSnapshot]].</p>
						</li>
						<li>
							<p id="confreq-css-rs-modules">It SHOULD support all applicable modules in [[!CSSSnapshot]]
								that have reached at least <a href="https://www.w3.org/Consortium/Process/#RecsCR"
									>Candidate Recommendation</a> status [[!W3CProcess]] (and are widely
								implemented).</p>
						</li>
						<li>
							<p id="confreq-css-rs-fonts">It MUST support [[!TrueType]], [[!OpenType]], [[!WOFF]] and
								[[!WOFF2]] font resources referenced from <code>@font-face</code> rules.</p>
						</li>
						<li>
							<p id="confreq-css-rs-prefixed">It MUST support all prefixed properties defined in <a
									href="epub-core.html#sec-css-prefixed">CSS Style Sheets — Prefixed Properties</a>
								[[EPUB-33]].</p>
						</li>
						<li>
							<p id="confreq-css-rs-html-default">In addition to supporting CSS properties as defined
								above, its user agent style sheet SHOULD support the [[!HTML]] <a
									href="https://www.w3.org/TR/html/rendering.html#rendering">suggested default
									rendering</a>.</p>
						</li>
						<li>
							<p id="confreq-css-rs-overrides">It SHOULD respect Author CSS and user styles as defined in
									<a href="#sec-css-rs-overrides"></a>.</p>
						</li>
					</ul>

					<p>Reading System developers are encouraged to implement CSS support at the level of major
						browsers.</p>
				</section>

				<section id="sec-css-rs-overrides">
					<h4>Reading System Overrides</h4>

					<p><a>EPUB Reading Systems</a> SHOULD apply <a>Author</a> style sheets as written to <a>EPUB Content
							Documents</a>. If a Reading System allows, users SHOULD be able to override Author style
						sheets as desired. EPUB Reading Systems SHOULD NOT override Author style sheets unless strictly
						necessary.</p>

					<p>If a Reading System has to override an Author style sheet, it SHOULD do so in a way that
						preserves the Cascade: through a user agent style sheet, the <a
							href="https://www.w3.org/TR/2000/REC-DOM-Level-2-Style-20001113/css.html#CSS-OverrideAndComputed"
								><code>getOverrideStyle</code> method</a> [[!DOM-Level-2-Style]], or [[!HTML]] <a
							href="https://www.w3.org/TR/html/dom.html#the-style-attribute"><code>style</code>
							attributes</a>.</p>

					<p>Developers of Reading Systems are strongly encouraged to publicly document their user agent style
						sheets and how they interact with Author style sheets.</p>
				</section>
			</section>

			<section id="sec-scripted-content">
				<h3>Scripting</h3>

				<section id="sec-scripted-content-rs-reqs">
					<h4>General Conformance</h4>
					<p>A Reading System that supports scripting MUST meet the following criteria:</p>

					<ul class="conformance-list">
						<li>
							<p id="confreq-rs-scripted-reflow-support">It SHOULD support <a
									href="epub-core.html#sec-scripted-content-type-container-constrained"
									>container-constrained scripting</a> [[!EPUB-33]] in reflowable EPUB Content
								Documents.</p>
						</li>
						<li>
							<p id="confreq-rs-scripted-fxl-support">It SHOULD support <a
									href="epub-core.html#sec-scripted-content-type-spine-level">spine-level
									scripting</a> [[!EPUB-33]] in <a href="#sec-fixed-layouts">fixed-layout
									documents</a>.</p>
						</li>
						<li>
							<p id="confreq-rs-scripted-scrolled">It SHOULD support spine-level scripting in reflowable
								EPUB Content Documents that use the <a href="epub-core.html#flow-scrolled-doc"
										>"<code>scrolled-doc</code>"</a> or <a
									href="epub-core.html#flow-scrolled-continuous"
									>"<code>scrolled-continuous</code>"</a> [[!EPUB-33]] presentation modes defined by
									<a href="#flow">the <code>rendition:flow</code> property</a>. Similarly, if it
								supports spine-level scripting in reflowable EPUB Content Documents, it MUST implement
								the "<code>scrolled-doc</code>" presentation mode and SHOULD implement the
									"<code>scrolled-continuous</code>" presentation mode.</p>
						</li>
						<li>
							<p id="confreq-rs-scripted-optional-support">It MAY support scripting in other contexts, but
								this specification does not address such scripting. As a result, the use of scripting in
								these contexts might not be consistent across Reading Systems.</p>
						</li>
						<li>
							<p id="confreq-rs-scripted-ua">It MAY render <a>Scripted Content Documents</a> as an
								interactive, scripted user agent according to [[!HTML]].</p>
						</li>
						<li>
							<p id="confreq-rs-scripted-container">It MUST NOT allow a container-constrained script to
								modify the DOM of the parent Content Document or other contents in the EPUB Publication,
								and MUST NOT allow it to manipulate the size of its containing rectangle. (Note: Even if
								a script is not container-constrained, the Reading System MAY impose restrictions on
								modifications (see also the <a href="#feature-dom-manipulation">dom-manipulation
									feature</a>).)</p>
						</li>
						<li>
							<p id="confreq-rs-scripted-limit">It MAY place additional limitations on the capabilities
								provided to scripts during execution (e.g., limiting networking).</p>
						</li>
						<li>
							<p id="confreq-rs-scripted-readingsystem-object">It MUST implement the JavaScript
									<code>navigator</code> extension object <code>epubReadingSystem</code> defined in <a
									href="#app-epubReadingSystem"></a>. It also MUST support the
									<code>dom-manipulation</code> and <code>layout-change</code> features defined in <a
									href="#app-ers-hasFeature-features"></a> in container-constrained scripting
								contexts.</p>
						</li>
					</ul>
					<p>A Reading System that does not support scripting MUST meet the following criteria:</p>
					<ul class="conformance-list">
						<li>
							<p id="confreq-rs-scripted-flbk">It MUST process fallbacks for scripted content as defined
								in <a href="epub-core.html#confreq-cd-scripted-flbk">Fallbacks for Scripted Content
									Documents</a> [[!EPUB-33]].</p>
						</li>
					</ul>

					<div class="note">
						<p>Reading Systems might render Scripted Content Documents in a manner that disables other EPUB
							capabilities and/or provides a different rendering and user experience (e.g., by disabling
							pagination).</p>
						<p>Authors choosing to restrict the usage of scripting to the <a
								href="epub-core.html#sec-scripted-content-type-container-constrained"
								>container-constrained model</a> [[!EPUB-33]] will ensure a more consistent user
							experience between scripted and non-scripted content (e.g., consistent pagination
							behavior).</p>
						<p>Authors are advised to use declarative techniques whenever practical to increase the
							interoperability, longevity and accessibility of their EPUB Publications, and avoid the
							inclusion of scripting whenever practical.</p>
					</div>
				</section>

				<section id="sec-scripted-content-security" class="informative">
					<h4>Security Considerations</h4>

					<p>All EPUB <a>Authors</a> and <a>EPUB Reading System</a> developers have to be aware of the
						security issues that arise when scripted content is executed by a Reading System. As the
						underlying scripting model employed by Reading Systems and browsers is the same, the same kinds
						of issues encountered in Web contexts have to be taken into consideration.</p>

					<p>Each Reading System has to establish if the scripts in a particular document are to be trusted or
						not. It is advised that all scripts be treated as untrusted (and potentially malicious), and
						that all vectors of attack be examined and protected against. In particular, the following need
						to be considered:</p>

					<ul>
						<li>
							<p>an attack against the runtime environment (e.g., stealing files from a user's hard
								drive);</p>
						</li>
						<li>
							<p>an attack against the Reading System itself (e.g., stealing a list of a user's books or
								causing unexpected behavior);</p>
						</li>
						<li>
							<p>an attack of one Content Document against another (e.g., stealing data that originated in
								a different document);</p>
						</li>
						<li>
							<p>an attack of an unencrypted script against an encrypted portion of a document (e.g., an
								injected malicious script extracting protected content);</p>
						</li>
						<li>
							<p>an attack against the local network (e.g., stealing data from a server behind a
								firewall).</p>
						</li>
					</ul>

					<p>The following recommendations are provided as a guide to handling untrusted scripts:</p>

					<ul>
						<li>
							<p>Reading Systems need to behave as if a unique domain were allocated to each Content
								Document, as browser-based security relies heavily on document URLs and domains.
								Adopting this approach will isolate documents from each other and from other Internet
								domains, thereby limiting access to external URLs, cookies, DOM storage, etc.</p>
							<p>Reading Systems that enable scripting and network access also need to consider including
								methods to notify the user that network activity is occurring and/or that allow them to
								disable it.</p>
							<div class="note">
								<p>In practice, Reading Systems might share domains across documents, but they still
									need to maintain isolation between documents.</p>
								<p>If parts of a document are encrypted and parts are not, or if different encryption
									keys are used for different parts of the document, a unique per-document domain
									might not provide sufficient protection.</p>
							</div>
						</li>
						<li>
							<p>If a Reading System allows persistent data to be stored, that data needs to be treated as
								sensitive. Scripts might save persistent data through cookies and DOM storage, but
								Reading Systems might block such attempts. Reading Systems that do allow data to be
								stored have to ensure that it is not made available to other unrelated documents (e.g.,
								ones that could have been spoofed). In particular, checking for a matching document
								identifier (or similar metadata) is not a valid method to control access to persistent
								data.</p>
							<p>Reading Systems that allow local storage also need to provide methods for users to
								inspect, disable, or delete that data. The data needs to be destroyed if the
								corresponding EPUB Publication is deleted.</p>
						</li>
					</ul>

					<p>Note that compliance with these recommendations does not guarantee protection from the possible
						attacks listed above; developers have to examine each potential vulnerability within the context
						of their Reading System.</p>
				</section>

				<section id="sec-scripted-content-events" class="informative">
					<h4>Event Model Considerations</h4>

					<p>Reading Systems need to follow the DOM Event model as per [[HTML]] and pass UI events to the
						scripting environment before performing any default action associated with these events. Reading
						System implementers need to ensure that scripts cannot disable critical functionality (such as
						navigation) to constrain the extent to which a <a href="#sec-scripted-content-security"
							>potentially malicious</a> script could impact their Reading Systems. As a result, although
						the scripting environment needs to be able to cancel the default action of any event, some
						events either might not be passed through or might not be cancelable.</p>

					<p><a>Authors</a> need to take into account the wide variety of possible Reading System
						implementations when adding scripting functionality to their EPUB Publications (e.g., not all
						devices have physical keyboards, and in many cases a soft keyboard is activated only for text
						input elements). Consequently, relying on keyboard events alone is not advised; alternative ways
						to trigger a desired action always need to be provided.</p>
				</section>
			</section>

			<section id="sec-fixed-layouts">
				<h3>Fixed Layouts</h3>

				<section id="sec-fxl-rs-conf">
					<h4>General Conformance</h4>

					<p>A conformant <a>EPUB Reading System</a> has to meet the following criteria for processing
							<a>Fixed-Layout Documents</a>:</p>

					<ul class="conformance-list">
						<li>
							<p id="confreq-fxl-rs-viewport">It SHOULD allocate the full <a>Content Display Area</a> for
								the document, as defined in <a href="#sec-fxl-viewport"></a>.</p>
						</li>
						<li>
							<p id="confreq-fxl-rs-html">It MUST use the dimensions expressed in the
									<code>viewport</code>
								<code>meta</code> tag to render <a>XHTML Content Documents</a>, as defined in <a
									href="#sec-fxl-html-dimensions"></a>.</p>
						</li>
						<li>
							<p id="confreq-fxl-rs-svg">It MUST use the dimensions as defined in <a
									href="epub-core.html#sec-fxl-icb-svg">Expressing the ICB in SVG</a> [[!EPUB-33]] to
								render <a>SVG Content Documents</a>.</p>
						</li>
					</ul>

					<div class="note">
						<p>This specification does not define how the <a
								href="https://www.w3.org/TR/CSS2/visudet.html#containing-block-details">initial
								containing block</a> [[CSS2]] is placed within the Reading System <a>Content Display
								Area</a>.</p>
					</div>
				</section>

				<section id="sec-fxl-html-dimensions">
					<h4>HTML Initial Containing Block Dimensions</h4>

					<p>In this version of this specification, only the width and height expressions as defined in <a
							href="../core/index.html#sec-fxl-icb-html">Expressing in HTML</a> [[!EPUB-33]] MUST be
						recognized by <a>Reading Systems</a>.</p>

					<p>Reading Systems MUST clip XHTML content to the initial containing block (ICB) dimensions declared
						in the <code>viewport</code>
						<code>meta</code> tag — content positioned outside of the initial containing block will not be
						visible. When the ICB aspect ratio does not match the aspect ratio of the Reading System
							<a>Content Display Area</a>, Reading Systems MAY position the ICB inside the area to
						accommodate the user interface; in other words, added letter-boxing space MAY appear on either
						side (or both) of the content.</p>
				</section>

				<section id="sec-fxl-viewport">
					<h4>Viewport Rendering</h4>

					<p>When rendering <a>Fixed-Layout Documents</a>, the default intent is that the <a>Content Display
							Area</a> SHOULD occupy as much of the available <a>Viewport</a> area as possible. <a>Reading
							Systems</a> SHOULD NOT inject additional content such as border, margins, headers or footers
						into the Viewport.</p>

					<div class="note">
						<p>The exposure of Reading System control widgets to the user is implementation-specific and not
							included in the above behavioral expectations.</p>
					</div>
				</section>
			</section>

			<section id="sec-pls-conf-rs">
				<h3>Pronunciation Lexicons</h3>

				<p>Reading Systems with Text-to-Speech (TTS) capabilities SHOULD support <abbr
						title="Pronunciation Lexicon Specification">PLS</abbr> documents.</p>

				<p>A conformant <a>EPUB Reading System</a> has to meet the following criteria for processing PLS
					documents:</p>

				<ul class="conformance-list">
					<li>
						<p id="confreq-pls-rs-sptts">Reading Systems with <a>Text-to-Speech</a> (TTS) capabilities
							SHOULD support [[!PRONUNCIATION-LEXICON]].</p>
						<p id="confreq-pls-rs-proc">It MUST process PLS documents as defined in
							[[!PRONUNCIATION-LEXICON]].</p>
						<p id="confreq-pls-rs-scope">It MUST apply the supplied pronunciation instructions to all text
							nodes in the current XHTML Content Document whose <a
								href="https://www.w3.org/TR/html/dom.html#the-lang-and-xmllang-attributes">language</a>
							[[!HTML]] matches <a
								href="https://www.w3.org/TR/2008/REC-pronunciation-lexicon-20081014/#S4.1">the language
								for which the pronunciation lexicon is relevant</a> [[!PRONUNCIATION-LEXICON]]. The
							algorithm for matching language tags is defined in [[!BCP47]].</p>
						<p id="confreq-pls-rs-multi">When a pronunciation rule is specified more than once for a given
							string target in a given language, it MUST give precedence to the last occurrence of the
							rule in such a way that any previously-defined pronunciation rule gets overridden.</p>
						<p id="confreq-pls-rs-casc">If it also supports <a href="#sec-xhtml-ssml-attrib">SSML
								Attributes</a>, it MUST let any pronunciation instructions provided via the <a
								href="#sec-cd-ssml-ph-attrib"><code>ssml:ph</code></a> attribute take precedence in
							cases where a <code>grapheme</code> element [[!PRONUNCIATION-LEXICON]] matches a text node
							of an element that carries the <code>ssml:ph</code> attribute [[!SSML]].</p>
					</li>
				</ul>
			</section>
		</section>
		<section id="ocf">
			<h2>Open Container Format Processing</h2>

			<section id="ocf-conformance-rs">
				<h3>Basic Conformance</h3>

				<p>An <a>EPUB Reading System</a> has to meet the following criteria:</p>

				<ul class="conformance-list">
					<li>
						<p id="confreq-ocf-rs-zip">It MUST process the OCF ZIP Container in conformance with all Reading
							System conformance constraints expressed in <a href="#sec-container-zip"></a>.</p>
					</li>
					<li>
						<p id="confreq-ocf-fobfus">If it has a <a>Viewport</a>, it MUST support deobfuscation of
							resources as defined in <a href="epub-core.html#sec-resource-obfuscation"><em>Resource
									Obfuscation</em></a> [[!EPUB-33]].</p>
					</li>
				</ul>

			</section>

			<section id="sec-container-abstract">
				<h3>OCF Abstract Container</h3>

				<section id="sec-container-iri">
					<h4>Relative IRIs for Referencing Other Components</h4>

					<p>For relative IRI references, Reading Systems MUST determine the Base IRI [[!RFC3986]] according
						to the relevant language specifications for the given file formats. For example, CSS defines how
						relative IRI references work in the context of CSS style sheets and property declarations
						[[!CSSSnapshot]].</p>

					<div class="note">
						<p>Some language specifications reference Requests For Comments [[RFC]] that preceded
							[[RFC3987]], in which case the earlier RFC applies for content in that particular
							language.</p>
					</div>

					<p>Unlike most language specifications, Reading Systems MUST use the <a>Root Directory</a> of the
						OCF Abstract Container as the default Base IRI as the Base IRI for all files within the
							<code>META-INF</code> directory.</p>
				</section>

				<section id="sec-container-filenames">
					<h4>File Names</h4>

					<p>This specification does not specify how an <a>OCF Processor</a> that is unable to represent OCF
						File and Path Names would compensate for this incompatibility.</p>
				</section>

				<section id="sec-container-metainf">
					<h4><code>META-INF</code> Directory</h4>

					<dl class="conformance-list">
						<dt id="sec-container-metainf-container.xml">Container File (<code>container.xml</code>)</dt>
						<dd>
							<p id="container-default-rendition">An OCF Processor MUST consider the first
									<code>rootfile</code> element within the <code>rootfiles</code> element to represent
								the <a>Default Rendition</a> for the contained EPUB Publication. <a>Reading Systems</a>
								are REQUIRED to present the Default Rendition, but MAY present other Renditions in the
								container.</p>

							<p><a>OCF Processors</a> MUST ignore foreign elements and attributes within a
									<code>container.xml</code> file.</p>
						</dd>

						<dt id="sec-container-metainf-inc">Other Files</dt>
						<dd>
							<p><a>OCF Processors</a> MUST NOT fail when encountering files in the <code class="filename"
									>META-INF</code> directory not listed in <a
									href="epub-core.html#sec-container-metainf-files">Reserved Files</a>
								[[!EPUB-33]].</p>
						</dd>
					</dl>
				</section>
			</section>

			<section id="sec-container-zip">
				<h3>OCF ZIP Container</h3>

				<ul class="conformance-list">
					<li>
						<p id="confreq-zip-mult"><a>OCF Processors</a> MUST treat any OCF files that specify that the
							ZIP file is split across multiple storage media as being in error.</p>
					</li>
					<li>
						<p id="confreq-zip-comp">OCF Processors MUST treat any OCF Containers that use compression
							techniques other than Deflate as being in error.</p>
					</li>
					<li>
						<p id="confreq-zip-64">OCF Processors MUST support the ZIP64 extensions defined as "Version
							1".</p>
					</li>
					<li>
						<p id="confreq-zip-enc">OCF Processors MUST treat OCF ZIP Containers that use ZIP encryption
							features as being in error.</p>
					</li>
					<li>
						<p id="confreq-zip-preserve">It is not a requirement that OCF Processors preserve information
							from an OCF ZIP Container through load and save operations that are not defined within the
							OCF Abstract Container; in particular, an OCF Processor does not have to preserve CRC
							values, comment fields or fields that hold file system information corresponding to a
							particular operating system (e.g., <em class="firstterm">External file attributes</em> and
								<em class="firstterm">Extra field</em>).</p>
					</li>
				</ul>

				<p>The following constraints apply to particular fields in the OCF ZIP Container archive:</p>

				<ul class="conformance-list">
					<li>
						<p id="confreq-zip-fld-version">OCF Processors MUST treat <code>version needed to extract</code>
							field values other than <code>10</code>, <code>20</code> or <code>45</code> in the local
							file header table as being in error.</p>
					</li>
					<li>
						<p id="confreq-zip-fld-comp">OCF Processors MUST treat <code>compression</code> method field
							values other than <code>0</code> or <code>8</code> in the local file header table as being
							in error.</p>
					</li>
					<li>
						<p id="confreq-zip-fld-er">OCF Processors MUST treat OCF ZIP Containers with an <code>Archive
								decryption header</code> or an <code>Archive extra data record</code> as being in
							error.</p>
					</li>
				</ul>
			</section>
		</section>
		<section id="mediaoverlays">
			<h2>Media Overlays Processing</h2>

			<section id="sec-overlays-rs-conf">
				<h2>General Conformance</h2>

				<p><a>EPUB Reading System</a> support for Media Overlays is OPTIONAL. A Reading System that supports
					Media Overlays MUST meet the following criteria:</p>

				<ul class="conformance-list">
					<li>
						<p id="confreq-rs-mo-package-def">It MUST process the Media Overlay Document in conformance with
							all Reading System conformance constraints expressed in <a
								href="epub-core.html#sec-overlays-def">Media Overlay Document Definition</a>
							[[!EPUB-33]].</p>
						<p id="confreq-rs-xhtml-svg">It MUST support <a>XHTML Content Documents</a>, and it MAY support
								<a>SVG Content Documents</a>.</p>
						<p id="confreq-rs-render">It MUST render Media Overlay elements as described in <a
								href="#sec-behaviors-playback"></a>.</p>
						<p id="confreq-rs-navigation">It MUST allow user navigation while a Media Overlay is being
							played, as discussed in <a href="#sec-rsconf-navigation"></a>.</p>
						<p id="confreq-rs-embed">It MUST adhere to rules regarding referenced audio and video embedded
							in the <a>EPUB Content Document</a>, as stated in <a href="#sec-embedded-media"></a>.</p>
						<p id="confreq-rs-tts"><a>Text-to-Speech</a>-capable Reading Systems SHOULD conform to <a
								href="#confreq-rs-epub3-tts">Reading System Text-to-Speech Conformance Requirements</a>
							[[!EPUB-33]].</p>
						<p id="confreq-rs-skip-escape">It SHOULD offer the skippability and escapability features
							described in <a href="#sec-behaviors-skip-escape"></a>.</p>
					</li>
				</ul>

				<p>A Reading System that does not support Media Overlays MUST meet the following criteria:</p>

				<ul class="conformance-list">
					<li>
						<p id="confreq-rs-mo-ignore">It MUST ignore both the <code>media-overlay</code> attribute on
								<a>Manifest</a>
							<a href="epub-core.html#elemdef-package-item"><code>item</code> elements</a> and the
							manifest <code>item</code> elements where the <code>media-type</code> attribute value equals
								<code>application/smil+xml</code>.</p>
					</li>
				</ul>
			</section>

			<section id="sec-overlay-behaviors">
				<h3>Playback Behaviors</h3>

				<section id="sec-behaviors-loading">
					<h4>Loading the Media Overlay</h4>

					<p>When an <a>EPUB Reading System</a> loads a <a>Package Document</a>, it MUST refer to the
							<a>Manifest</a>
						<a href="epub-core.html#elemdef-package-item"><code>item</code> elements'</a> [[!EPUB-33]]
							<code>media-overlay</code> attributes to discover the corresponding Media Overlays for
							<a>EPUB Content Documents</a>. Playback MUST start at the Media Overlay element which
						corresponds to the desired EPUB Content Document starting point. Note that the start of an EPUB
						Content Document MAY correspond to an element at the start or in the middle of a Media Overlay.
						When the Media Overlay Document has finished playing, the Reading System SHOULD load the next
						EPUB Content Document (as specified in the Package Document <a>spine</a>) and also load its
						corresponding Media Overlay Document, provided that one is given.</p>
				</section>

				<section id="sec-behaviors-playback">
					<h4>Basic Playback</h4>

					<section id="sec-rsconf-timing-synch">
						<h3>Timing and Synchronization</h3>

						<p>Reading Systems MUST render immediate children of the <a
								href="epub-core.html#elemdef-smil-body"><code>body</code> element</a> [[!EPUB-33]] in a
							sequence. A <a href="epub-core.html#elemdef-smil-seq"><code>seq</code> element's</a>
							[[!EPUB-33]] children MUST be rendered in sequence, and playback completes when the last
							child has finished playing. A <a href="epub-core.html#elemdef-smil-par"><code>par</code>
								element's</a> [[!EPUB-33]] children MUST be rendered in parallel (with each starting at
							the same time), and playback completes when all the children have finished playing. When the
								<code>body</code> element's last child has finished playing, playback of the Media
							Overlay Document is done.</p>

					</section>

					<section id="sec-rsconf-rendering-audio">
						<h5>Rendering Audio</h5>

						<p>When presented with a Media Overlay <a href="epub-core.html#elemdef-smil-audio"
									><code>audio</code> element</a> [[!EPUB-33]], Reading Systems MUST play the audio
							resource referenced by the <code>src</code> attribute, starting at the clip offset time
							given by the <a href="epub-core.html#attrdef-smil-clipBegin"><code>clipBegin</code>
								attribute</a> [[!EPUB-33]] and ending at the clip offset time given by the <a
								href="epub-core.html#attrdef-smil-clipEnd"><code>clipEnd</code> attribute</a>
							[[!EPUB-33]]. The following rules MUST be observed:</p>

						<ul>
							<li>
								<p>If <code>clipBegin</code> is not specified, its value is assumed to be
										"<code>0</code>".</p>
							</li>
							<li>
								<p>If <code>clipEnd</code> is not specified, its value is assumed to be the full
									duration of the physical media.</p>
							</li>
							<li>
								<p>If <code>clipEnd</code> exceeds the full duration of the physical media, then its
									value is assumed to be the full duration of the physical media.</p>
							</li>
						</ul>

						<p>User-controllable audio playback options SHOULD include timescale modification, in which the
							playback rate is altered without distorting the pitch. The suggested range is half-speed to
							double-speed.</p>

					</section>

					<section id="sec-rsconf-rendering-text">
						<h5>Rendering EPUB Content Document Elements</h5>

						<p>When presented with a Media Overlay <a href="epub-core.html#elemdef-smil-text"
									><code>text</code> element</a> [[!EPUB-33]], Reading Systems SHOULD ensure the EPUB
							Content Document element referenced by the <code>src</code> attribute is visible in the
								<a>Viewport</a>. During Media Overlays playback, Reading Systems with a Viewport SHOULD
							add the class names given by the metadata properties <a href="epub-core.html#active-class"
									><code>active-class</code></a> and <a href="epub-core.html#playback-active-class"
									><code>playback-active-class</code></a> [[!EPUB-33]] to the appropriate elements in
							the EPUB Content Document. Conversely, the class names SHOULD be removed when the playback
							state changes, as described in <a href="epub-core.html#sec-docs-assoc-style">Associating
								Style Information</a> [[!EPUB-33]].</p>

						<p>The <code>active-class</code> and <code>playback-active-class</code> metadata properties are
							OPTIONAL, and if omitted, Reading System behavior is implementation-specific.</p>

					</section>

				</section>

				<section id="sec-behaviors-interaction">
					<h4>Interacting with the EPUB Content Document</h4>

					<section id="sec-rsconf-navigation">
						<h5>Navigation</h5>

						<p>Because the Media Overlay is closely linked to the <a>EPUB Content Document</a>, it is very
							easy for Reading Systems to locate a position in the EPUB Content Document based on the
							current position in the Media Overlay playback. If the user pauses synchronized playback and
							navigates to a different part of the <a>EPUB Publication</a>, synchronized playback MUST
							resume at that point. For example, if a specific page number in the EPUB Content Document is
							the desired location, then this same point is located in the Media Overlay and playback
							started there.</p>

						<p>This same approach allows for synchronizing the Media Overlay playback with user selection of
							a navigation point in the <a>EPUB Navigation Document</a>. The Reading System loads the
							Media Overlay for that file and finds the correct point for starting playback based on the
							ID [[!XML]] of the navigation point target.</p>

						<div class="note">
							<p>A Media Overlay Document can be associated directly with a Navigation Document in order
								to provide synchronized playback of its contents, regardless of whether the <a>XHTML
									Content Document</a> in which it resides is included in the <a>spine</a>. See <a
									href="epub-core.html#sec-nav-doc"><em>EPUB Navigation Document</em></a> [[!EPUB-33]]
								for more information.</p>
						</div>

						<div class="note" id="note-table-reading-mode">
							<p>Media Overlay Document elements can be associated with EPUB Content Document structures
								such as tables. Reading Systems need to ensure that Media Overlay playback remains
								synchronized with user navigation of table rows and cells. The Reading System might also
								play the corresponding table header preceding the contents of the cell.</p>
						</div>

					</section>

					<section id="sec-embedded-media">
						<h5>Embedded Audio and Video</h5>

						<p> An <a>EPUB Content Document</a> with which a Media Overlay is associated MAY itself contain
							embedded video and audio media, which MAY be pointed to by Media Overlay elements. Unlike
							text and images, video and audio media has an intrinsic duration. Consequently, when a
							Reading System renders the synchronization described by a Media Overlay, the default
							playback behavior of audio and video media embedded within the associated EPUB Content
							Document MUST be overridden.</p>

						<p>Note that the rules below apply only to <em>referenced</em> [[!HTML]] <a
								href="https://www.w3.org/TR/html/semantics-embedded-content.html#the-video-element"
									><code>video</code></a> or <a
								href="https://www.w3.org/TR/html/semantics-embedded-content.html#the-audio-element"
									><code>audio</code></a> elements within the associated EPUB Content Document. That
							is to say, the rules apply to only those elements pointed to by <a
								href="epub-core.html#elemdef-smil-text"><code>text</code> elements</a> [[!EPUB-33]]
							within the Media Overlay (i.e., via the <code>src</code> attribute). Embedded media that is
							not referenced by Media Overlay elements is not subject to these rules.</p>

						<ul>
							<li>
								<p>All referenced audio and video media embedded within an EPUB Content Document MUST
									have their public playback interface deactivated (typically: play/pause control,
									time slider, volume level, etc.). This behavior is necessary to avoid interference
									between the scheduled playback sequence defined by the Media Overlay, and the
									arbitrary playback behavior due to user interaction or script execution. As a
									result, when the Reading System is in playback mode, it SHOULD:</p>
								<ul>
									<li>
										<p>Hide the individual video/audio UI controls from the page, which overrides
											the default behavior defined by the [[!HTML]] <a
												href="https://www.w3.org/TR/html/semantics-embedded-content.html#element-attrdef-mediaelements-controls"
													><code>controls</code></a> attribute.</p>
									</li>
									<li>
										<p>Prevent scripts embedded within the EPUB Content Document from invoking the
											JavaScript audio/video playback API (i.e., authored as part of the default
											behavior). It is RECOMMENDED that content producers avoid publishing
											embedded scripts dedicated to controlling the playback of embedded
											audio/video media. The published Media Overlay can then retain full control
											of the synchronized presentation without any risk of interference from
											script-enabled custom behaviors.</p>
									</li>
								</ul>
							</li>
							<li>
								<p>All referenced audio and video media embedded within an EPUB Content Document MUST be
									initialized to their "stopped" state, and be ready to be played from the
									zero-position within their content stream (possibly displaying the image specified
									using the [[!HTML]] <a
										href="https://www.w3.org/TR/html/semantics-embedded-content.html#the-video-element"
											><code>poster</code></a> attribute). This requirement overrides the default
									behavior defined by the [[!HTML]] <a
										href="https://www.w3.org/TR/html/semantics-embedded-content.html#the-video-element"
											><code>autoplay</code></a> attribute.</p>
							</li>
							<li>
								<p>When an EPUB Content Document element becomes active, the CSS Style Sheet visual
									highlighting rules apply regardless of the content type referred to by that
									element's <code>src</code> attribute (e.g., the CSS class name defined by the <a
										href="epub-core.html#active-class"><code>active-class</code> metadata
										property</a> [[!EPUB-33]] SHOULD be applied to visible video and audio player
									controls within the host EPUB Content Document).</p>
							</li>
							<li>
								<p>In addition to the default behavior of Media Overlay activation for textual fragments
									and images, audio and video playback MUST be started and stopped according to the
									duration implied by the authored Media Overlay synchronization (as per the standard
									[[!SMIL3]] timing model). There are two possible scenarios:</p>
								<ul>
									<li>
										<p>When a Media Overlay <code>text</code> element has no <a
												href="epub-core.html#elemdef-smil-audio"><code>audio</code></a>
											[[!EPUB-33]] sibling within its <a href="epub-core.html#elemdef-smil-par"
													><code>par</code></a> [[!EPUB-33]] parent container, the referenced
											EPUB Content Document audio or video media MUST play until it ends, at which
											point the <code>text</code> element's lifespan terminates. In this case, the
											implicit duration of the <code>text</code> element (and by inference, of the
											parent <code>par</code> container) is that of the referenced audio or video
											clip.</p>
									</li>
									<li>
										<p>When a Media Overlay <code>text</code> element has an <code>audio</code>
											sibling within its <code>par</code> parent container, the playback duration
											of the referenced EPUB Content Document audio or video media MUST be
											constrained by the duration of the <code>audio</code> sibling. In this case,
											the actual duration of the parent <code>par</code> container is that of the
											child audio clip, regardless of the duration of the video or audio media
											pointed to by the <code>text</code> element. This behavior can result in
											embedded video or audio media ending playback prematurely (before reaching
											its full duration), or ending before the playback of the parallel Media
											Overlay <code>audio</code> is finished (in which case the last-played video
											frame SHOULD remain visible until the parent <code>par</code> container
											finally ends). This behavior is equivalent of the Media Overlay
												<code>audio</code> element implicitly carrying the behavior of the
											[[!SMIL3]] <a
												href="https://www.w3.org/TR/SMIL/smil-timing.html#adef-endsync"
													><code>endsync</code></a> attribute.</p>
										<p>Furthermore, Reading Systems SHOULD expose user controls for the volume
											levels of each independent audio track (i.e., from the <code>audio</code>
											element of the Media Overlay, and from the embedded audio or video media
											within the EPUB Content Document), so that audio output can be adjusted to
											match listeners' requirements. Note that having overlapping audio tracks is
											typically an authoring-time concern: content producers usually add a layer
											of audio information over a video track for description purposes. It is
											RECOMMENDED that overlapping audio situations are carefully examined and
											dealt with at production stage, as Reading Systems are NOT REQUIRED to
											handle simultaneous volume levels in any particular way.</p>
									</li>
								</ul>
							</li>
							<li>
								<p>When a <code>text</code> element becomes inactive in the Media Overlay, and when it
									points to embedded video or audio media, that referenced media MUST be reset to its
									initial "stopped" state, ready to be played from the zero-position within their
									content stream (possibly displaying the poster image specified using the [[!HTML]]
									markup).</p>
							</li>
						</ul>

					</section>

					<section id="sec-text-to-speech">
						<h5>Text-to-Speech</h5>

						<p>When a Media Overlay <a href="epub-core.html#elemdef-smil-text"><code>text</code> element</a>
							[[!EPUB-33]] with no <a href="epub-core.html#elemdef-smil-audio"><code>audio</code></a>
							[[!EPUB-33]] sibling element references text within the target <a>EPUB Content Document</a>,
							Reading Systems capable of <a>Text-to-Speech</a> (TTS) SHOULD render the referenced text
							using TTS.</p>

						<p>As per Reading System conformance requirements, the speech-related information provided in
							the target EPUB Content Document SHOULD be used to play the audio stream as part of the
							Media Overlay rendering. See <a href="#confreq-rs-epub3-tts">Reading System Text-to-Speech
								Conformance Requirements</a>.</p>

						<p>The Media Overlay <code>text</code> element's lifespan corresponds to the rendering time of
							the associated speech synthesis. The implicit duration of the <code>text</code> element (and
							by inference, of the parent <code>par</code> element) is therefore determined by the
							execution of the Text-to-Speech engine, and cannot be known at authoring time (factors like
							speech rate, pauses and other prosody parameters influence the audio output).</p>

					</section>
				</section>

				<section id="sec-behaviors-skip-escape">
					<h4>Skippability and Escapability</h4>

					<section id="sec-skippability">
						<h5>Skippability</h5>

						<p>Reading Systems SHOULD use the semantic information provided by Media Overlay elements' <a
								href="epub-core.html#sec-docs-semantic-inflection"><code>epub:type</code> attribute</a>
							[[!EPUB-33]] to determine when to offer users the option of skippable features.</p>
					</section>

					<section id="sec-escabaility">
						<h5>Escapability</h5>

						<p>Reading Systems SHOULD allow escaping of nested structures. Reading Systems MUST determine
							the start of nested structures by the value of the <a
								href="epub-core.html#sec-docs-semantic-inflection"><code>epub:type</code> attribute</a>
							[[!EPUB-33]] and SHOULD offer users the option to skip playback of that structure and resume
							with whatever content comes after it.</p>
					</section>
				</section>
			</section>
		</section>
		<section class="appendix" id="app-epubReadingSystem">
			<h2>JavaScript <dfn>epubReadingSystem</dfn> Object</h2>

			<section id="app-ers-idl">
				<h3>Interface Definition</h3>

				<p>This specification extends the [[!HTML]] <dfn>Navigator</dfn> object as follows.</p>

				<pre class="idl">[Exposed=(Window)]
interface EpubReadingSystem {
    [LegacyUnforgeable] readonly attribute DOMString name;
    [LegacyUnforgeable] readonly attribute DOMString version;
    boolean hasFeature(DOMString feature, optional DOMString version);
};

partial interface Navigator {
    [LegacyUnforgeable, SameObject] readonly attribute EpubReadingSystem epubReadingSystem;
};</pre>
				<p>[[!WEBIDL]] notation.</p>

				<div class="note">
					<p>This specification does not define an <code>epubReadingSystem</code> property extension for the
							<a href="https://www.w3.org/TR/2015/WD-workers-20150924/#the-workernavigator-object"
								><code>WorkerNavigator</code> object</a> [[WebWorkers]]. Reading Systems therefore do
						not have to expose the <code>epubReadingSystem</code> object in the scripting context of
						Workers, and Authors cannot rely on its presence.</p>
				</div>
			</section>

			<section id="app-ers-desc">
				<h3>Description</h3>

				<p>The <code><dfn>Navigator.epubReadingSystem</dfn></code> object provides an interface through which a
						<a>Scripted Content Document</a> can query information about a user's <a>Reading System</a>.</p>

				<p>The object exposes <a href="#app-ers-properties">properties</a> of the Reading System (its name and
					version), and provides the <a href="#app-ers-hasFeature"><code>hasFeature</code> method</a> which
					can be invoked to determine the features it supports.</p>

				<aside class="example">
					<p>Example JavaScript function that displays the name of the current Reading System.</p>

					<pre>alert("Reading System name: " + navigator.epubReadingSystem.name);</pre>
				</aside>

				<p>Reading Systems MUST expose the <code>epubReadingSystem</code> object on the <code>navigator</code>
					object of all loaded Scripted Content Documents, including any nested <a
						href="epub-core.html#sec-scripted-content-type-container-constrained">container-constrained
						scripting contexts</a> [[!EPUB-33]]. Reading Systems MUST ensure that the
						<code>epubReadingSystem</code> object is available no later than when the <a
						href="https://www.w3.org/TR/html/syntax.html#the-end"><code>DOMContentLoaded</code> event is
						triggered</a> [[!HTML]].</p>

				<div class="note">
					<p>Reading systems implementations might create cloned instances of the
							<code>epubReadingSystem</code> object in Scripted Content Documents for technical
						feasibility reasons. In such cases, the Reading System has to ensure that the object’s state —
						as reflected by the values of its properties and methods — is consistently maintained across all
						copied instances.</p>
				</div>
			</section>

			<section id="app-ers-properties">
				<h3>Properties</h3>

				<p>The following properties MUST be made available for retrieving information about the Reading
					System.</p>

				<table data-dfn-for="epubReadingSystem">
					<thead>
						<tr>
							<th>Name</th>
							<th>Description</th>
						</tr>
					</thead>
					<tbody>
						<tr>
							<td id="propdef-name">
								<code>
									<dfn>name</dfn>
								</code>
							</td>
							<td>Returns a <code>String</code> value representing the name of the Reading System (e.g.,
									"<code>iBooks</code>", "<code>Kindle</code>").</td>
						</tr>
						<tr>
							<td id="propdef-version">
								<code>
									<dfn>version</dfn>
								</code>
							</td>
							<td>Returns a <code>String</code> value representing the version of the Reading System
								(e.g., "<code>1.0</code>", "<code>2.1.1</code>").</td>
						</tr>
						<tr>
							<td id="propdef-layoutStyle">
								<code>
									<dfn>layoutStyle</dfn>
								</code>
							</td>
							<td>Use of the <code>layoutStyle</code> property is <a href="epub-core.html#deprecated"
									>deprecated</a> [[EPUB-33]]. Refer to its definition in [[!EPUBContentDocs-301]] for
								usage information.</td>
						</tr>
					</tbody>
				</table>
			</section>

			<section id="app-ers-methods">
				<h3>Methods</h3>

				<section id="app-ers-hasFeature">
					<h4>hasFeature</h4>

					<section id="app-ers-hasFeature-desc">
						<h5>Description</h5>

						<p data-dfn-for="epubReadingSystem">The <code><dfn>hasFeature</dfn></code> method returns a
							boolean value indicating whether any version of the specified feature is supported, or
								<code>undefined</code> if the specified feature is not recognized.</p>

						<p>The OPTIONAL <code>version</code> parameter is included for querying custom features that
							could change in incompatible ways over time. The return value indicates support only for the
							specified version of the feature.</p>

						<p><a>Authors</a> SHOULD NOT include the <code>version</code> parameter when querying <a
								href="#app-ers-hasFeature-features">features defined in this specification</a> — these
							features are considered versionless. If a Reading System supports a feature defined in this
							specification, it MUST ignore any supplied <code>version</code> parameter and return a
								<code>true</code> value.</p>

						<aside class="example">
							<p>Example JavaScript function that displays whether the current Reading System supports
								scripted manipulation of the DOM.</p>

							<pre>var feature = "dom-manipulation";

var conformTest = navigator.epubReadingSystem.hasFeature(feature);

alert("Feature " + feature + " supported?: " + conformTest);</pre>
						</aside>
					</section>

					<section id="app-ers-hasFeature-features">
						<h5>Features</h5>

						<p>The following table lists the set of features that Reading Systems that support the
								<code>epubReadingSystem</code> object MUST recognize (i.e., provide a return value for).
							Support for these features is OPTIONAL.</p>

						<table>
							<thead>
								<tr>
									<th>Name</th>
									<th>Description</th>
								</tr>
							</thead>
							<tbody>
								<tr>
									<td id="feature-dom-manipulation">
										<code>dom-manipulation</code>
									</td>
									<td>Scripts MAY make structural changes to the document’s DOM (applies to <a
											href="epub-core.html#sec-scripted-content-type-spine-level">spine-level
											scripting</a> [[!EPUB-33]] only).</td>
								</tr>
								<tr>
									<td id="feature-layout-changes">
										<code>layout-changes</code>
									</td>
									<td>Scripts MAY modify attributes and CSS styles that affect content layout (applies
										to <a href="epub-core.html#sec-scripted-content-type-spine-level">spine-level
											scripting</a> [[!EPUB-33]] only).</td>
								</tr>
								<tr>
									<td id="feature-touch-events">
										<code>touch-events</code>
									</td>
									<td>The device supports touch events and the Reading System passes touch events to
										the content.</td>
								</tr>
								<tr>
									<td id="feature-mouse-events">
										<code>mouse-events</code>
									</td>
									<td>The device supports mouse events and the Reading System passes mouse events to
										the content.</td>
								</tr>
								<tr>
									<td id="feature-keyboard-events">
										<code>keyboard-events</code>
									</td>
									<td>The device supports keyboard events and the Reading System passes keyboard
										events to the content.</td>
								</tr>
								<tr>
									<td id="feature-spine-scripting">
										<code>spine-scripting</code>
									</td>
									<td>Indicates whether the Reading System supports <a
											href="epub-core.html#sec-scripted-content-type-spine-level">spine-level
											scripting</a> [[!EPUB-33]] (e.g., so a <a
											href="epub-core.html#sec-scripted-content-type-container-constrained"
											>container-constrained script</a> [[EPUB-33]] can determine whether any
										actions that depend on scripting support in a <a>Top-level Content Document</a>
										have any chance of success before attempting them).</td>
								</tr>
							</tbody>
						</table>

						<p>Additional features MAY be added by Reading System developers, but future versions of this
							specification might append to this list in ways that could conflict or be incompatible with
							any such custom additions.</p>
					</section>
				</section>
			</section>
		</section>
		<div data-include="../common/acknowledgements.html" data-oninclude="fixIncludes" data-include-replace="true"
		></div>
	</body>
</html>
