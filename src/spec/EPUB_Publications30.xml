<?xml version="1.0" encoding="UTF-8"?>
<?oxygen RNGSchema="../../util/docbook/schema/docbookspec.rng" type="xml"?>
<?oxygen SCHSchema="../../util/docbook/schema/docbookspec.sch"?>
<?oxygen SCHSchema="../../util/docbook/schema/docbook.sch"?>
<book xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xi="http://www.w3.org/2001/XInclude" version="5.1b2">
   <title>EPUB Publications 3.0</title>

    <info>
        <releaseinfo>Editors  Draft [IN PROGRESS]</releaseinfo>
        <pubdate>2010-11-12</pubdate>
        <printhistory>
            <formalpara>
                <title>This version</title>
                <para><link xlink:href="www.idpf.org/specs/TODO"/></para>
            </formalpara>
            <formalpara>
                <title>Previous version</title>
                <para><link xlink:href="www.idpf.org/specs/TODO"/></para>
            </formalpara>
            <formalpara>
                <title>Diffs to previous version</title>
                <para><link xlink:href="www.idpf.org/specs/TODO"/></para>
            </formalpara>
        </printhistory>
        <copyright>
            <year>2010</year>
            <year>2011</year>
            <holder>International Digital Publishing Forum™</holder>
        </copyright>
        <legalnotice>
            <para>All rights reserved. This work is protected under Title 17 of the United States
                Code. Reproduction and dissemination of this work with changes is prohibited except
                with the written permission of the International Digital Publishing Forum.</para>
        </legalnotice>
        <authorgroup>
            <editor>
                <personname>Garth Conboy</personname>
                <affiliation>
                    <org>
                        <orgname>eBook Technologies</orgname>
                    </org>
                </affiliation>
            </editor>
            <editor>
                <personname>Markus Gylling</personname>
                <affiliation>
                    <org>
                        <orgname>DAISY Consortium</orgname>
                    </org>
                </affiliation>
            </editor>
            <editor>
                <personname>William McCoy</personname>
                <affiliation>
                    <org>
                        <orgname>WebPaper LLC</orgname>
                    </org>
                </affiliation>
            </editor>
            <editor>
                <personname>
                    <remark role="todo">TBD - additional editors</remark>
                </personname>
            </editor>
        </authorgroup>
        <abstract>
            <title>EPUB Publications 3.0</title>
            <para>EPUB is an interchange and delivery format for digital publications based on XML
                and Web Standards. EPUB3, the third major revision of EPUB, is defined by a set of
                specification documents, including this document. This document defines
                publication-level semantics and conformance requirements for EPUB3.</para>
        </abstract>
    </info>

    <chapter xml:id="sec-overview">
        <title>Overview</title>
        <section xml:id="sec-overview-purpose-and-scope">
            <title>Purpose and Scope</title>
            <para>This document,  EPUB Publications 3.0, defines publication-level semantics and
                conformance requirements for EPUB3, the third major revision of EPUB, an interchange
                and delivery format based on XML and Web Standards.</para>
            <para>This document is meant to be read and understood in concert with the other
                documents that make up EPUB3. The  EPUB3 Overview <xref
                    linkend="refEPUB3Overview"/>, which provides an informative
                overview of EPUB and a roadmap to the rest of the EPUB3 documents, should be read
                first.</para>
        </section>
        <section xml:id="sec-overview-relationship">
            <title>Relationship to Other Specifications</title>
            <para>This specification depends on other building-block specifications. These include
                EPUB Content Documents 3.0 <xref
                    linkend="refContentDocs3"/>, Open Container Format 3.0 <xref
                        linkend="refOCF3"/>, and EPUB Media Overlays 3.0 <xref
                            linkend="refOverlays3"/>. </para>
            <para>This specification defines constructs based on XML <xref
                linkend="refXML"/>, and by default all terminology
                used in this specification has the same meaning as its use in <xref
                    linkend="refXML"/>. This
                specification also relies on XML Namespaces <xref
                    linkend="refXMLNamespaces"/>, and in this specification the term "XML
                namespace" (or just "namespace") has the meaning defined in that specification </para>
            <para>EPUB Publications 3.0 is a revision to, and supersedes, Open Package Format 2.0.1
                <xref   linkend="refOPF2"/>.</para>
            <para>
                <remark role="todo">
                    <remark role="todo"> TBD: enumerate other dependent specs </remark>
                </remark>
            </para>
            </section>

        <section xml:id="sec-overview-terminology">
            <title>Terminology</title>
            <glosslist>
                <glossentry xml:id="gloss-epub-publication">
                    <glossterm>EPUB Publication (or Publication)</glossterm>
                    <glossdef>
                        <para>A collection of Content Documents, a Package file, and other media
                            files and supporting components.</para>
                    </glossdef>
                </glossentry>
                <glossentry>
                    <glossterm>EPUB File</glossterm>
                    <glossdef>
                        <para>An EPUB Publication packaged as an OCF ZIP container (or,
                            equivalently, an Expanded Publication that has been "zipped" into a
                            single file).</para>
                    </glossdef>
                </glossentry>
                <glossentry>
                    <glossterm>Expanded Publication</glossterm>
                    <glossdef>
                        <para>An EPUB Publication packaged as an OCF Filesystem container (or,
                            equivalently, an EPUB File that has been "unzipped").</para>
                    </glossdef>
                </glossentry>
                <glossentry>
                    <glossterm>Extended Content Document Reference</glossterm>
                    <glossdef>
                        <para>An item in the Package File manifest that either a) refers to an EPUB
                            Content Document, or b) includes an EPUB Content Document in its
                            fallback chain.</para>
                    </glossdef>
                </glossentry>
                <glossentry>
                    <glossterm>EPUB Reading System (or Reading System)</glossterm>
                    <glossdef>
                        <para>A system that processes Publications for presentation to end users in
                            a manner conformant with this specification, including its dependent
                            specifications. A conforming Reading System is not necessarily a single
                            dedicated program or device but may exist as a distributed system, and a
                            wide variety of legitimate presentations of Publications by Reading
                            Systems are contemplated by this specification.</para>
                    </glossdef>
                </glossentry>
                <glossentry>
                    <glossterm>Package Document</glossterm>
                    <glossdef>
                        <para>An XML Document conformant with the Package schema and additional
                            constraints defined in this specification</para>
                    </glossdef>
                </glossentry>
            </glosslist>
        </section>            
        
        <section xml:id="sec-overview-conformance">
            <title>Conformance</title>
            <xi:include href="./share/conformancestatements.xml"/>
        </section>

    </chapter>

    <chapter xml:id="sec-opf-introduction">
        <title>Introduction</title>
        <para>EPUB is an interchange and delivery format for digital publications, based on XML and
            Web Standards. An EPUB Publication can be thought of as a a reliable  packaging of Web
            content that represents a digital book, magazine, or other type of publication, with a
            declarative means to navigate through the content, and able to distributed reliably for
            online and offline consumption. </para>
        <para>This specification defines the semantics and conformance requirements for EPUB at the
            publication level. The individual contents of EPUB Publications are defined by other
            specifications; a fully-packaged EPUB Publication consists of at minimum four files
            (e.g., <filename>container.xml</filename>, <filename>manifest.opf</filename>,
                <filename>nav.ncx</filename>, and <filename>content.xhtml</filename>), defined
            according to the rules of this and other specifications (including <xref
                linkend="refOCF3"/>, and
            <xref   linkend="refContentDocs3"/>). This specification defines the formats of the OPF and NCX files, as
            well as additional rules for how these files and other optional files are tied together
            to create valid and conforming EPUB Publications, and for how such Publications are
            processed by a conforming Reading System.</para>
    </chapter>
    <chapter xml:id="sec-ocf-overview">
        <title>EPUB Publications</title>
        <para>This section describes the high-level content and Reading System conformance requirements for EPUB Publications. The sections 
        following this one describe more specifically the requirements for Package Documents, NCX Documents, and Core Media Types</para>
        <section xml:id="sec-ocf-overview-intro">
            <title>Publication-level Content Conformance</title>
            <para>A minimal EPUB Publication consists of</para>
            <para>
                <itemizedlist>
                    <listitem>
                        <para>Exactly one Package Document, conformant to the Package Document
                            requirements defined in this specification</para>
                    </listitem>
                    <listitem>
                        <para>An associated NCX Document, conformant to NCX Document requirements
                            defined in this specificaiton</para>
                    </listitem>
                    <listitem>
                        <para>One or more EPUB Content Documents, conformant to the requirements of
                            <xref   linkend="refContentDocs3"/></para>
                    </listitem>
                    <listitem>
                        <para>Zero or more Media Overlay Documents, conformant to <xref   linkend="refOverlays3"/></para>
                    </listitem>
                    <listitem>
                        <para>Zero or more additional files, all of which, together with the EPUB
                            Content Document(s), NCX Document, and Media Overlay Documents(s) if
                            any, must be uniquely referenced in the Package File's &lt;manifest>
                            element</para>
                    </listitem>
                </itemizedlist>
            </para>  
                        <para>In most cases, an EPUB Publication will be instantiated as an Expanded
                    EPUB Publication or an EPUB File, i.e. in a Filesystem or ZIP container
                    conformant with <xref   linkend="refOCF3"/> (containing a valid META-INF/container.xml file and, if
                    in the ZIP container, a MIMETYPE file), potentially together with <emphasis
                        role="bold">external files<emphasis role="bold">,</emphasis></emphasis>
                    additional files that are not referenced in the &lt;manifest> and thus not
                    considered part of the EPUB Publication itself.</para>
            <para>For convenience, a complete listing of all content conformance requirements
                applicable based on all the EPUB3 specifications is available as Appendix A of this
                specification.</para>
        <section xml:id="sec-xhtml-content-role-attribute">
            <title>Example: EPUB Publication</title>
            <para>This section is non-normative.</para>
            <para><remark role="todo">TODO: example</remark></para>
        </section>
          
        </section>
        <section xml:id="sec-ocf-overview-examples">
            <title>Publication-level Reading System Conformance</title>
            <para>In addition to conforming with the requirements specific to this specification, an
                EPUB Reading System must necessarily also be a conforming User Agent according to
                <xref   linkend="refContentDocs3"/> and a conforming OCF Processor according to <xref   linkend="refOCF3"/>. An EPUB Reading
                System must also, if it supports Media Overlays, be a confoming Media Overlay
                Processor according to <xref   linkend="refOverlays3"/>.</para>
            <para role="rsconf">EPUB Reading Systems conformant with this Publications 3.0
                specification should also be conformant processors of EPUB version 2 publications,
                as defined by <xref   linkend="refOPF2"/>, <xref   linkend="refOPS2"/>, and <xref   linkend="refOCF2"/>, and must at a minimum attempt to process
                any publication whose Package Document designates a version other than "3.0" or
                which omits the version attribute, as if such publication had designated a version
                "3.0"; provided, however, that Reading Systems must in this situation ignore the
                presence of removed constructs including <code>ops:switch</code> in Content
                Documents and <code>@fallback-style</code> in manifest items.</para>
            <para>For convenience, all Reading System conformance requirements applicable based on
                all of the EPUB3 specifications are non-normatively summarized in Appendix B of this specification.</para>
        </section>
        <section xml:id="fallback">
            <title>Fallback Items</title>
            <para role="contentconf">This specification defines a set of Core Media Types that all
                conforming Reading Systems must support in addition to Content Documents (e.g. PNG,
                SVG, OpenType fonts). Publications may optionally reference items of additional
                media types. In order to ensure that all conforming Publications can be successfully
                rendered by all conforming Reading Systems, alternative "fallback" items must be
                provided for each such item. Fallbacks may be provided either via inherent
                mechanisms defined for Content Documents, or via the manifest-level fallback
                mechanism defined in this specification. </para>
            <para role="contentconf">For every item that is not a Core Media Type, suitable
                fallback(s) of a Core Media Type must be provided via one of these mechanisms, as
                detailed below:</para>
            <para role="contentconf">For <emphasis role="bold">resources referenced in Content
                    Documents via <literal>object</literal> elements,</emphasis> legitimate
                fallback(s) must be provided via that element’s inherent replacement capabilities.
                Reading Systems must ignore manifest-level fallbacks in resolving such references
                (the <code>bindings</code> element described below could be considered to enable a
                type of fallback, but not in the sense meant here of ensuring that content can be
                rendered on all Reading Systems, whether or not they support scripting).</para>
            <para role="contentconf"> For <emphasis role="bold">resources referenced in Content
                    Documents via <literal>img</literal> elements,</emphasis> the text value of the
                alt or title attributes provide a legitimate fallback and should be included.
                Additional manifest-level fallbacks may be provided. Reading Systems should process
                manifest-level fallbacks in resolving such references. </para>
                
                
                <para role="contentconf">For <emphasis role="bold">fonts embedded in Content
                    Documents or EPUB Style Sheets using the <literal>@font-face</literal>
                    mechanism,</emphasis> the basic rules of CSS must be used to provide a
                legitimate fallback. Reading Systems must ignore manifest-level fallbacks in
                resolving CSS font references. </para>
            <para role="contentconf">For <emphasis role="bold">resources referenced in Content
                    Documents via <literal>iframe</literal> elements,</emphasis> only XHTML Content
                Documents may be referenced; fallback processing is inapplicable.</para>
            <para>For
                    <emphasis role="bold">all other resource referencing situations</emphasis> in
                EPUB Publications, a legitimate fallback must be provided via the manifest fallback
                mechanism. Reading Systems must process manifest-level fallbacks in resolving such
                resource references.</para>
            
        </section>
    </chapter>
    <chapter>
        <title> Package Documents</title>
        <para>The fundamental publication-level construct of an EPUB Publication is a Package
            Document, which enumerates and describes a set of  resources that collectively  comprise
            the publication (via the <emphasis role="italic">manifest</emphasis>)</para>
        <para>In addition Package Documents define several additional capabilities including:</para>
        <itemizedlist>
          <listitem>
              <para><emphasis role="italic">spine</emphasis> - an ordered sequence of top-level
                    resources from which all other resources in the set can be reached or utilized
                    (defining the default "reading order" for the publication).</para>
          </listitem>   
            <listitem>
                <para><emphasis role="italic">metadata</emphasis> - mechanisms for including and/or
                    referencing metadata applicable to the entire publication and/or particular
                    items </para>
            </listitem>
            <listitem>
                <para><emphasis role="italic">toc</emphasis> - a means for associating declarative
                    navigation ("table of contents") via NCX (described in Chapter 5 of this
                    specification).</para>
            </listitem>
            <listitem>
                <para><emphasis role="italic">fallback chains</emphasis> - an optional means for
                    items to reference an ordered list of alternative items</para>               
            </listitem>
            <listitem>
                <para><emphasis role="italic">bindings</emphasis> - an optional means of associating
                    script-based implementations with custom media types (via the
                        <code>bindings</code> element).</para>
            </listitem>
        </itemizedlist>
     
        <para>
            <remark role="todo">TODO DIAGRAM: show visual graph of abstract "hedge" here, inc
                fallback chains and sharing resources between roots. </remark>
        </para>
        <para>While the Package Document schema is modular and could potentially be utilized by
            applications other than EPUB, certain conformance requirements are defined in this
            specification that are applicable to Package Documents use to represent EPUB
            Publications.</para>
        <para>In the package file schema, items of any kind (including style objects, metadata
            objects, and TOC) are simply abstract URI references to resources that specify a MIME
            type. Additional significance is defined in the context of EPUB, regarding valid
            resource types for different items. Inter-item references are always via id
            attributes.</para>
        <section xml:id="sec-package-element">
            <title>Package Document and root Package Element</title>
            <para role="contentconf">A Package Document must be a well-formed XML Document.</para>
            <para role="contentconf">A Package Document must be encoded in UTF-8 or UTF-16 as
                defined by <xref linkend="refUnicode5"/> and be valid according to the  Package
                Document schema (<remark role="todo">TODO: Appendix A</remark>). Note that this
                schema is normative and in case of conflicts between the specification prose and
                this document, the schema shall be considered definitive. </para>
            <para role="contentconf">A Package Document must exist as a root XML file that should be
                named ending in the extension "<literal>.opf</literal>", and is considered to have
                the MIME media type <literal>"application/oebps-package+xml"</literal>. This root
                XML file may refer to other XML files via XML’s general entity mechanism, but those
                files must not use the .opf file extension. </para>
            <para role="contentconf">The <literal>package</literal> element must be the one and only
                one root element in a Package Document; all other elements in the Package Document
                must be nested within it. The package element's namespace must be
                    <literal>http://www.idpf.org/2007/opf</literal>. <remark role="todo">do we need
                    new namespace for EPUB3?</remark></para>
            <para role="contentconf">The <literal>package</literal> element must have a
                    <literal>version</literal> attribute with a value of
                <literal>3.0</literal>.</para>
            <para role="contentconf">The <literal>package</literal> element must specifys a value
                for its <literal>unique-identifier attribute</literal>. The unique-identifier
                attribute's value specifies which Dublin Core identifier element, described in
                Section 2.2.10, provides the package's preferred, or primary, identifier. The
                Package Document's author is responsible for choosing a primary identifier that is
                unique to one and only one particular package (i.e., the set of resources referenced
                from the package document's manifest). </para>
            <para role="rsconferr">Reading Systems must not fail catastrophically if they encounter
                two distinct EPUB Publications with the same purportedly unique primary identifier. </para>
            <para>
                <remark role="todo">TODO EXAMPLE: from sec 2.0 of OPF 2.0.1</remark>
            </para>
            <para> </para>
        </section>
        <section xml:id="sec-manifest-elem">
            <title>Manifest element</title>
            <para role="contentconf">The <literal>package</literal> element must contain one and
                only one <literal>manifest</literal> element as its first sub-element. The
                    <literal>manifest</literal> element must contain one or more
                    <literal>item</literal> elements, each uniquely describing a content item. The
                manifest must not include item elements referring to the XML file or files that make
                up the Package Document, and no item in the manfest may have the MIME media type
                    <literal>"application/oebps-package+xml</literal>. Each <literal>item</literal>
                element contained within a manifest element must have the attributes
                    <literal>id</literal>, <literal>href</literal> (a URI; if relative, the URI is
                interpreted as relative to the Package File containing the reference, and the URI
                must not contain a fragment identifier), and <literal>media-type</literal>
                (specifying the item’s MIME media type). The order of item elements in the manifest
                is not significant.  No URI may be listed more than once in the manifest.</para>
            <para role="epubconf">In an EPUB Publication, for each item in the manifest whose
                media-type is an EPUB3 Core Media Type (as defined in Section 4.1 of this document),
                the resource referenced by that item must conform to the applicable specification
                for that Core Media Type. Each item in the manifest whose
                    <literal>media-type</literal> is NOT one of the EPUB3 Core Media Types must
                specify a fallback chain that includes at least one item whose
                    <literal>media-type</literal> is an EPUB3 Core Media Type, as further defined
                below. As well, in EPUB Publications there must not be any relative URI references
                of any kind to external files from any item (nor via any URI referencing mechanism,
                including script, in any Content Document or other content files): i.e. the manifest
                must include all resources that are considered part of the publication itself and
                referenced in a relative manner, and all external resources must be referenced by
                absolute URIs.</para>
            <para>Example manifest:</para>
            <para>
                <informalexample><synopsis>
&lt;manifest>
    &lt;item id="intro"
        href="intro.html"
        media-type="application/xhtml+xml" />
    &lt;item id="c1"
        href="chap1.html"
        media-type="application/xhtml+xml" />
    &lt;item id="c1-answerkey"
        href="chap1-answerkey.html"
        media-type="application/xhtml+xml" />
    &lt;item id="c2"
        href="chap2.dtb"
        media-type="application/x-dtbook+xml" />
    &lt;item id="c2-answerkey"
        href="chap2-answerkey.html"
        media-type="application/xhtml+xml" />
    &lt;item id="c3"
        href="chap3.html"
        media-type="application/xhtml+xml" />
    &lt;item id="c3-answerkey"
        href="chap3-answerkey.html"
        media-type="application/xhtml+xml" />
    &lt;item id="note"
        href="note.html"
        media-type="application/xhtml+xml" />
    &lt;item id="f1"
        href="fig1.jpg"
        media-type="image/jpeg" />
    &lt;item id="f2"
        href="fig2.jpg"
        media-type="image/jpeg" />
    &lt;item id="f3"
        href="fig3.jpg"
        media-type="image/jpeg" />
    &lt;item id="ncx"
        href="toc.ncx"
        media-type="application/x-dtbncx+xml" />
&lt;/manifest>
</synopsis>
</informalexample>
</para>
            <section>
                <title>Fallback Chains</title>
                <para role="contentconf"> An item in the manifest may optionally contain the
                    atttribute <literal>fallback</literal>. If present it must be an id reference to
                    another item in the manifest. The ordered list of all id references that can be
                    reached starting from any item's <literal>fallback</literal> attribute is
                    considered to be the "fallback chain" for that item. There must not be any
                    circular references in any fallback chains. </para>
                <para role="epubconf">In the context of EPUB, fallback chains are used to reference
                    a set of items that can be considered equivalents, that a Reading System can
                    choose between in rendering content. The detailed requirements for use of
                    fallback chains in EPUB are described in <remark role="todo">section
                        X.X.X</remark> below. </para>
            </section>
        </section>
        <section xml:id="sec-spine-elem">
            <title>Spine element</title>
            <para role="contentconf">Following the manifest, there must be one and only one
                    <literal>spine</literal> element, which contains one or more
                    <literal>itemref</literal> elements. Each <literal>itemref</literal> must
                reference (via its required <literal>idref</literal> attribute) a unique item in the
                manifest, thus the spine represents an ordered list of a subset of the items in the
                manifest. In EPUB, this represents the default reading order for the content, with
                content items not appearing in the spine being ancillary to those that do appear
                there. </para>
            <para role="epubconf">In the context of EPUB, each <literal>item</literal> referenced by
                the Package File's <literal>spine</literal> element must be an Extended Content
                Document Reference. Note that in general such references should resolve to XHTML
                Content Documents  rather than SVG Content Documents, unless a) such use is within a
                Publication that is packaged together with, and as an alternative non-default
                representation of, another Publication that represents effectively the same content
                utilizing XHTML Content Documents or b) the nature of the content being represented
                via SVG is inherently unsuitable to representation in XHTML.</para>
            <para role="contentconf">The <literal>spine</literal> element must include a
                    <literal>toc attribute</literal>, whose value is an id reference to another item
                    in the manifest.</para>
            <para role="epubconf">  For an EPUB Publication, the <literal>toc</literal> reference must be to the publication's
                one and only one NCX Document.</para>
            <para role="contentconf">The <literal>spine</literal> element may contain an optional attribute
                    <literal>page-progression-direction</literal>, which can have the values
                    <literal>ltr</literal> or <literal>rtl</literal> indicating left-to-right or
                right-to-left presentation is expected.</para>
            <para role="contentconf">Spine itemref elements may also contain an optional attribute
                    <literal>linear</literal> whose default value is <literal>true</literal>. This
                reference indicates whether a spine item is considered primary (linear=true) or
                auxiliary (linear=false). In the context of EPUB, this may be used to enable Reading
                Systems to distinguish presentation of "body" content from ancillary or "sidebar"
                content which might be, for example, presented in a popup window, or omitted from an
                aural rendition. </para>
            <para role="rsconf">Reading Systems must provide a means to render a Publication in the
                sequence order defined by the spine. Reading Systems must as part of this means a)
                recognize the first primary (linear=true) item in spine to be the beginning of the
                main reading order of the publication and b) render successive primary items in the
                order given in spine. Reading Systems may use "next-page" style functionality when
                moving from one primary item to the next in spine. </para>
            <para role="rsconferr">When providing navigation via the spine, a Reading System must
                ignore items that are not Extended Content Document References.</para>
            <para role="rsconferr">The following example shows a spine element corresponding to the
            manifest example in section  4.2 above:</para>
            <para><informalexample><synopsis>
&lt;spine toc="ncx">
     &lt;itemref idref="intro" />
     &lt;itemref idref="c1" />
     &lt;itemref idref="c1-answerkey" linear="no" />
     &lt;itemref idref="c2" />
     &lt;itemref idref="c2-answerkey" linear="no" />
     &lt;itemref idref="c3" />
     &lt;itemref idref="c3-answerkey" linear="no" />
     &lt;itemref idref="note" linear="no" />
&lt;/spine>                               
            </synopsis></informalexample></para>
        </section>
        <section>
            <title>Metadata</title>
            <para role="contentconf"> The required metadata element is used to provide information
                about the publication as a whole. It may contain Dublin Core metadata elements
                directly or... <remark role="todo">TODO: include info here based on metadata
                    subgroup solution proposal.</remark></para>
                
                    <para role="epubconf">In EPUB Publications, Content Documents must not contain
                any <literal>script</literal> elements unless the manifest item corresponding to
                that Content Document contains the <literal>property</literal> value
                    <literal>scripted</literal> (thus indicating a <emphasis role="bold">Scripted
                    Content Document).</emphasis>Since scripted content may be processed
                differently, with features such as pagination potentially disabled, content items
                that set the property value of "scripted" should not be spine items unless
                absolutely required by a publication (i.e. scripted content hould if possible be
                nested, contained within top-level content via "object" or "iframe").</para>
           
                    <para role="rsconf">Reading Systems may render Scripted Content Documents as an
                        interactive, scripted HTML User Agent according to <xref   linkend="refHTML5"/> rather than
                        according to the simplified processing model defined for EPUB User Agents in
                        <xref   linkend="refContentDocs3"/>, i.e. with scripting enabled. Reading Systems should not
                        enable scripting for any resources other than Scripted Content
                        Documents.</para>
               
                    <para role="rsconf">Reading Systems may implement support for Scripted Content
                        Documents in a manner that disables other EPUB capabilities and/or provides
                        a different rendering such as, for example, disabling pagination.</para>
               
        </section>
        <section xml:id="sec-bindings-elem">
            <title>Bindings element</title>
            <para role="contentconf">The package element may contain at most one
                    <literal>bindings</literal> element, which contains one or more
                    <literal>mediaType</literal> elements, each of which associates a custom media
                type with a "handler" that provides a default script-based implementation for items
                of that media type when they are referenced from <code>object</code> elements in
                XHTML Content Documents. </para>
            <para role="contentconf"> Each <literal>mediaType</literal> element must uniquely
                designate, via its required <literal>media-type</literal> attribute, a unique
                content type, which must not be a Core Media Type, and must reference, via its
                required <code>handler</code> attribute, the id in the manifest of the default
                implementation for this media type, which must be an XHTML Content Document. <remark
                    role="todo">WM: might 'idref' a la spine be more consistent than
                    'handler'?</remark>
            </para>
            <para role="rsconf">Reading Systems that support scripting must utilize the bindings
                element, if present in a Publication, to handle object element references whose MIME
                media type is not natively supported by the Reading System. The processing model is
                to instantiate for such references the designated XHTML Content Document handler
                (which would typically include scripting) as if it had been referenced from the
                object element's <code>data</code> attribute, but with URL parameters (which go
                after '?' in a URL) of <itemizedlist>
                    <listitem>
                        <para><code>src</code> - URI to the resource (value of the data attribute in
                            the object element) </para>
                    </listitem>
                    <listitem>
                        <para><code>type</code> - resource media type (value of the type attribute
                            in the object element)</para>
                    </listitem>
                </itemizedlist> Non-ASCII and non-URL-safe characters (e.g. '=') should be escaped
                in the usual manner for these parameters (UTF-8 encoding and using %XX escapes). </para>
            <para role="rsconferr">The following partial example illustrates how bindings can be
                used to provide a default implementation:</para>
            <para><informalexample><synopsis>
&lt;manifest>
  &lt;item id="pict1" href="images/Pict1.jpg" media-type="image/jpeg"/>
  ...
  &lt;item id="content" href="content.xhtml" media-type="application/xhtml+xml"/>
  &lt;item id="impl" href="impl.xhtml" media-type="application/xhtml+xml"/>
  &lt;item id="slideshow" href="slideshow.xml" media-type="application/x-demo-slideshow"/>
 &lt;/manifest>
 &lt;bindings>
   &lt;mediaType media-type="application/x-demo-slideshow" handler="impl"/>
 &lt;/bindings>

<emphasis role="italic">in content.xhtml:</emphasis>

...
&lt;object data="slideshow.xml" type="application/x-demo-slideshow">
&lt;!-- if scripting is not available, just show them inline -->
&lt;img src="images/Pict1.jpg"/>
&lt;img src="images/Pict2.jpg"/>
&lt;img src="images/Pict3.jpg"/>
&lt;img src="images/Pict4.jpg"/>
&lt;/object>
...

<emphasis role="italic">in slideshow.xml:</emphasis>
&lt;slides>
  &lt;slide src="images/Pict1.jpg" dur="3"/>
  &lt;slide src="images/Pict2.jpg" dur="3"/>
  &lt;slide src="images/Pict3.jpg" dur="3"/>
  &lt;slide src="images/Pict4.jpg" dur="3"/>
&lt;/slides>    
                           
            </synopsis></informalexample></para>
        </section>
        <section><title>Fallback Processing</title><para> This section defines in detail the process by which Reading Systems process fallback
                information in EPUB Publications. The rules for fallback processing depend on both
                the type of item, and how is referenced by a Content Document or other
                resource.</para></section>
        <section>
            <title>Guide [DEPRECATED]</title>
            <para role="contentconf">The package element may contain one <literal>guide</literal>
                element, which if present must contain one or more <literal>reference</literal>
                elements. Each reference must have an <literal>href</literal> attribute, which may
                include a fragment identifier as defined in section 4.1 of <xref   linkend="refRFC2396"/>. Each reference must further have
                <literal>type</literal> and <literal>title</literal> attributes whose values
                must be strings. </para>
            <para role="epubconf">In the context of EPUB, the href attribute of each reference
                element must resolve to or within a resource that is represented by an Extended
                Content Document Reference, with each type atttribute conforming to the requirements
                of Section X.X of this document (Core Media Types). </para>
            <para role="rsconf">Reading Systems may provide a means to navigate a Publication
                based on the information in its optional Guide.</para>
            <para>Note that <code>guide</code> has been deprecated, as the required NCX provides a
                superset of its functionality. The primary use case for a publication to include a
                guide would be to support older version Reading Systems that may not support
                NCX.</para>
            <remark role="todo">TODO: Guide example from OPF2</remark>
        </section>
    </chapter>
    <chapter>
        <title> NCX Documents</title>
        <para>
            <remark role="todo">TODO</remark>
        </para>
                <para role="epubconf">All references in the NCX Document must resolve to or
                    within a resource that is represented by an Extended Content Document Reference.
                </para>
        <para role="rsconf">Reading Systems must provide a means to navigate a Publication based on
            the information in its NCX file.</para>
            
        
        </chapter>
    <chapter xml:id="sec-content-definitions">
        <title>EPUB Content Definitions</title>
        <para>This section includes information about specific values required or allowable in
            different portions of an EPUB Publication in EPUB3 including Core Media Types, Guide
            reference types, and <remark role="todo">TODO: NCX . </remark>.</para>
        <para>The values specified in this section are expected to change significantly over time. Always be sure
        to consult the latest applicable version of this specification.</para>
        <section xml:id="sec-core-media-types">
            <title>Core Media Types</title>
            <para>The following table lists the EPUB Core Media Types by MIME type.</para>
            <para>
                <table xml:id="ex.htmltable">
                    <caption>EPUB Core Media Types</caption>
                    <thead>
                        <tr>
                            <td>MIME Media Type</td>
                            <td>Reference</td>
                            <td>Description</td>
                        </tr>
                    </thead>
                    <tbody>
                        <tr> 
                            <td> 
                                <code>image/gif</code> 
                            </td> 
                            <td> 
                                <link xlink:href="http://www.w3.org/Graphics/GIF/spec-gif89a.txt">http://www.w3.org/Graphics/GIF/spec-gif89a.txt</link> 
                            </td> 
                            <td> 
                                Used for raster graphics
                            </td> 
                        </tr> 
                        
                        <tr> 
                            <td> 
                                <code>image/jpeg</code> 
                            </td> 
                            <td> 
                                <link xlink:href="http://www.w3.org/Graphics/JPEG/">http://www.w3.org/Graphics/JPEG/</link> 
                            </td> 
                            <td> 
                                Used for raster graphics
                            </td> 
                        </tr> 
                        
                        <tr> 
                            <td> 
                                <code>image/png</code>
                            </td> 
                            <td> 
                                <link xlink:href="http://www.ietf.org/rfc/rfc2083.txt">RFC 2083</link> 
                            </td> 
                            <td> Used for raster graphics </td> 
                        </tr> 
                        
                        <tr> 
                            <td> 
                                <code>image/svg+xml</code> 
                            </td> 
                            <td>
                                <link xlink:href="http://www.w3.org/TR/SVG11/">[ContentDocs30]</link>
                            </td> 
                            <td> Used for vector graphics for images and SVG Content Documents </td> 
                        </tr> 
                        
                        <tr> 
                            <td> 
                                <code>application/xhtml+xml</code> 
                            </td> 
                            <td>
                                <link xlink:href="http://www.w3.org/TR/xhtml11/">[ContentDocs30]</link>
                            </td> 
                            <td> Used for XHTML Content Documents </td> 
                        </tr> 
                        
                        <tr> 
                            <td> 
                                <code>text/css</code> 
                            </td> 
                            <td>
                                <link xlink:href="http://www.w3.org/TR/REC-CSS2/">[ContentDocs30]</link>>
                            </td> 
                            <td> CSS style sheets </td> 
                        </tr> 
                       
                        <tr> 
                            <td> 
                                <code>application/x-dtbncx+xml</code> 
                            </td> 
                            <td>
                                <link xlink:href="http://www.niso.org/standards/resources/Z39-86-2005.html">[Publications30]</link>
                            </td> 
                            <td> NCX </td> 
                        </tr> 
                        <tr> 
                            <td> 
                                <code>application/pls+xml</code> 
                            </td> 
                            <td>
                                <link xlink:href="http://www.w3.org/TR/pronunciation-lexicon/" > Pronunciation Lexicon Specification 1.0 (PLS)</link>
                            </td> 
                            <td> Used for pronunciation lexicons to assist text-to-speech
                                rendering</td> 
                        </tr> 
                        <tr> 
                            <td> 
                                <code>audio/mpeg</code> 
                            </td> 
                            <td>
                                <link xlink:href="http://tools.ietf.org/html/rfc3003"
                                   
                                    >RFC3003</link>
                            </td> 
                            <td> Used for MP3 audio</td> 
                        </tr> 
                        <tr> 
                            <td> 
                                <code>NONE!!</code><remark role="todo">TODO: no MIME types defined for font formats!?</remark>
                            </td> 
                            <td>
                                <link xlink:href="http://tools.ietf.org/html/rfc3003"
                                    
                                    >OpenType</link>
                            </td> 
                            <td> Used for OpenType fonts</td> 
                        </tr> 
                        <tr> 
                            <td> 
                                <code>NONE!!</code> 
                            </td> 
                            <td>
                                <link xlink:href="http://tools.ietf.org/html/rfc3003"
                                    
                                    >WOFF</link>
                            </td> 
                            <td> Used for WOFF fonts</td> 
                        </tr> 
                    </tbody>
                </table>
            </para>
        </section>

        <section xml:id="sec-guide-reference-types">
            <title>Guide reference types</title>
            <para role="contentconf">Each Guide reference item's required type attribute must be selected from the list
                defined below when applicable. Other types may be used when none of the predefined
                types are applicable; their names must begin with the string other.. The value for
                the type attribute is case-sensitive. The following list of type values is derived
                from the 13th edition of the Chicago Manual of Style: <remark role="todo">TODO: list
                    from OPF2 2.6 </remark></para>
        </section>
        <section xml:id="sec-ncx-epub-semantics">
            <title>NCX reference types</title>
            <para role="contentconf"><remark role="todo">TODO: EPUB-specific requirements for  NCX</remark></para>
        </section>
    </chapter>
    
    <appendix xml:id="app-content-conform" conformance="informative">
        <title>Appendix A. Content Conformance Summary</title>
        
        <para>This appendix non-normatively summarizes all content conformance requirements
            applicable to EPUB Publications based on this specification as well as <xref   linkend="refContentDocs3"/>,
            <xref   linkend="refOCF3"/>, and <xref   linkend="refOverlays3"/>.</para>
        
        
        <para><remark role="todo">TODO</remark></para>
    </appendix>
    <appendix xml:id="app-reading-system-conform" conformance="informative">
        <title>Appendix B. Reading System Conformance Summary</title>
        <para>This appendix non-normatively summarizes all conformance requirements applicable to
            Reading Systems based on this specification as well as <xref   linkend="refContentDocs3"/>, <xref   linkend="refOCF3"/>, and
            <xref   linkend="refOverlays3"/>.</para>
        
        
        <para><remark role="todo">TODO</remark></para>
    </appendix>

    <appendix xml:id="acknowledgements" role="acknowledgements" conformance="informative">
        <title>Contributors</title>
        <xi:include href="./share/contributors.xml"/>
    </appendix>

    <xi:include href="./share/references.xml"/>  
</book>
